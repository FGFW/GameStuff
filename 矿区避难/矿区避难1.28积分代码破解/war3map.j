globals
hashtable V=InitHashtable()
hashtable E=InitHashtable()
real X
real O
real R
real I
group A=CreateGroup()
group N=CreateGroup()
hashtable B=InitHashtable()
hashtable C=InitHashtable()
boolean D=false
dialog F=DialogCreate()
timer G=CreateTimer()
sound array H
integer J=0
integer K=0
timer L=CreateTimer()
location M=Location(0,0)
integer P=0
integer Q=0
integer S=0
real T=0
real U=0
real W=0
integer Y=0
integer Z=0
integer VV=0
unit EV=null
unit XV=null
unit OV=null
location RV=null
location IV=null
integer array AV
integer array NV
integer array BV
integer array CV
integer DV=0
trigger array FV
integer array GV
integer HV=0
unit array JV
real KV=0
integer array LV
group MV=null
unit array PV
real array QV
boolean SV=false
real array TV
real array UV
string array WV
player YV=null
texttag ZV=null
string VE=""
group EE=null
force XE=null
integer array OE
integer array RE
real array IE
real array AE
real array NE
real array BE
real CE=0
real DE=0
real FE=0
real array GE
destructable HE=null
integer JE=0
integer KE=0
integer LE=0
integer ME=0
integer array PE
integer array QE
integer SE=0
group TE=null
integer UE=0
group WE=null
hashtable YE=null
boolean array ZE
string array VX
integer array EX
integer array XX
integer array OX
button RX=null
player IX=null
unit array AX
dialog array NX
integer BX=0
boolean CX=false
integer array DX
integer FX=0
integer array GX
integer HX=0
boolean array JX
integer array KX
boolean array LX
integer array MX
integer array PX
hashtable QX=null
integer SX=0
group TX=null
integer UX=0
boolean array WX
group YX=null
hashtable ZX=null
trigger array VO
integer array EO
hashtable XO=null
hashtable OO=null
group RO=null
integer array IO
integer array AO
integer array NO
integer array BO
group CO=null
hashtable DO=null
fogmodifier array FO
boolean array GO
destructable array HO
integer array JO
integer KO=0
string LO=""
boolean MO=false
boolean PO=false
boolean QO=false
string SO=""
integer array TO
integer UO=0
boolean WO=false
integer array YO
integer array ZO
integer ER=0
integer OR=0
integer IR=0
boolean array AR
boolean array NR
location array BR
destructable array CR
integer DR=0
rect FR=null
location GR=null
sound array HR
boolean JR=false
group KR=null
string LR=""
string MR=""
group PR=null
boolean array QR
trigger array SR
integer TR=0
integer UR=0
real WR=0
real YR=0
weathereffect ZR=null
integer VI=0
group EI=null
string array XI
integer array OI
integer RI=0
multiboard II=null
string array AI
string NI=""
unit array BI
group CI=null
group DI=null
group FI=null
integer array GI
integer array HI
group JI=null
unit array KI
integer LI=0
sound array MI
group PI=null
sound QI=null
hashtable SI=null
real array TI
integer array UI
integer array WI
real array YI
real array ZI
real array VA
real array EA
real array XA
real array OA
group RA=null
integer IA=0
integer AA=0
integer NA=0
integer BA=0
integer CA=0
unit array DA
real FA=0
unit GA=null
unit HA=null
real JA=0
boolean KA=false
boolean LA=false
real MA=0
real PA=0
real QA=0
trigger SA=null
integer TA=0
integer UA=0
unit WA=null
boolean array YA
integer ZA=0
timer VN=null
hashtable EN=null
hashtable XN=null
real array ON
group RN=null
integer array IN
integer AN=0
integer NN=0
integer BN=0
boolean CN=false
boolean DN=false
integer FN=0
real GN=0
unit HN=null
player JN=null
integer array KN
real LN=0
group array MN
boolean PN=false
real array QN
force SN=null
integer TN=0
boolean array UN
boolean array WN
boolean array YN
unit array ZN
boolean array VB
group array EB
boolean array XB
integer array OB
integer array RB
timer IB=null
boolean array AB
real NB=0
real BB=0
integer array CB
timer DB=null
boolean FB=false
rect GB=null
rect HB=null
rect JB=null
rect KB=null
rect LB=null
rect MB=null
rect PB=null
rect QB=null
rect SB=null
rect TB=null
rect UB=null
rect WB=null
rect YB=null
rect ZB=null
camerasetup VC=null
camerasetup EC=null
camerasetup XC=null
camerasetup OC=null
camerasetup RC=null
camerasetup IC=null
sound AC=null
sound NC=null
sound BC=null
sound CC=null
sound DC=null
sound FC=null
sound GC=null
sound HC=null
sound JC=null
sound KC=null
sound LC=null
sound MC=null
sound PC=null
sound QC=null
sound SC=null
sound TC=null
sound UC=null
sound WC=null
sound YC=null
sound ZC=null
sound VD=null
sound ED=null
sound XD=null
sound OD=null
sound RD=null
sound ID=null
sound AD=null
sound ND=null
sound BD=null
sound CD=null
sound DD=null
sound FD=null
sound GD=null
sound HD=null
trigger JD=null
trigger KD=null
trigger LD=null
trigger MD=null
trigger PD=null
trigger QD=null
trigger SD=null
trigger TD=null
trigger UD=null
trigger WD=null
trigger YD=null
trigger ZD=null
trigger VF=null
trigger EF=null
trigger XF=null
trigger OF=null
trigger RF=null
trigger IF=null
trigger AF=null
trigger NF=null
trigger BF=null
trigger CF=null
trigger DF=null
trigger FF=null
trigger GF=null
trigger HF=null
trigger JF=null
trigger KF=null
trigger LF=null
trigger MF=null
trigger PF=null
trigger QF=null
trigger SF=null
trigger TF=null
trigger UF=null
trigger WF=null
trigger YF=null
trigger ZF=null
trigger VG=null
trigger EG=null
trigger XG=null
trigger OG=null
trigger RG=null
trigger IG=null
trigger AG=null
trigger NG=null
trigger BG=null
trigger CG=null
trigger DG=null
trigger FG=null
trigger GG=null
trigger HG=null
trigger JG=null
trigger KG=null
trigger LG=null
trigger MG=null
trigger PG=null
trigger QG=null
trigger SG=null
trigger TG=null
trigger UG=null
trigger WG=null
trigger YG=null
trigger ZG=null
trigger VH=null
trigger EH=null
trigger XH=null
trigger OH=null
trigger RH=null
trigger IH=null
trigger AH=null
trigger NH=null
trigger BH=null
trigger CH=null
trigger DH=null
trigger FH=null
trigger GH=null
trigger HH=null
trigger JH=null
trigger KH=null
trigger LH=null
trigger MH=null
trigger PH=null
trigger QH=null
trigger SH=null
trigger TH=null
trigger UH=null
trigger WH=null
trigger YH=null
trigger ZH=null
trigger VJ=null
trigger EJ=null
trigger XJ=null
trigger OJ=null
trigger RJ=null
trigger IJ=null
trigger AJ=null
trigger NJ=null
trigger BJ=null
trigger CJ=null
trigger DJ=null
trigger FJ=null
trigger GJ=null
trigger HJ=null
trigger JJ=null
trigger KJ=null
unit LJ=null
unit MJ=null
unit PJ=null
unit QJ=null
unit SJ=null
unit TJ=null
unit UJ=null
unit WJ=null
destructable YJ=null
destructable ZJ=null
destructable VK=null
destructable EK=null
integer XK=0
integer OK=0
integer array RK
unit array IK
unit array AK
integer array NK
real array BK
integer array CK
real array DK
integer array FK
real array GK
integer array HK
integer array JK
integer array KK
integer array LK
lightning array MK
real array PK
real array QK
real array SK
real array TK
real array UK
real array WK
real array YK
real array ZK
real array VL
real array EL
real array XL
real array OL
real array RL
real array IL
unit array AL
unit array NL
integer array BL
integer array CL
integer array DL
boolean array FL
integer GL=0
integer HL
integer JL=0
integer KL=0
integer array LL
integer ML
integer PL
integer QL
real UL=.0
real WL=.0
group YL=null
force ZL=null
boolexpr VM=null
endglobals
function XM takes location OM,real RM,real IM returns location
return Location(GetLocationX(OM)+RM*Cos(IM*bj_DEGTORAD),GetLocationY(OM)+RM*Sin(IM*bj_DEGTORAD))
endfunction
function AM takes nothing returns boolean
local real dx=GetDestructableX(GetFilterDestructable())-UL
local real dy=GetDestructableY(GetFilterDestructable())-WL
return(dx*dx+dy*dy<=bj_enumDestructableRadius)
endfunction
function NM takes real BM,location CM,code DM returns nothing
local rect r
if(BM>=0)then
set UL=GetLocationX(CM)
set WL=GetLocationY(CM)
set bj_enumDestructableRadius=BM*BM
set r=Rect(UL-BM,WL-BM,UL+BM,WL+BM)
call EnumDestructablesInRect(r,filterEnumDestructablesInCircleBJ,DM)
call RemoveRect(r)
set r=null
endif
endfunction
function FM takes rect r,boolexpr GM returns group
set YL=CreateGroup()
call GroupEnumUnitsInRect(YL,r,GM)
call DestroyBoolExpr(GM)
return YL
endfunction
function HM takes rect r returns group
set YL=CreateGroup()
call GroupEnumUnitsInRect(YL,r,VM)
return YL
endfunction
function JM takes rect r,player KM returns group
set YL=CreateGroup()
set bj_groupEnumOwningPlayer=KM
call GroupEnumUnitsInRect(YL,r,filterGetUnitsInRectOfPlayer)
return YL
endfunction
function LM takes real BM,location MM,boolexpr GM returns group
set YL=CreateGroup()
call GroupEnumUnitsInRangeOfLoc(YL,MM,BM,GM)
return YL
endfunction
function PM takes real BM,location MM returns group
set YL=CreateGroup()
call GroupEnumUnitsInRangeOfLoc(YL,MM,BM,VM)
return YL
endfunction
function QM takes player KM returns group
set YL=CreateGroup()
call GroupEnumUnitsOfPlayer(YL,KM,VM)
return YL
endfunction
function SM takes player KM returns force
set ZL=CreateForce()
call ForceAddPlayer(ZL,KM)
return ZL
endfunction
function TM takes boolexpr GM returns force
set ZL=CreateForce()
call ForceEnumPlayers(ZL,GM)
call DestroyBoolExpr(GM)
return ZL
endfunction
function UM takes itemtype WM,integer YM returns nothing
local group g
set bj_stockPickedItemType=WM
set bj_stockPickedItemLevel=YM
set g=CreateGroup()
call GroupEnumUnitsOfType(g,"marketplace",VM)
call ForGroup(g,function UpdateEachStockBuildingEnum)
call DestroyGroup(g)
set g=null
endfunction
function ZM takes nothing returns nothing
local integer pickedItemId
local itemtype VP
local integer EP=0
local integer XP=0
local integer YM
set YM=1
loop
if(bj_stockAllowedPermanent[YM])then
set XP=XP+1
if(GetRandomInt(1,XP)==1)then
set VP=ITEM_TYPE_PERMANENT
set EP=YM
endif
endif
if(bj_stockAllowedCharged[YM])then
set XP=XP+1
if(GetRandomInt(1,XP)==1)then
set VP=ITEM_TYPE_CHARGED
set EP=YM
endif
endif
if(bj_stockAllowedArtifact[YM])then
set XP=XP+1
if(GetRandomInt(1,XP)==1)then
set VP=ITEM_TYPE_ARTIFACT
set EP=YM
endif
endif
set YM=YM+1
exitwhen YM>$A
endloop
if(XP==0)then
set VP=null
return
endif
call UM(VP,EP)
set VP=null
endfunction
function OP takes nothing returns nothing
call ZM()
call TimerStart(bj_stockUpdateTimer,bj_STOCK_RESTOCK_INTERVAL,true,function ZM)
endfunction
function IP takes nothing returns boolean
return true
endfunction
function CP takes nothing returns integer
local integer DP=XK
if(DP!=0)then
set XK=RK[DP]
else
set OK=OK+1
set DP=OK
endif
if(DP>81)then
return 0
endif
set NK[DP]=(DP-1)*99
set CK[DP]=(DP-1)*99
set FK[DP]=(DP-1)*99
set HK[DP]=(DP-1)*99
set KK[DP]=(DP-1)*99
set LK[DP]=0
set RK[DP]=-1
return DP
endfunction
function FP takes nothing returns nothing
local timer t=GetExpiredTimer()
local integer i=GetHandleId(t)
local real x2=LoadReal(V,i,0)
local real y2=LoadReal(V,i,1)
local unit u=LoadUnitHandle(V,i,3)
local real x1=GetUnitX(u)
local real y1=GetUnitY(u)
local real dx=x1-x2
local real dy=y1-y2
local string s=UnitId2String(LoadInteger(V,i,2))
local unit uu
local location l
if GetUnitCurrentOrder(u)!=UnitId(s)then
call FlushChildHashtable(V,i)
call DestroyTimer(t)
else
if SquareRoot(dx*dx+dy*dy)<=$8C then
call IssueImmediateOrderById(u,$D0019)
set uu=CreateUnit(GetOwningPlayer(u),'h01N',x2,y2,0)
call IssueBuildOrder(uu,s,x2,y2)
call FlushChildHashtable(V,i)
call DestroyTimer(t)
set i=GetHandleId(uu)
call SaveUnitHandle(V,i,1,u)
call UnitApplyTimedLife(uu,'BTLF',8)
endif
endif
set u=null
set t=null
set uu=null
set s=null
set l=null
endfunction
function GP takes nothing returns nothing
local timer t
local unit u=GetTriggerUnit()
local location l
local integer i
local integer ii
local string s=UnitId2String(GetIssuedOrderId())
if s!=null and GetUnitAbilityLevel(u,'Arav')==0 and GetUnitTypeId(u)!='h01N' then
set l=GetOrderPointLoc()
set ii=GetHandleId(u)
set t=LoadTimerHandle(V,ii,0)
set i=GetHandleId(t)
call FlushChildHashtable(V,i)
call DestroyTimer(t)
set t=CreateTimer()
call TimerStart(t,.01,true,function FP)
set i=GetHandleId(t)
call SaveTimerHandle(V,ii,0,t)
call SaveReal(V,i,0,GetLocationX(l))
call SaveReal(V,i,1,GetLocationY(l))
call SaveInteger(V,i,2,UnitId(s))
call SaveUnitHandle(V,i,3,u)
call RemoveLocation(l)
endif
set u=null
set t=null
set l=null
set s=null
endfunction
function HP takes nothing returns nothing
local unit u=GetTriggerUnit()
local unit uu=GetOrderTargetUnit()
local integer i=GetHandleId(u)
if GetIssuedOrderId()==852024and GetUnitAbilityLevel(u,'Arav')>0 then
call RemoveUnit(u)
set u=LoadUnitHandle(V,i,1)
call FlushChildHashtable(V,i)
call IssueTargetOrderById(u,$D0038,uu)
call UnitSetConstructionProgress(uu,(GetPlayerTechCountSimple('R00S',GetOwningPlayer(u))*7))
endif
set u=null
set uu=null
endfunction
function JP takes nothing returns nothing
local trigger t=CreateTrigger()
local trigger tt=CreateTrigger()
call TriggerRegisterAnyUnitEventBJ(tt,EVENT_PLAYER_UNIT_ISSUED_TARGET_ORDER)
call TriggerRegisterAnyUnitEventBJ(t,EVENT_PLAYER_UNIT_ISSUED_POINT_ORDER)
call TriggerAddAction(t,function GP)
call TriggerAddAction(tt,function HP)
endfunction
function KP takes nothing returns nothing
set X=GetRectMaxX(GB)
set R=GetRectMaxY(GB)
set O=GetRectMinX(GB)
set I=GetRectMinY(GB)
endfunction
function LP takes real x,real y returns boolean
return x<X and x>O and y<R and y>I
endfunction
function MP takes unit u,player p,real r,integer e returns nothing
local integer i=0
local integer id=GetHandleId(u)
local integer n
local real ao
local real x=GetUnitX(u)
local real y=GetUnitY(u)
local real a
local destructable d
local integer ii=LoadInteger(E,id,$3E9)
local real xx
local real yy
set n=R2I(r)/ $A
set ao=360/ I2R(n)
call SaveInteger(E,id,0,n)
call SaveInteger(E,id,$3E9,ii+1)
if ii>0 then
loop
set i=i+1
exitwhen i>n
if LoadInteger(E,id,i)!=1 then
if GetLocalPlayer()==p then
call ShowDestructable(LoadDestructableHandle(E,id,i),true)
endif
endif
endloop
else
loop
set i=i+1
exitwhen i>n
set a=ao*i*bj_DEGTORAD
set xx=x+r*Cos(a)
set yy=y+r*Sin(a)
if LP(xx,yy)then
set d=CreateDestructable(e,xx,yy,0,1,0)
call SaveDestructableHandle(E,id,i,d)
call ShowDestructable(d,false)
if GetLocalPlayer()==p then
call ShowDestructable(d,true)
endif
else
call SaveInteger(E,id,i,1)
endif
endloop
endif
set d=null
endfunction
function PP takes unit u,player p returns nothing
local integer id=GetHandleId(u)
local integer i=0
local integer n=LoadInteger(E,id,0)
local integer ii=LoadInteger(E,id,$3E9)
if n>0 then
call SaveInteger(E,id,$3E9,ii-1)
if ii==0 then
loop
set i=i+1
exitwhen i>n
if LoadInteger(E,id,i)!=1 then
call RemoveDestructable(LoadDestructableHandle(E,id,i))
endif
endloop
call FlushChildHashtable(E,id)
else
loop
set i=i+1
exitwhen i>n
if LoadInteger(E,id,i)!=1 then
if GetLocalPlayer()==p then
call ShowDestructable(LoadDestructableHandle(E,id,i),false)
endif
endif
endloop
endif
endif
endfunction
function QP takes integer SP,integer TP returns boolean
local integer i=SP/ TP
return(SP/ TP)*TP==SP
endfunction
function UP takes nothing returns nothing
local integer i
local real x
local real y
local integer WP
local real f
local unit u
call GroupAddGroup(A,N)
loop
set u=FirstOfGroup(N)
exitwhen u==null
set WP=LoadInteger(B,GetHandleId(u),0)
set i=0
loop
exitwhen i>=LK[WP]
if JK[KK[WP]+i]==0 then
set f=GetUnitFacing(IK[WP])
set x=GetUnitX(IK[WP])+BK[CK[WP]+i]*Cos((f+GK[HK[WP]+i])*bj_DEGTORAD)
set y=GetUnitY(IK[WP])+BK[CK[WP]+i]*Sin((f+GK[HK[WP]+i])*bj_DEGTORAD)
else
set GK[HK[WP]+i]=GK[HK[WP]+i]+DK[FK[WP]+i]
set x=GetUnitX(IK[WP])+BK[CK[WP]+i]*Cos((GK[HK[WP]+i])*bj_DEGTORAD)
set y=GetUnitY(IK[WP])+BK[CK[WP]+i]*Sin((GK[HK[WP]+i])*bj_DEGTORAD)
endif
call SetUnitX(AK[NK[WP]+i],x)
call SetUnitY(AK[NK[WP]+i],y)
if GetUnitCurrentOrder(AK[NK[WP]+i])==851986then
call IssueImmediateOrderById(AK[NK[WP]+i],$D0004)
endif
set i=i+1
endloop
call GroupRemoveUnit(N,u)
endloop
endfunction
function YP takes unit u,integer id,real d,real a,real s,boolean ZP,integer VQ returns integer
local integer WP=LoadInteger(B,GetHandleId(u),0)
local real x=GetUnitX(u)+d*Cos((GetUnitFacing(u)+a)*bj_DEGTORAD)
local real y=GetUnitY(u)+d*Sin((GetUnitFacing(u)+a)*bj_DEGTORAD)
local integer i
if WP==0 then
set WP=CP()
set IK[WP]=u
call SaveInteger(B,GetHandleId(u),0,WP)
endif
set i=LK[WP]
set AK[NK[WP]+i]=CreateUnit(GetOwningPlayer(u),id,x,y,GetUnitFacing(u))
if VQ==0 then
set GK[HK[WP]+i]=a
else
set GK[HK[WP]+i]=GetUnitFacing(u)+a
set DK[FK[WP]+i]=s
endif
set BK[CK[WP]+i]=d
set JK[KK[WP]+i]=VQ
call SetUnitPathing(AK[NK[WP]+i],false)
call SetUnitInvulnerable(AK[NK[WP]+i],not ZP)
call GroupRemoveUnit(A,u)
call GroupAddUnit(A,u)
call SaveInteger(B,GetHandleId(AK[NK[WP]+i]),0,i)
call SaveUnitHandle(B,GetHandleId(AK[NK[WP]+i]),1,u)
set LK[WP]=LK[WP]+1
return WP
endfunction
function EQ takes unit XQ,integer OQ,real RQ,real IM,boolean IQ returns unit
local integer WP=YP(XQ,OQ,RQ,IM,0,IQ,0)
return AK[NK[WP]+LK[WP]-1]
endfunction
function AQ takes unit OQ returns nothing
local unit u=LoadUnitHandle(B,GetHandleId(OQ),1)
local integer i=LoadInteger(B,GetHandleId(OQ),0)
local integer WP=LoadInteger(B,GetHandleId(u),0)
if OQ!=null then
call FlushChildHashtable(B,GetHandleId(AK[NK[WP]+i]))
call RemoveUnit(AK[NK[WP]+i])
set LK[WP]=LK[WP]-1
set AK[NK[WP]+i]=AK[NK[WP]+LK[WP]]
set BK[CK[WP]+i]=BK[CK[WP]+LK[WP]]
set DK[FK[WP]+i]=DK[FK[WP]+LK[WP]]
set GK[HK[WP]+i]=GK[HK[WP]+LK[WP]]
set JK[KK[WP]+i]=JK[KK[WP]+LK[WP]]
endif
set u=null
endfunction
function NQ takes unit BQ returns nothing
local integer WP=LoadInteger(B,GetHandleId(BQ),0)
local integer i=0
loop
exitwhen i>=LK[WP]
call FlushChildHashtable(B,GetHandleId(AK[NK[WP]+i]))
call RemoveUnit(AK[NK[WP]+i])
set i=i+1
endloop
set LK[WP]=0
endfunction
function CQ takes nothing returns boolean
if LoadUnitHandle(B,GetHandleId(GetTriggerUnit()),1)!=null then
call AQ(GetTriggerUnit())
endif
return false
endfunction
function DQ takes nothing returns nothing
local trigger t=CreateTrigger()
call TriggerRegisterAnyUnitEventBJ(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function CQ))
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,.01,true)
call TriggerAddAction(t,function UP)
endfunction
function FQ takes nothing returns nothing
local timer t=GetExpiredTimer()
local integer i=GetHandleId(t)
local integer ii=LoadInteger(EN,i,0)
local real r=LoadReal(EN,i,1)
local unit u=LoadUnitHandle(EN,i,2)
if ii==1 then
call SetUnitFlyHeight(u,LoadReal(EN,i,3),0)
call FlushChildHashtable(EN,i)
call DestroyTimer(t)
else
call SaveInteger(EN,i,0,ii-1)
call SetUnitFlyHeight(u,GetUnitFlyHeight(u)+r,0)
endif
set t=null
set u=null
endfunction
function GQ takes unit u,real h,real t returns nothing
local timer tt=CreateTimer()
local integer i=GetHandleId(tt)
local real r=.03125
call SaveInteger(EN,i,0,R2I(t/ r))
call SaveReal(EN,i,1,h*r/ t)
call SaveUnitHandle(EN,i,2,u)
call SaveReal(EN,i,3,GetUnitFlyHeight(u)+h)
call TimerStart(tt,r,true,function FQ)
set tt=null
endfunction
function HQ takes nothing returns nothing
local timer t=GetExpiredTimer()
local integer i=GetHandleId(t)
local real ii=LoadReal(QX,i,0)
local texttag JQ=LoadTextTagHandle(QX,i,1)
if ii==0 then
call DestroyTimer(t)
call DestroyTextTag(JQ)
call FlushChildHashtable(QX,i)
call TriggerExecute(NF)
else
call SetTextTagPos(JQ,GetCameraEyePositionX(),GetCameraEyePositionY()+500,0)
call SetTextTagText(JQ,I2S(R2I(ii-.03125)),.1)
call SaveReal(QX,i,0,ii-.03125)
endif
endfunction
function KQ takes nothing returns nothing
local timer t=GetExpiredTimer()
local integer i=GetHandleId(t)
local unit u=LoadUnitHandle(QX,i,0)
call SetUnitInvulnerable(u,false)
call DestroyTimer(t)
call FlushChildHashtable(QX,i)
set u=null
set t=null
endfunction
function LQ takes unit u,real r returns nothing
local timer t=CreateTimer()
local integer i=GetHandleId(t)
call SaveUnitHandle(QX,i,0,u)
call TimerStart(t,r,false,function KQ)
call SetUnitInvulnerable(u,true)
set t=null
endfunction
function MQ takes nothing returns nothing
local timer t=GetExpiredTimer()
local integer i=GetHandleId(t)
local unit u=LoadUnitHandle(C,i,0)
local unit uu=LoadUnitHandle(C,i,1)
call SetUnitX(u,GetUnitX(uu))
call SetUnitY(u,GetUnitY(uu))
call FlushChildHashtable(C,i)
call DestroyTimer(t)
set t=null
endfunction
function PQ takes nothing returns nothing
local timer t=GetExpiredTimer()
local integer i=GetHandleId(t)
call PauseUnit(LoadUnitHandle(C,i,0),false)
call FlushChildHashtable(C,i)
call DestroyTimer(t)
set t=null
endfunction
function QQ takes unit u,real r returns nothing
local timer t=CreateTimer()
local integer i=GetHandleId(t)
call SaveUnitHandle(C,i,0,u)
call PauseUnit(u,true)
call TimerStart(t,r,false,function PQ)
set t=null
endfunction
function SQ takes nothing returns nothing
local timer t=GetExpiredTimer()
local integer i=GetHandleId(t)
call UnitDamageTarget(LoadUnitHandle(C,i,0),LoadUnitHandle(C,i,1),LoadReal(C,i,2),true,false,ATTACK_TYPE_CHAOS,DAMAGE_TYPE_NORMAL,WEAPON_TYPE_WHOKNOWS)
call FlushChildHashtable(C,i)
call DestroyTimer(t)
set t=null
endfunction
function TQ takes unit u,unit uu,real r,real rr returns nothing
local timer t=CreateTimer()
local integer i=GetHandleId(t)
call TimerStart(t,rr,false,function SQ)
call SaveUnitHandle(C,i,0,u)
call SaveUnitHandle(C,i,1,uu)
call SaveReal(C,i,2,r)
set t=null
endfunction
function UQ takes nothing returns nothing
call DialogDisplay(GetLocalPlayer(),F,false)
endfunction
function WQ takes nothing returns nothing
if not D then
call DialogDisplay(GetLocalPlayer(),F,true)
call TimerStart(G,.0,false,function UQ)
endif
endfunction
function YQ takes nothing returns nothing
local trigger t=CreateTrigger()
call TriggerRegisterGameEvent(t,EVENT_GAME_SAVE)
call TriggerAddAction(t,function WQ)
endfunction
function ZQ takes nothing returns nothing
call SetDestructableInvulnerable(GetEnumDestructable(),true)
return
endfunction
function VS takes unit u returns nothing
local integer ut=GetUnitTypeId(u)
local location l=GetUnitLoc(u)
local integer ui=GetUnitUserData(u)
local integer i
local unit uu
set i=LoadInteger(EN,ut,0)
if i>0 then
call RemoveDestructable(LoadDestructableHandle(EN,ui,0))
call RemoveUnit(LoadUnitHandle(EN,ui,1))
set HE=CreateDestructableZ(i,GetUnitX(u)+LoadReal(EN,ut,1),GetUnitY(u)+LoadReal(EN,ut,2),LoadReal(EN,ut,3),270,LoadReal(EN,ut,4),0)
call SaveDestructableHandle(EN,ui,0,HE)
if LoadReal(EN,ut,$B)>0 then
set uu=CreateUnit(GetOwningPlayer(u),'n012',GetUnitX(u),GetUnitY(u),270)
call SetUnitFlyHeight(uu,LoadReal(EN,ut,3)-80,0)
call SetUnitScale(uu,ON[ui]+1,ON[ui]+1,ON[ui]+1)
call SaveUnitHandle(EN,ui,1,uu)
call SetDestructableAnimationSpeed(HE,ON[ui])
endif
endif
set uu=null
call GroupAddUnit(DI,u)
if ut=='h005' then
call UnitAddAbility(u,'A001')
elseif ut=='h00V' then
call GroupAddUnit(YX,u)
call EnableTrigger(WH)
elseif LoadInteger(YE,ut,0)>0 then
call GroupAddUnit(WE,u)
call EnableTrigger(YH)
elseif LoadInteger(QX,ut,0)>0 then
call GroupAddUnit(TX,u)
call EnableTrigger(ZH)
elseif LoadInteger(QX,ut,2)>0 then
call GroupAddUnit(CI,u)
call EnableTrigger(EJ)
elseif LoadInteger(QX,ut,3)>0 then
call GroupAddUnit(FI,u)
if LoadInteger(QX,ut,4)==0 then
call UnitAddAbility(u,'A018')
call UnitRemoveAbility(u,'A017')
else
call UnitAddAbility(u,'A017')
call UnitRemoveAbility(u,'A018')
endif
elseif LoadInteger(OO,ut,0)>0 then
call GroupAddUnit(RO,u)
call EnableTrigger(UH)
elseif LoadBoolean(DO,ut,0) then
call GroupAddUnit(CO,u)
call EnableTrigger(VJ)
set GO[ui]=false
call DestroyFogModifier(FO[ui])
call RemoveDestructable(HO[ui])
elseif GetUnitAbilityLevel(u,'Alit')==1 then
call GroupAddUnit(KR,u)
endif
if LoadInteger(QX,ut,5)>0 then
call IssueImmediateOrderById(u,$D026D)
call NM(50,l,function ZQ)
endif
call RemoveLocation(l)
set l=null
endfunction
function ES takes nothing returns boolean
local unit u=GetTriggerUnit()
local player p=GetTriggerPlayer()
local integer i=GetPlayerId(p)+1
set PN=false
if not IsUnitInGroup(u,MN[i])then
call GroupAddUnit(MN[i],u)
set KN[i]=CountUnitsInGroup(MN[i])
else
set PN=true
endif
set JN=p
set HN=u
set LN=1
set LN=0
set u=null
return false
endfunction
function XS takes nothing returns boolean
local unit u=GetTriggerUnit()
local player p=GetTriggerPlayer()
local integer i=GetPlayerId(p)+1
call GroupRemoveUnit(MN[i],u)
set KN[i]=CountUnitsInGroup(MN[i])
set JN=p
set HN=u
set LN=2
set LN=0
set u=null
return false
endfunction
function OS takes nothing returns boolean
local unit u=GetTriggerUnit()
local integer i=0
loop
exitwhen i>$C
set i=i+1
if IsUnitInGroup(u,MN[i])then
call GroupRemoveUnit(MN[i],u)
set KN[i]=CountUnitsInGroup(MN[i])
set JN=Player(i-1)
set HN=u
set LN=2
set LN=0
endif
endloop
set u=null
return false
endfunction
function RS takes nothing returns nothing
local trigger t1=CreateTrigger()
local trigger t2=CreateTrigger()
local trigger t3=CreateTrigger()
local player p
local integer i=0
call TriggerAddCondition(t3,Condition(function OS))
call TriggerRegisterAnyUnitEventBJ(t3,EVENT_PLAYER_UNIT_DEATH)
loop
exitwhen i>$B
set p=Player(i)
if GetPlayerController(p)==MAP_CONTROL_USER and GetPlayerSlotState(p)==PLAYER_SLOT_STATE_PLAYING then
set MN[i+1]=CreateGroup()
call TriggerRegisterPlayerSelectionEventBJ(t1,p,true)
call TriggerAddCondition(t1,Condition(function ES))
call TriggerRegisterPlayerSelectionEventBJ(t2,p,false)
call TriggerAddCondition(t2,Condition(function XS))
endif
set i=i+1
endloop
set t1=null
set t2=null
set t3=null
endfunction
function IS takes player AS,string NS returns nothing
set NS="

















|cffffcc00"+NS+"|r"
if(GetLocalPlayer()==AS)then
call ClearTextMessages()
call DisplayTimedTextToPlayer(AS,.52,.96,2.,NS)
call StartSound(H[J])
endif
set J=J+1
if(J==4)then
set J=0
endif
endfunction
function BS takes nothing returns nothing
local integer i=0
loop
exitwhen i==4
set H[i]=CreateSoundFromLabel("InterfaceError",false,false,false,$A,$A)
set i=i+1
endloop
endfunction
function CS takes nothing returns nothing
set QL=DL[PL]
set CL[QL]=CL[PL]
if PL==GL then
set GL=QL
endif
set QL=CL[PL]
set DL[QL]=DL[PL]
if PL==HL then
set HL=QL
endif
call DestroyLightning(MK[PL])
set K=K-1
if K==0 then
call PauseTimer(L)
endif
set LL[PL]=KL
set KL=PL
endfunction
function DS takes nothing returns nothing
local real z1
local real z2
set ML=HL
loop
set z1=0
set z2=0
set BL[ML]=BL[ML]-1
if QK[ML]!=0 then
set PK[ML]=PK[ML]-QK[ML]
call SetLightningColor(MK[ML],1,1,1,PK[ML])
endif
if AL[ML]==null then
if VL[ML]!=0 then
set SK[ML]=SK[ML]+VL[ML]
endif
if EL[ML]!=0 then
set UK[ML]=UK[ML]+EL[ML]
endif
if XL[ML]!=0 then
set YK[ML]=YK[ML]+XL[ML]
endif
else
set SK[ML]=GetUnitX(AL[ML])
set UK[ML]=GetUnitY(AL[ML])
set z1=GetUnitFlyHeight(AL[ML])
endif
if NL[ML]==null then
if OL[ML]!=0 then
set TK[ML]=TK[ML]+OL[ML]
endif
if RL[ML]!=0 then
set WK[ML]=WK[ML]+RL[ML]
endif
if IL[ML]!=0 then
set ZK[ML]=ZK[ML]+IL[ML]
endif
else
set TK[ML]=GetUnitX(NL[ML])
set WK[ML]=GetUnitY(NL[ML])
set z2=GetUnitFlyHeight(NL[ML])
endif
if FL[ML]then
call MoveLocation(M,SK[ML],UK[ML])
set z1=GetLocationZ(M)+YK[ML]+z1
call MoveLocation(M,TK[ML],WK[ML])
set z2=GetLocationZ(M)+ZK[ML]+z2
call MoveLightningEx(MK[ML],true,SK[ML],UK[ML],z1,TK[ML],WK[ML],z2)
endif
if BL[ML]==0 then
set PL=ML
set ML=CL[ML]
call CS()
else
set ML=CL[ML]
endif
exitwhen ML==0
endloop
endfunction
function FS takes nothing returns nothing
if GL!=0 then
set PL=GL
set CL[PL]=ML
endif
set DL[ML]=GL
set GL=ML
set K=K+1
if K==1 then
set HL=ML
call TimerStart(L,.03125,true,function DS)
endif
endfunction
function GS takes nothing returns nothing
if 0==KL then
set JL=JL+1
set ML=JL
else
set ML=KL
set KL=LL[ML]
endif
endfunction
function HS takes lightning l,unit s,unit t,real JS,real z1,real z2,real KS,real LS returns nothing
local integer DP
call GS()
set DP=ML
set YK[DP]=z1
set ZK[DP]=z2
set AL[DP]=s
set NL[DP]=t
set CL[DP]=0
set MK[DP]=l
set BL[DP]=R2I(JS/ .03125)
set PK[DP]=KS
set QK[DP]=(KS-LS)*.03125/ JS
set FL[DP]=true
call FS()
endfunction
function MS takes nothing returns nothing
local timer t=GetExpiredTimer()
local integer i=GetHandleId(t)
call RemoveDestructable(LoadDestructableHandle(EN,i,0))
call FlushChildHashtable(EN,i)
call DestroyTimer(t)
set t=null
endfunction
function PS takes integer t,real x,real y,real z,real a,real s,real h returns nothing
local timer JS=CreateTimer()
local integer i=GetHandleId(JS)
call TimerStart(JS,h,false,function MS)
call SaveDestructableHandle(EN,i,0,CreateDestructableZ(t,x,y,z,a,s,0))
set JS=null
endfunction
function QS takes nothing returns nothing
local integer i=0
local player p
loop
exitwhen i==$C
set i=i+1
set p=Player(-1+(i))
if GetLocalPlayer()==p then
call MultiboardSetItemValueBJ(II,1,1,(WV[1]+(I2S(AV[i])+"|r")))
call MultiboardSetItemValueBJ(II,2,1,(WV[2]+(I2S(BV[i])+"|r")))
call MultiboardSetItemValueBJ(II,3,1,(WV[3]+(I2S(NV[i])+"|r")))
call MultiboardSetItemValueBJ(II,4,1,(WV[4]+(I2S(CV[i])+"|r")))
endif
set p=null
endloop
endfunction
function SS takes unit u returns nothing
local integer i=GetUnitUserData(u)
local unit uu
if CountUnitsInGroup(JI)>0 and GetRandomInt(1,3)>1 then
set uu=GroupPickRandomUnit(JI)
call IssueTargetOrderById(u,$D0003,uu)
else
set uu=GroupPickRandomUnit(DI)
call IssueTargetOrderById(u,$D0003,uu)
endif
set KI[i]=uu
set uu=null
endfunction
function TS takes nothing returns nothing
call SetDestructableInvulnerable(GetEnumDestructable(),false)
endfunction
function CU takes unit u returns nothing
local location l=GetUnitLoc(u)
local integer ut=GetUnitTypeId(u)
local integer ui=GetUnitUserData(u)
local integer ud=GetHandleId(u)
local integer i=0
call RemoveUnit(LoadUnitHandle(XN,ud,0))
loop
exitwhen i>$C
set i=i+1
if IsUnitInGroup(u,MN[i])then
call GroupRemoveUnit(MN[i],u)
set KN[i]=CountUnitsInGroup(MN[i])
set JN=Player(i-1)
set HN=u
set LN=2
set LN=0
endif
endloop
call RemoveDestructable(LoadDestructableHandle(EN,ui,0))
call RemoveUnit(LoadUnitHandle(EN,ui,1))
call UnitShareVision(PV[ui],GetOwningPlayer(u),false)
set BI[ui]=null
call NQ(u)
call DestroyFogModifier(FO[ui])
call RemoveDestructable(HO[ui])
set HI[ui]=0
call GroupRemoveUnit(JI,u)
if LoadInteger(QX,ut,5)>0 then
call NM(50,l,function TS)
endif
if LoadInteger(OO,ut,0)>0 then
call GroupRemoveUnit(RO,u)
endif
call GroupRemoveUnit(WE,u)
call GroupRemoveUnit(FI,u)
call GroupRemoveUnit(DI,u)
call GroupRemoveUnit(TE,u)
call GroupRemoveUnit(TX,u)
call GroupRemoveUnit(CO,u)
call GroupRemoveUnit(YX,u)
call GroupRemoveUnit(KR,u)
call GroupRemoveUnit(CI,u)
set ZE[ui]=false
if ut=='n002' or ut=='h01N' then
call RemoveUnit(u)
endif
call FlushChildHashtable(XN,ud)
call FlushChildHashtable(YE,ud)
call FlushChildHashtable(QX,ud)
call FlushChildHashtable(EN,ud)
call RemoveLocation(l)
set l=null
endfunction
function US takes nothing returns nothing
local integer i=0
local integer j=0
loop
set YO[i+48]=j
set ZO[i]=i+48
set j=j+1
set i=i+1
exitwhen i>=$A
endloop
set i=0
loop
set YO[i+97]=j
set YO[i+65]=j+26
set ZO[i+$A]=i+97
set ZO[i+26+$A]=i+65
set j=j+1
set i=i+1
exitwhen i>=26
endloop
endfunction
function ZS takes string s returns string
local integer i=StringLength(s)
local string c
local string r=""
loop
set i=i-1
set c=SubString(s,i,i+1)
if c=="0" or c=="1" or c=="2" or c=="3" or c=="4" or c=="5" or c=="6" or c=="7" or c=="8" or c=="9" then
set r="|cffffcc00"+c+"|r"+r
elseif c=="-" then
set r="|cffdddddd-|r"+r
else
set r=c+r
endif
exitwhen i<=0
endloop
return r
endfunction
function VT takes string n returns integer
local integer i=0
local string s1="ABCDEFGHIJKLMNOPQRSTUVWXYZ"
local string s2="abcdefghijklmnopqrstuvwxyz"
local string s3="0123456789"
loop
if SubString(s1,i,i+1)==n then
return i
endif
if SubString(s2,i,i+1)==n then
return i
endif
set i=i+1
exitwhen i>=26
endloop
set i=0
loop
if SubString(s3,i,i+1)==n then
return i
endif
set i=i+1
exitwhen i>=$A
endloop
return 0
endfunction
function ET takes string XT returns integer
local integer i=0
local integer j=0
local string OT=GetPlayerName(GetTriggerPlayer())
if PO then
loop
set j=j+VT(SubString(OT,i,i+1))
set i=i+1
exitwhen i>=StringLength(OT)
endloop
endif
set i=0
loop
set j=j+VT(SubString(XT,i,i+1))
set i=i+1
exitwhen i>=StringLength(XT)
endloop
return j
endfunction
function RT takes nothing returns string
local integer i
local integer j
local integer k
local integer l
local integer m
local integer IT=StringLength(LO)
local integer array a
local string XT=""
local string c=""
local integer AT=0
local integer NT=$F4240
local string BT="0123456789"
set i=0
loop
set i=i+1
exitwhen i>UO
set XT=XT+I2S(TO[i])+"-"
endloop
set XT=XT+I2S(ET(XT))
if TO[1]==0 then
set XT="-"+XT
endif
set i=0
loop
set a[i]=0
set i=i+1
exitwhen i>='d'
endloop
set m=0
set i=0
loop
set j=0
loop
set a[j]=a[j]*$B
set j=j+1
exitwhen j>m
endloop
set l=0
set c=SubString(XT,i,i+1)
loop
exitwhen SubString(BT,l,l+1)==c
set l=l+1
exitwhen l>9
endloop
set a[0]=a[0]+l
set j=0
loop
set k=a[j]/ NT
set a[j]=a[j]-k*NT
set a[j+1]=a[j+1]+k
set j=j+1
exitwhen j>m
endloop
if k>0 then
set m=m+1
endif
set i=i+1
exitwhen i>=StringLength(XT)
endloop
set XT=""
loop
exitwhen m<0
set j=m
loop
exitwhen j<=0
set k=a[j]/ IT
set a[j-1]=a[j-1]+(a[j]-k*IT)*NT
set a[j]=k
set j=j-1
endloop
set k=a[j]/ IT
set i=a[j]-k*IT
set XT=XT+SubString(LO,i,i+1)
set a[j]=k
if a[m]==0 then
set m=m-1
endif
endloop
set i=StringLength(XT)
set AT=0
set c=""
loop
set i=i-1
set c=c+SubString(XT,i,i+1)
set AT=AT+1
if AT==4 and i>0 then
set c=c+"-"
set AT=0
endif
exitwhen i<=0
endloop
return c
endfunction
function CT takes string s returns boolean
local integer i
local integer j
local integer k
local integer l
local integer DT=0
local integer m
local integer array a
local string XT=""
local integer IT=StringLength(LO)
local integer AT=-1
local integer NT=$F4240
local string BT="0123456789-"
local string c
set i=0
loop
set a[i]=0
set i=i+1
exitwhen i>='d'
endloop
set m=0
set i=0
loop
set j=0
loop
set a[j]=a[j]*IT
set j=j+1
exitwhen j>m
endloop
set AT=AT+1
if AT==4 then
set AT=0
set i=i+1
endif
set l=IT
set c=SubString(s,i,i+1)
loop
set l=l-1
exitwhen l<1
exitwhen SubString(LO,l,l+1)==c
endloop
set a[0]=a[0]+l
set j=0
loop
set k=a[j]/ NT
set a[j]=a[j]-k*NT
set a[j+1]=a[j+1]+k
set j=j+1
exitwhen j>m
endloop
if k>0 then
set m=m+1
endif
set i=i+1
exitwhen i>=StringLength(s)
endloop
loop
exitwhen m<0
set j=m
loop
exitwhen j<=0
set k=a[j]/ $B
set a[j-1]=a[j-1]+(a[j]-k*$B)*NT
set a[j]=k
set j=j-1
endloop
set k=a[j]/ $B
set i=a[j]-k*$B
set XT=SubString(BT,i,i+1)+XT
set a[j]=k
if a[m]==0 then
set m=m-1
endif
endloop
set i=0
set j=0
loop
loop
exitwhen i>=StringLength(XT)
exitwhen i>0 and SubString(XT,i,i+1)=="-" and SubString(XT,i-1,i)!="-"
set i=i+1
endloop
if i<StringLength(XT)then
set k=i
endif
set DT=DT+1
set TO[DT]=S2I(SubString(XT,j,i))
set j=i+1
set i=i+1
exitwhen i>=StringLength(XT)
endloop
set j=ET(SubString(XT,0,k))
set UO=DT-1
if j==TO[DT]then
return true
endif
return false
endfunction
function FT takes nothing returns string
if MO==false then
set LO=StringCase(LO,true)
endif
return ZS(RT())
endfunction
function GT takes string s returns boolean
if MO==false then
set LO=StringCase(LO,true)
set s=StringCase(s,true)
endif
if CT(s)then
return true
endif
return false
endfunction
function HT takes nothing returns nothing
local timer t=GetExpiredTimer()
local integer i=GetHandleId(t)
local integer h=LoadInteger(EN,i,2)
local real r=LoadReal(EN,i,3)
local unit u=LoadUnitHandle(EN,i,0)
local real a=LoadReal(EN,i,1)*bj_DEGTORAD
local real x=GetUnitX(u)+r*Cos(a)
local real y=GetUnitY(u)+r*Sin(a)
if LP(x,y)and h>0 then
call SetUnitX(u,x)
call SetUnitY(u,y)
call SaveInteger(EN,i,2,h-1)
else
call DestroyTimer(t)
call FlushChildHashtable(EN,i)
endif
set t=null
set u=null
endfunction
function JT takes unit u,real a,real d,real t returns nothing
local timer tt=CreateTimer()
local real p=.03125
local integer i=GetHandleId(tt)
call SaveUnitHandle(EN,i,0,u)
call SaveReal(EN,i,1,a)
call SaveInteger(EN,i,2,R2I(t/ p))
call SaveReal(EN,i,3,d*p/ t)
call TimerStart(tt,p,true,function HT)
set tt=null
endfunction
function KT takes nothing returns nothing
local player p=Player(0)
local unit u
local integer unitID
local trigger t
local real LT
set SJ=CreateUnit(p,'h002',10688.,-4736.,270.)
call SetUnitColor(SJ,ConvertPlayerColor(0))
set TJ=CreateUnit(p,'h001',11520.,-4992.,270.)
call SetUnitColor(TJ,ConvertPlayerColor(6))
set u=CreateUnit(p,'h00W',11392.,-4224.,270.)
set u=CreateUnit(p,'h002',10560.,-4800.,270.)
call SetUnitColor(u,ConvertPlayerColor(0))
set u=CreateUnit(p,'h002',10560.,-4928.,270.)
call SetUnitColor(u,ConvertPlayerColor(0))
set u=CreateUnit(p,'h001',11584.,-4736.,270.)
call SetUnitColor(u,ConvertPlayerColor(6))
set LJ=CreateUnit(p,'h003',11136.,-4224.,270.)
call SetUnitColor(LJ,ConvertPlayerColor(2))
set u=CreateUnit(p,'h01O',11296.,-4128.,270.)
endfunction
function MT takes nothing returns nothing
local player p=Player($F)
local unit u
local integer unitID
local trigger t
local real LT
set WJ=CreateUnit(p,'h01M',-1102.7,-403.3,180.)
endfunction
function CreatePlayerBuildings takes nothing returns nothing
local player p
local unit u
local integer unitID
local trigger t
local real LT
set p=Player(0)
set SJ=CreateUnit(p,'h002',10688.,-4736.,270.)
call SetUnitColor(SJ,ConvertPlayerColor(0))
set TJ=CreateUnit(p,'h001',11520.,-4992.,270.)
call SetUnitColor(TJ,ConvertPlayerColor(6))
set u=CreateUnit(p,'h00W',11392.,-4224.,270.)
set u=CreateUnit(p,'h002',10560.,-4800.,270.)
call SetUnitColor(u,ConvertPlayerColor(0))
set u=CreateUnit(p,'h002',10560.,-4928.,270.)
call SetUnitColor(u,ConvertPlayerColor(0))
set u=CreateUnit(p,'h001',11584.,-4736.,270.)
call SetUnitColor(u,ConvertPlayerColor(6))
set LJ=CreateUnit(p,'h003',11136.,-4224.,270.)
call SetUnitColor(LJ,ConvertPlayerColor(2))
set u=CreateUnit(p,'h01O',11296.,-4128.,270.)
endfunction
function PT takes nothing returns nothing
local player p
local unit u
local integer unitID
local trigger t
local real LT
set p=Player(0)
set QJ=CreateUnit(p,'H01Q',11015.6,-4469.5,260.339)
set p=Player(1)
set PJ=CreateUnit(p,'H01Q',11022.8,-4268.8,58.42)
set p=Player(2)
set u=CreateUnit(p,'H01S',10848.6,-4045.,61.61)
set p=Player(3)
set u=CreateUnit(p,'H01Q',10884.9,-3947.4,238.517)
set p=Player(4)
set u=CreateUnit(p,'H01S',11397.4,-3770.7,309.4)
set p=Player(5)
set u=CreateUnit(p,'H01S',11493.9,-3876.8,124.95)
set p=Player(6)
set u=CreateUnit(p,'H01Q',11692.9,-4300.3,28.321)
set p=Player(7)
set u=CreateUnit(p,'H01Q',11199.1,-4523.3,310.638)
set p=Player(8)
set u=CreateUnit(p,'H01Q',11298.6,-4651.,121.322)
set p=Player(9)
set MJ=CreateUnit(p,'H01Q',11432.8,-4890.1,302.16)
set p=Player($A)
set UJ=CreateUnit(p,'H01Q',10802.4,-4818.4,148.33)
endfunction
function QT takes nothing returns nothing
call SetUnitOwner(GetEnumUnit(),Player($F),false)
endfunction
function ST takes nothing returns nothing
call UseTimeOfDayBJ(false)
call SetDayNightModels("","")
call ShowUnitHide(WJ)
call SetUnitTimeScalePercent(WJ,.0)
call PlaySoundBJ(FD)
set bj_wantDestroyGroup=true
call ForGroupBJ(HM(QB),function QT)
set XI[40]=" [强者]"
set XI[50]=" [杀手]"
set XI[60]=" [破坏者]"
set XI[70]=" [半神]"
set XI[80]=" [万能者]"
call SetUserControlForceOff(bj_FORCE_ALL_PLAYERS)
call SetPlayerAllianceStateBJ(Player($B),Player($F),1)
call SetPlayerAllianceStateBJ(Player($B),Player($C),3)
call SetPlayerAllianceStateBJ(Player($C),Player($B),3)
call AddWeatherEffectSaveLast(bj_mapInitialPlayableArea,'LRaa')
set ZR=bj_lastCreatedWeatherEffect
call SetDestAnimationSpeedPercent(VK,.0)
call SetDestAnimationSpeedPercent(EK,.0)
call SetDestAnimationSpeedPercent(ZJ,.0)
call SetDestAnimationSpeedPercent(YJ,.0)
call ShowDestructableBJ(false,VK)
call ShowDestructableBJ(false,EK)
call ShowDestructableBJ(false,YJ)
call ShowDestructableBJ(false,ZJ)
call CinematicFadeBJ(1,.0,"ReplaceableTextures\\CameraMasks\\Black_mask.blp",100.,.0,.0,0)
call TriggerRegisterTimerEvent(VF,.0015,true)
call SetSkyModel("Environment\\Sky\\Sky\\SkyLight.mdl")
call EnableDawnDusk(false)
set TI[1]=3000.
set UI[1]=30
set WI[1]='d'
set YI[1]=3.
call InitHashtableBJ()
set SI=GetLastCreatedHashtableBJ()
call InitHashtableBJ()
set YE=GetLastCreatedHashtableBJ()
call InitHashtableBJ()
set QX=GetLastCreatedHashtableBJ()
call InitHashtableBJ()
set OO=GetLastCreatedHashtableBJ()
call InitHashtableBJ()
set XN=GetLastCreatedHashtableBJ()
call InitHashtableBJ()
set XO=GetLastCreatedHashtableBJ()
call InitHashtableBJ()
set DO=GetLastCreatedHashtableBJ()
set EO[1]='A00C'
set EO[2]='A00D'
set EO[3]='A00F'
set EO[4]='A00H'
set EO[5]='A00I'
set EO[6]='A00L'
set EO[7]='A00W'
set EO[8]='A011'
set EO[9]='A017'
set EO[$A]='A018'
set EO[$B]='A01B'
set EO[$C]='A01N'
set EO[$D]='A00E'
set EO[$E]='A01M'
set EO[$F]='A01W'
set EO[16]='A01V'
set EO[17]='A01Y'
set EO[18]='A01X'
set VO[1]=MG
set VO[2]=PG
set VO[3]=AJ
set VO[4]=QG
set VO[5]=SG
set VO[6]=TG
set VO[7]=WG
set VO[8]=UG
set VO[9]=ZG
set VO[$A]=YG
set VO[$B]=VH
set VO[$C]=XH
set VO[$D]=OH
set VO[$E]=EH
set VO[$F]=IH
set VO[16]=RH
set VO[17]=NH
set VO[18]=AH
call TriggerExecute(TH)
endfunction
function UT takes nothing returns nothing
call VolumeGroupSetVolumeBJ(SOUND_VOLUMEGROUP_FIRE,.0)
call KillSoundWhenDone(bj_dayAmbientSound)
call KillSoundWhenDone(bj_nightAmbientSound)
set AO[1]='B004'
set AO[2]='B000'
set AO[3]='B003'
set AO[4]='B00M'
set AO[5]='B00N'
set AO[6]='B00O'
set AO[7]='B00P'
set AO[8]='B00Q'
set AO[9]='B00R'
set AO[$A]='B00S'
set AO[$B]='B00T'
set AO[$C]='B00U'
set AO[$D]='B00V'
set NO[1]='B00S'
set NO[2]='B00T'
set NO[3]='B00U'
set NO[4]='B00V'
set NO[5]='B00M'
set NO[6]='B00N'
set NO[7]='B00O'
set NO[8]='B00P'
set NO[9]='B00Q'
set NO[$A]='B00R'
set BO[1]='B001'
set BO[2]='B00E'
set BO[3]='B002'
set BO[4]='B005'
set BO[5]='B006'
set BO[6]='B007'
set BO[7]='B00X'
set BO[8]='B00Y'
set BO[9]='B00Z'
set VX[1]="|cffff0303"
set VX[2]="|cff0042ff"
set VX[3]="|cff1ce6b9"
set VX[4]="|cff540081"
set VX[5]="|cfffffc01"
set VX[6]="|cfffe8a0e"
set VX[7]="|cff20c000"
set VX[8]="|cffe55bb0"
set VX[9]="|cff959697"
set VX[$A]="|cff7ebff1"
set VX[$B]="|cff106246"
set VX[$C]="|cff4e2a04"
set HR[1]=WC
set HR[2]=AC
set HR[3]=UC
set HR[4]=TC
set Q='A000'
set S='A001'
set DV='h000'
call SaveInteger(XN,DV,DV,1)
set DV='h003'
call SaveInteger(XN,DV,DV,2)
set DV='h001'
call SaveInteger(XN,DV,DV,3)
set DV='h002'
call SaveInteger(XN,DV,DV,4)
set FV[1]=SD
set FV[2]=TD
set FV[3]=UD
set FV[4]=WD
set GV[1]='R003'
set GV[2]='R004'
set GV[3]='R002'
set GV[4]='R001'
set WV[1]="|cff0000ff"
set WV[2]="|cff99b4d1"
set WV[3]="|cffadff2f"
set WV[4]="|cffff0000"
set PX[1]='A009'
set PX[2]='A00A'
set PX[3]='A00B'
set PX[4]='A008'
endfunction
function YT takes nothing returns boolean
return(GetIssuedOrderId()==$D0003)
endfunction
function ZT takes nothing returns boolean
return(Z>0)and(GetUnitAbilityLevelSwapped(Q,EV)>0)
endfunction
function VU takes nothing returns boolean
return(UV[Y]>=1.)and(GetUnitAbilityLevelSwapped(S,XV)>0)and(GetOwningPlayer(EV)==GetOwningPlayer(XV))
endfunction
function EU takes nothing returns nothing
set EV=GetTriggerUnit()
set Y=GetUnitUserData(EV)
set XV=GetOrderTargetUnit()
set DV=GetUnitTypeId(XV)
set Z=LoadInteger(XN,DV,DV)
if(VU())then
call IssueTargetOrderById(EV,$D000F,XV)
else
if(ZT())then
call IssueTargetOrderById(EV,$D000F,XV)
endif
endif
endfunction
function OU takes nothing returns boolean
return(DV!='h000')and(DV!='h003')and(DV!='h001')and(DV!='h002')and(GetOwningPlayer(XV)==YV)
endfunction
function RU takes nothing returns boolean
return(YV==GetFilterPlayer())
endfunction
function IU takes nothing returns boolean
return(GetUnitTypeId(EV)=='h011')
endfunction
function AU takes nothing returns boolean
return(UnitHasBuffBJ(EV,'B000'))
endfunction
function NU takes nothing returns boolean
return(Z!=LV[Y])
endfunction
function BU takes nothing returns boolean
return(Z>0)and(GetUnitAbilityLevelSwapped(Q,EV)>0)
endfunction
function DU takes nothing returns boolean
return(YV==GetFilterPlayer())
endfunction
function FU takes nothing returns boolean
return(GetUnitAbilityLevelSwapped(S,XV)>0)and(VV>0)and(GetOwningPlayer(XV)==YV)
endfunction
function GU takes nothing returns boolean
return(GetUnitAbilityLevelSwapped(S,XV)>0)and(VV>0)and(IX!=Player($F))and(IsPlayerAlly(IX,YV))and(GetPlayerTechCountSimple('R012',YV)==1)
endfunction
function HU takes nothing returns nothing
set EV=GetAttacker()
set Y=GetUnitUserData(EV)
set YV=GetOwningPlayer(EV)
set XV=GetTriggerUnit()
set IX=GetOwningPlayer(XV)
set DV=GetUnitTypeId(XV)
set VV=R2I(UV[Y])
if(OU())then
call IssueImmediateOrderById(EV,$D0004)
endif
if(GU())then
call UnitRemoveAbility(EV,PX[1])
call UnitRemoveAbility(EV,PX[2])
call UnitRemoveAbility(EV,PX[3])
call UnitRemoveAbility(EV,PX[4])
set Z=(1+GetPlayerId(YV))
call CreateTextTagUnitBJ((WV[LV[Y]]+(I2S(VV)+"|r")),EV,0,9.,'d','d','d',0)
set ZV=bj_lastCreatedTextTag
call ShowTextTagForceBJ(false,ZV,XE)
call ShowTextTagForceBJ(true,ZV,TM(Condition(function RU)))
call SetTextTagVelocityBJ(ZV,64,90)
call SetTextTagSuspendedBJ(ZV,false)
call SetTextTagPermanentBJ(ZV,false)
call SetTextTagLifespanBJ(ZV,3.)
call SetTextTagFadepointBJ(ZV,2.)
call PlaySoundOnUnitBJ(HR[LV[Y]],'d',EV)
call TriggerExecute(FV[LV[Y]])
call GroupAddUnit(EE,EV)
call EnableTrigger(PD)
else
if(FU())then
call UnitRemoveAbility(EV,PX[1])
call UnitRemoveAbility(EV,PX[2])
call UnitRemoveAbility(EV,PX[3])
call UnitRemoveAbility(EV,PX[4])
set Z=(1+GetPlayerId(YV))
call CreateTextTagUnitBJ((WV[LV[Y]]+(I2S(VV)+"|r")),EV,0,9.,'d','d','d',0)
set ZV=bj_lastCreatedTextTag
call ShowTextTagForceBJ(false,ZV,XE)
call ShowTextTagForceBJ(true,ZV,TM(Condition(function DU)))
call SetTextTagVelocityBJ(ZV,64,90)
call SetTextTagSuspendedBJ(ZV,false)
call SetTextTagPermanentBJ(ZV,false)
call SetTextTagLifespanBJ(ZV,3.)
call SetTextTagFadepointBJ(ZV,2.)
call PlaySoundOnUnitBJ(HR[LV[Y]],'d',EV)
call TriggerExecute(FV[LV[Y]])
call GroupAddUnit(EE,EV)
call EnableTrigger(PD)
else
set DV=GetUnitTypeId(XV)
set Z=LoadInteger(XN,DV,DV)
if(BU())then
call UnitShareVisionBJ(false,PV[Y],YV)
if(NU())then
call UnitRemoveAbility(EV,PX[1])
call UnitRemoveAbility(EV,PX[2])
call UnitRemoveAbility(EV,PX[3])
call UnitRemoveAbility(EV,PX[4])
call UnitAddAbility(EV,PX[Z])
set LV[Y]=Z
set PV[Y]=XV
set UV[Y]=.0
set VV=(1+GetPlayerId(YV))
set JE=GetPlayerTechCountSimple('R000',YV)
set KE=(GetPlayerTechCountSimple(GV[Z],YV)+(1*GetPlayerTechCountSimple('R008',YV)))
if(IU())then
set KE=((KE/ 4)+1)
endif
set GE[Y]=I2R(KE)
if(AU())then
set QV[Y]=1.
else
set QV[Y]=(5./(1.+(I2R(GetPlayerTechCountSimple('R000',YV))*.25)))
endif
set TV[Y]=((I2R(KE)/ QV[Y])*.03)
call GroupAddUnit(MV,EV)
call EnableTrigger(QD)
else
set PV[Y]=XV
call GroupAddUnit(MV,EV)
call EnableTrigger(QD)
endif
call UnitShareVisionBJ(true,XV,YV)
else
call GroupRemoveUnit(MV,EV)
endif
endif
endif
endfunction
function KU takes nothing returns nothing
set EV=GetEnumUnit()
set Y=GetUnitUserData(EV)
call GroupRemoveUnit(EE,EV)
call IssueTargetOrderById(EV,$D000F,PV[Y])
endfunction
function LU takes nothing returns nothing
call ForGroupBJ(EE,function KU)
call DisableTrigger(GetTriggeringTrigger())
endfunction
function Trig_Harvest_Periodic_Func001Func004Func012Func005Func002001002001 takes nothing returns boolean
return(GetUnitAbilityLevelSwapped(S,GetFilterUnit())>0)
endfunction
function Trig_Harvest_Periodic_Func001Func004Func012Func005Func002001002002001 takes nothing returns boolean
return(IsUnitAliveBJ(GetFilterUnit()))
endfunction
function Trig_Harvest_Periodic_Func001Func004Func012Func005Func002001002002002001 takes nothing returns boolean
return(IsPlayerAlly(GetOwningPlayer(GetFilterUnit()),YV))
endfunction
function Trig_Harvest_Periodic_Func001Func004Func012Func005Func002001002002002002 takes nothing returns boolean
return(GetOwningPlayer(GetFilterUnit())!=Player($F))
endfunction
function Trig_Harvest_Periodic_Func001Func004Func012Func005Func002001002002002 takes nothing returns boolean
return GetBooleanAnd((IsPlayerAlly(GetOwningPlayer(GetFilterUnit()),YV)),(GetOwningPlayer(GetFilterUnit())!=Player($F)))
endfunction
function Trig_Harvest_Periodic_Func001Func004Func012Func005Func002001002002 takes nothing returns boolean
return GetBooleanAnd((IsUnitAliveBJ(GetFilterUnit())),(GetBooleanAnd((IsPlayerAlly(GetOwningPlayer(GetFilterUnit()),YV)),(GetOwningPlayer(GetFilterUnit())!=Player($F)))))
endfunction
function PU takes nothing returns boolean
return GetBooleanAnd((GetUnitAbilityLevelSwapped(S,GetFilterUnit())>0),(GetBooleanAnd((IsUnitAliveBJ(GetFilterUnit())),(GetBooleanAnd((IsPlayerAlly(GetOwningPlayer(GetFilterUnit()),YV)),(GetOwningPlayer(GetFilterUnit())!=Player($F)))))))
endfunction
function QU takes nothing returns boolean
return(U<T)
endfunction
function SU takes nothing returns nothing
set XV=GetEnumUnit()
set IV=GetUnitLoc(XV)
set U=DistanceBetweenPoints(RV,IV)
if(QU())then
set T=U
set OV=XV
set SV=true
endif
call RemoveLocation(IV)
endfunction
function Trig_Harvest_Periodic_Func001Func004Func012Func005Func004001002001 takes nothing returns boolean
return(GetUnitAbilityLevelSwapped(S,GetFilterUnit())>0)
endfunction
function Trig_Harvest_Periodic_Func001Func004Func012Func005Func004001002002001 takes nothing returns boolean
return(IsUnitAliveBJ(GetFilterUnit()))
endfunction
function Trig_Harvest_Periodic_Func001Func004Func012Func005Func004001002002002 takes nothing returns boolean
return(GetOwningPlayer(GetFilterUnit())==YV)
endfunction
function Trig_Harvest_Periodic_Func001Func004Func012Func005Func004001002002 takes nothing returns boolean
return GetBooleanAnd((IsUnitAliveBJ(GetFilterUnit())),(GetOwningPlayer(GetFilterUnit())==YV))
endfunction
function TU takes nothing returns boolean
return GetBooleanAnd((GetUnitAbilityLevelSwapped(S,GetFilterUnit())>0),(GetBooleanAnd((IsUnitAliveBJ(GetFilterUnit())),(GetOwningPlayer(GetFilterUnit())==YV))))
endfunction
function UU takes nothing returns boolean
return(U<T)
endfunction
function WU takes nothing returns nothing
set XV=GetEnumUnit()
set IV=GetUnitLoc(XV)
set U=DistanceBetweenPoints(RV,IV)
if(UU())then
set T=U
set OV=XV
set SV=true
endif
call RemoveLocation(IV)
endfunction
function YU takes nothing returns boolean
return(GetPlayerTechCountSimple('R012',YV)==1)
endfunction
function ZU takes nothing returns boolean
return(YV==GetFilterPlayer())
endfunction
function VW takes nothing returns boolean
return(T<=200.)
endfunction
function EW takes nothing returns boolean
return(SV)
endfunction
function XW takes nothing returns boolean
return(QV[Y]<=.0)
endfunction
function OW takes nothing returns boolean
return(NR[Y]!=true)and(GetUnitCurrentOrder(EV)==$D000F)
endfunction
function RW takes nothing returns nothing
set EV=GetEnumUnit()
set Y=GetUnitUserData(EV)
set YV=GetOwningPlayer(EV)
if(OW())then
set UV[Y]=(UV[Y]+TV[Y])
set QV[Y]=(QV[Y]-.03)
if GetPlayerTechCount(YV,'R00Y',true)==1 then
call SetWidgetLife(PV[Y],(GetUnitStateSwap(UNIT_STATE_LIFE,PV[Y])-(TV[Y]/ 2.)))
if GetRandomInt(1,33)==1 then
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Items\\AIil\\AIilTarget.mdl",GetUnitX(PV[Y]),GetUnitY(PV[Y])))
endif
else
call SetWidgetLife(PV[Y],(GetUnitStateSwap(UNIT_STATE_LIFE,PV[Y])-TV[Y]))
endif
if(XW())then
call GroupRemoveUnit(MV,EV)
set T=999999.
set RV=GetUnitLoc(EV)
set SV=false
if(YU())then
set bj_wantDestroyGroup=true
call ForGroupBJ(FM(bj_mapInitialPlayableArea,Condition(function PU)),function SU)
else
set bj_wantDestroyGroup=true
call ForGroupBJ(FM(bj_mapInitialPlayableArea,Condition(function TU)),function WU)
endif
call RemoveLocation(RV)
if(EW())then
set UV[Y]=GE[Y]
if(VW())then
set VV=R2I(UV[Y])
set Z=(1+GetPlayerId(YV))
call CreateTextTagUnitBJ((WV[LV[Y]]+(I2S(VV)+"|r")),EV,0,9.,'d','d','d',0)
set ZV=bj_lastCreatedTextTag
call ShowTextTagForceBJ(false,ZV,XE)
call ShowTextTagForceBJ(true,ZV,TM(Condition(function ZU)))
call SetTextTagVelocityBJ(ZV,64,90)
call SetTextTagSuspendedBJ(ZV,false)
call SetTextTagPermanentBJ(ZV,false)
call SetTextTagLifespanBJ(ZV,3.)
call SetTextTagFadepointBJ(ZV,2.)
call PlaySoundOnUnitBJ(HR[LV[Y]],'d',EV)
call TriggerExecute(FV[LV[Y]])
set UV[Y]=.0
set QV[Y]=(5./(1.+(I2R(GetPlayerTechCountSimple('R000',YV))*.25)))
set KE=(GetPlayerTechCountSimple(GV[Z],YV)+(1*GetPlayerTechCountSimple('R008',YV)))
set GE[Y]=I2R(KE)
set TV[Y]=((I2R(KE)/ QV[Y])*.03)
else
call IssueTargetOrderById(EV,$D000F,OV)
endif
else
call IssueImmediateOrderById(EV,$D0004)
call IS(YV,"无法送回矿物!")
endif
endif
else
call GroupRemoveUnit(MV,EV)
endif
endfunction
function IW takes nothing returns boolean
return(IsUnitGroupEmptyBJ(MV))
endfunction
function AW takes nothing returns nothing
call ForGroupBJ(MV,function RW)
if(IW())then
call DisableTrigger(GetTriggeringTrigger())
endif
endfunction
function BW takes nothing returns nothing
set AV[Z]=(AV[Z]+VV)
set UV[Y]=.0
set GE[Y]=.0
set LV[Y]=0
call QS()
endfunction
function DW takes nothing returns nothing
set BV[Z]=(BV[Z]+VV)
set UV[Y]=.0
set GE[Y]=.0
set LV[Y]=0
call QS()
endfunction
function GW takes nothing returns nothing
set NV[Z]=(NV[Z]+VV)
set UV[Y]=.0
set GE[Y]=.0
set LV[Y]=0
call QS()
endfunction
function JW takes nothing returns nothing
set CV[Z]=(CV[Z]+VV)
set UV[Y]=.0
set GE[Y]=.0
set LV[Y]=0
call QS()
endfunction
function Trig_Create_Board_Func001002001001 takes nothing returns boolean
return(GetPlayerController(GetFilterPlayer())==MAP_CONTROL_USER)
endfunction
function Trig_Create_Board_Func001002001002 takes nothing returns boolean
return(GetPlayerSlotState(GetFilterPlayer())==PLAYER_SLOT_STATE_PLAYING)
endfunction
function LW takes nothing returns boolean
return GetBooleanAnd((GetPlayerController(GetFilterPlayer())==MAP_CONTROL_USER),(GetPlayerSlotState(GetFilterPlayer())==PLAYER_SLOT_STATE_PLAYING))
endfunction
function MW takes nothing returns nothing
set YV=GetEnumPlayer()
set Y=(1+GetPlayerId(YV))
call SetPlayerAbilityAvailableBJ(false,'A01R',YV)
call SetPlayerHandicapXPBJ(YV,.0)
set AI[Y]=GetPlayerName(YV)
call SetPlayerAllianceStateBJ(YV,Player($C),2)
call SetPlayerAllianceStateBJ(Player($C),YV,2)
set OI[Y]=0
set NX[Y]=DialogCreate()
call TriggerRegisterDialogEvent(SH,NX[Y])
call TriggerRegisterPlayerChatEvent(KH,YV,"-view ",false)
call TriggerRegisterPlayerChatEvent(KH,YV,"-view reset",false)
endfunction
function PW takes nothing returns nothing
set XE=TM(Condition(function LW))
call CreateQuestBJ(0,"交易","TRIGSTR_1289","ReplaceableTextures\\CommandButtons\\BTNSelectHeroOff.blp")
call CreateQuestBJ(0,"视野","TRIGSTR_1446","ReplaceableTextures\\CommandButtons\\BTNSelectHeroOff.blp")
call CreateQuestBJ(0,"论坛","TRIGSTR_1286","ReplaceableTextures\\CommandButtons\\BTNSpy.blp")
call CreateQuestBJ(2,"原作者","TRIGSTR_2264","ReplaceableTextures\\CommandButtons\\BTNPeasant.blp")
call CreateQuestBJ(2,"VoF 创作","这游戏是由我给你带来，maddeem，与支缓的氏队 Victims of Fate 在美国东岸。 停止，如果你喜欢的游戏。","war3mapImported\\Vof.blp")
call CreateQuestBJ(2,"呜谢","TRIGSTR_1284","ReplaceableTextures\\CommandButtons\\BTNSpiritLink.blp")
call CreateQuestBJ(2,"超级玩家","没有 Sheep100 and Holy_xXx 疯狂测试此图，我不会制作此版本 (1.27)。他们都经过测试马不停蹄小时。 为此，我要感谢你们俩。 工作认真真棒。 我会加你们 10 点积分。","ReplaceableTextures\\CommandButtons\\BTNSorceressMaster.blp")
set NI="|cff0000ffMI|r|cff99b4d1NE|r|cffadff2fRA|r|cffff0000LZ|r"
call CreateMultiboardBJ(4,1,NI)
set II=bj_lastCreatedMultiboard
call MultiboardSetItemIconBJ(II,1,1,"ReplaceableTextures\\CommandButtons\\BTNManaStone.blp")
call MultiboardSetItemIconBJ(II,2,1,"ReplaceableTextures\\CommandButtons\\BTNEnchantedGemstone.blp")
call MultiboardSetItemIconBJ(II,3,1,"ReplaceableTextures\\CommandButtons\\BTNGem.blp")
call MultiboardSetItemIconBJ(II,4,1,"ReplaceableTextures\\CommandButtons\\BTNPhilosophersStone.blp")
call MultiboardSetItemWidthBJ(II,1,1,5.)
call MultiboardSetItemWidthBJ(II,2,1,5.)
call MultiboardSetItemWidthBJ(II,3,1,5.)
call MultiboardSetItemWidthBJ(II,4,1,5.)
call SetPlayerAbilityAvailableBJ(false,'A01R',Player($F))
call ForForce(XE,function MW)
endfunction
function SW takes nothing returns nothing
call TriggerExecute(IF)
set EV=CreateUnit(Player(0),'h01J',0,0,0)
call ShowUnitHide(EV)
set Y=9500
set Z=1
call EnableTrigger(VF)
call FogEnableOff()
call FogMaskEnableOff()
set MX[1]='cGc2'
set MX[2]='cGc1'
set MX[3]='Gdrt'
set MX[4]='Gbrk'
set MX[5]='Grds'
set MX[6]='Gdkr'
set MX[7]='Ggrs'
set MX[8]='Gsqd'
set JE=0
set VE="岩石...地形...光暗...矿石...教学...完成中"
call EnableTrigger(EF)
endfunction
function UW takes nothing returns nothing
call TriggerRegisterDeathEvent(RF,GetEnumDestructable())
endfunction
function WW takes nothing returns nothing
if JE==0 then
call RemoveLocation(GR)
set GR=GetRandomLocInRect(GB)
set JE=6
else
set JE=(JE-1)
endif
if IsTerrainPathable(GetLocationX(GR),GetLocationY(GR),PATHING_TYPE_BUILDABILITY)!=true then
set Z=(Z+1)
call SetUnitPositionLoc(EV,GR)
set RV=GetUnitLoc(EV)
set T=GetLocationX(RV)
set U=GetLocationY(RV)
call SetTerrainTypeBJ(RV,MX[GetRandomInt(1,8)],-1,4,0)
set HE=CreateDestructable(NO[GetRandomInt(1,$A)],T,U,270,1,0)
call TriggerRegisterDeathEvent(RF,HE)
set ME=GetRandomInt(1,25)
if ME<=9 then
call CreateDestructableZ(BO[ME],T,U,$80,GetRandomReal(0,360),1,0)
endif
call RemoveLocation(RV)
if Z>=Y then
call EnumDestructablesInRectAll(TB,function UW)
call ClearTextMessages()
set LR="|cffadff2f"+VE+"|r    载 入 完 成"
call DisplayTextToPlayer(GetLocalPlayer(),0,0,LR)
call DisableTrigger(EF)
call RemoveLocation(GR)
call RemoveUnit(EV)
call DisableTrigger(GetTriggeringTrigger())
call TriggerExecute(DF)
endif
else
call RemoveLocation(GR)
set GR=GetRandomLocInRect(GB)
endif
endfunction
function ZW takes nothing returns nothing
local integer r
set T=(I2R(Z)/ I2R(Y))*'d'
set VV=R2I(T)
set r=R2I(I2R(StringLength(VE))*T/ 'd')
set LR="|cffadff2f"+SubString(VE,0,r)+"|r"+SubString(VE,r,StringLength(VE))+"   载 入 中 . . .    "+I2S(VV)+"%"
call ClearTextMessages()
call DisplayTextToPlayer(GetLocalPlayer(),0,0,LR)
endfunction
function EY takes nothing returns boolean
return(GetUnitTypeId(GetFilterUnit())=='ushd')
endfunction
function XY takes nothing returns boolean
return(GetRandomInt(1,2)==1)
endfunction
function OY takes nothing returns nothing
set EV=GetEnumUnit()
set RV=GetUnitLoc(EV)
call RemoveUnit(EV)
if(XY())then
call PlaySoundBJ(QC)
else
call PlaySoundBJ(SC)
endif
call CreateDestructableLoc('Volc',RV,GetRandomReal(0,360),GetRandomReal(1.,1.5),0)
set DR=(DR+1)
set CR[DR]=bj_lastCreatedDestructable
set BR[DR]=GetDestructableLoc(CR[DR])
call SetDestructableAnimation(CR[DR],"birth")
call QueueDestructableAnimation(CR[DR],"stand")
call SetBlightRadiusLocBJ(true,Player($B),RV,256.)
call RemoveLocation(RV)
endfunction
function RY takes nothing returns nothing
set bj_wantDestroyGroup=true
call ForGroupBJ(FM(bj_mapInitialPlayableArea,Condition(function EY)),function OY)
endfunction
function AY takes nothing returns boolean
return(GetItemTypeId(GetManipulatedItem())=='I001')
endfunction
function NY takes nothing returns boolean
return(GetRandomInt(1,2)==1)
endfunction
function BY takes nothing returns nothing
set EV=GetTriggerUnit()
set RV=GetUnitLoc(EV)
if(NY())then
call PlaySoundBJ(QC)
else
call PlaySoundBJ(SC)
endif
call CreateDestructableLoc('Volc',RV,GetRandomReal(0,360),GetRandomReal(1.,1.5),0)
set DR=(DR+1)
set CR[DR]=bj_lastCreatedDestructable
set BR[DR]=GetDestructableLoc(CR[DR])
call SetDestructableAnimation(CR[DR],"birth")
call QueueDestructableAnimation(CR[DR],"stand")
call SetBlightRadiusLocBJ(true,Player($B),RV,256.)
call RemoveLocation(RV)
call RemoveItem(GetManipulatedItem())
endfunction
function DY takes nothing returns nothing
call RemoveDestructable(GetEnumDestructable())
endfunction
function FY takes nothing returns nothing
call DisableTrigger(GetTriggeringTrigger())
set RV=GetDestructableLoc(GetDyingDestructable())
call AddSpecialEffectLocBJ(RV,"Objects\\Spawnmodels\\Undead\\ImpaleTargetDust\\ImpaleTargetDust.mdl")
call DestroyEffect(bj_lastCreatedEffect)
call NM(32.,RV,function DY)
call RemoveLocation(RV)
call EnableTrigger(GetTriggeringTrigger())
endfunction
function HY takes nothing returns boolean
return(IsTerrainPathableBJ(IV,PATHING_TYPE_BUILDABILITY)!=true)
endfunction
function JY takes nothing returns boolean
return(IsTerrainPathableBJ(IV,PATHING_TYPE_BUILDABILITY)!=true)
endfunction
function KY takes nothing returns boolean
return(IsTerrainPathableBJ(IV,PATHING_TYPE_BUILDABILITY)!=true)
endfunction
function LY takes nothing returns boolean
return(IsTerrainPathableBJ(IV,PATHING_TYPE_BUILDABILITY)!=true)
endfunction
function MY takes nothing returns boolean
return(IsTerrainPathableBJ(RV,PATHING_TYPE_BUILDABILITY)!=true)
endfunction
function PY takes nothing returns nothing
set VV=1
loop
exitwhen VV>'d'
set RV=GetRandomLocInRect(GB)
if(MY())then
set IV=XM(RV,GetRandomReal(.0,1000.),GetRandomReal(0,360))
if(HY())then
call CreateNUnitsAtLoc(1,'h000',Player($C),IV,GetRandomReal(0,360))
set EV=bj_lastCreatedUnit
call SetUnitColor(EV,PLAYER_COLOR_BLUE)
call TriggerRegisterUnitEvent(IJ,EV,EVENT_UNIT_DEATH)
endif
call RemoveLocation(IV)
set IV=XM(RV,GetRandomReal(.0,1000.),GetRandomReal(0,360))
if(JY())then
call CreateNUnitsAtLoc(1,'h003',Player($C),IV,GetRandomReal(0,360))
set EV=bj_lastCreatedUnit
call SetUnitColor(EV,PLAYER_COLOR_CYAN)
call TriggerRegisterUnitEvent(IJ,EV,EVENT_UNIT_DEATH)
endif
call RemoveLocation(IV)
set IV=XM(RV,GetRandomReal(.0,1000.),GetRandomReal(0,360))
if(KY())then
call CreateNUnitsAtLoc(1,'h001',Player($C),IV,GetRandomReal(0,360))
set EV=bj_lastCreatedUnit
call SetUnitColor(EV,PLAYER_COLOR_GREEN)
call TriggerRegisterUnitEvent(IJ,EV,EVENT_UNIT_DEATH)
endif
call RemoveLocation(IV)
set IV=XM(RV,GetRandomReal(.0,1000.),GetRandomReal(0,360))
if(LY())then
call CreateNUnitsAtLoc(1,'h002',Player($C),IV,GetRandomReal(0,360))
set EV=bj_lastCreatedUnit
call SetUnitColor(EV,PLAYER_COLOR_RED)
call TriggerRegisterUnitEvent(IJ,EV,EVENT_UNIT_DEATH)
endif
call RemoveLocation(IV)
endif
call RemoveLocation(RV)
set VV=VV+1
endloop
endfunction
function SY takes nothing returns boolean
return(Y==$C)
endfunction
function TY takes nothing returns nothing
set YV=GetEnumPlayer()
set Y=(1+GetPlayerId(YV))
if(SY())then
call CustomDefeatBJ(YV,"已断线。")
call SetPlayerName(YV,"虫族")
else
call SetCameraBoundsToRectForPlayerBJ(YV,WB)
call SetPlayerTechMaxAllowedSwap('h006',1,YV)
call SetPlayerTechMaxAllowedSwap('h00W',1,YV)
call SetPlayerTechMaxAllowedSwap('h019',1,YV)
call SetPlayerTechMaxAllowedSwap('h005',4,YV)
call SetPlayerTechMaxAllowedSwap('h011',1,YV)
call SetPlayerTechMaxAllowedSwap('h01A',1,YV)
call SetPlayerAbilityAvailableBJ(false,'A00L',YV)
call SetPlayerAbilityAvailableBJ(false,'A00L',YV)
call SetPlayerTechResearchedSwap('R003',1,YV)
call SetPlayerTechResearchedSwap('R001',1,YV)
call SetPlayerTechResearchedSwap('R002',1,YV)
call SetPlayerTechResearchedSwap('R004',1,YV)
call TriggerRegisterPlayerChatEvent(QH,YV,"-",false)
call TriggerRegisterPlayerChatEvent(HH,YV,"-save",true)
call TriggerRegisterPlayerChatEvent(JH,YV,"-load",false)
call TriggerRegisterPlayerChatEvent(FH,YV,"-clear",false)
call TriggerRegisterPlayerSelectionEventBJ(XJ,YV,true)
call TriggerRegisterPlayerEventLeave(TF,YV)
call DialogClear(NX[Y])
call DialogSetMessage(NX[Y],"选择难度")
call DialogAddButtonBJ(NX[Y],"|cff00ff00容易|r")
call SaveInteger(XN,GetHandleId(bj_lastCreatedButton),0,1)
call DialogAddButtonBJ(NX[Y],"|cffffff00一般|r")
call SaveInteger(XN,GetHandleId(bj_lastCreatedButton),0,2)
call DialogAddButtonBJ(NX[Y],"|cffff8040困难|r")
call SaveInteger(XN,GetHandleId(bj_lastCreatedButton),0,3)
call DialogAddButtonBJ(NX[Y],"|cffff0000恶梦|r")
call SaveInteger(XN,GetHandleId(bj_lastCreatedButton),0,4)
call DialogAddButtonBJ(NX[Y],"|cff7f7f7f地狱|r")
call SaveInteger(XN,GetHandleId(bj_lastCreatedButton),0,5)
set OX[Y]=3
call DialogDisplayBJ(true,NX[Y],YV)
set KO=(KO+1)
endif
endfunction
function UY takes nothing returns nothing
local timer t=CreateTimer()
local integer i=GetHandleId(t)
local texttag JQ=CreateTextTag()
call SetTextTagColor(JQ,$FF,0,0,0)
call SetTextTagPos(JQ,GetCameraEyePositionX(),GetCameraEyePositionY()+500,0)
call SetTextTagText(JQ,"15",.1)
call SaveReal(QX,i,0,$F)
call TimerStart(t,.03125,true,function HQ)
call SaveTextTagHandle(QX,i,1,JQ)
call ConditionalTriggerExecute(SF)
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,15.,"你有15秒时间输入积分代码及找寻适合躲藏作基地的地方。")
call ConditionalTriggerExecute(XF)
call FogEnableOn()
call SetDayNightModels("Environment\\DNC\\DNCAshenvale\\DNCAshenvaleTerrain\\DNCAshenvaleTerrain.mdx","Environment\\DNC\\DNCAshenvale\\DNCAshenvaleUnit\\DNCAshenvaleUnit.mdx")
call ForForce(XE,function TY)
set JQ=null
endfunction
function YY takes nothing returns nothing
set YV=GetEnumPlayer()
set Y=(1+GetPlayerId(YV))
call DialogClear(NX[Y])
set RV=GetRectCenter(SB)
call CreateNUnitsAtLoc(1,'H01Q',YV,RV,GetRandomReal(0,360))
set EV=bj_lastCreatedUnit
set AX[Y]=EV
call TriggerRegisterUnitEvent(WF,EV,EVENT_UNIT_DEATH)
call SelectUnitForPlayerSingle(EV,YV)
call PanCameraToTimedLocForPlayer(YV,RV,0)
call RemoveLocation(RV)
endfunction
function ZY takes nothing returns nothing
set YV=GetEnumPlayer()
call SetPlayerAbilityAvailableBJ(false,'A00R',YV)
call SetPlayerAbilityAvailableBJ(false,'A00S',YV)
call SetPlayerAbilityAvailableBJ(false,'A00T',YV)
call SetPlayerAbilityAvailableBJ(false,'A00U',YV)
call SetPlayerStateBJ(YV,PLAYER_STATE_FOOD_CAP_CEILING,40)
endfunction
function VZ takes nothing returns nothing
set YV=GetEnumPlayer()
call SetPlayerAbilityAvailableBJ(false,'A00S',YV)
call SetPlayerAbilityAvailableBJ(false,'A01G',YV)
call SetPlayerAbilityAvailableBJ(false,'A00T',YV)
call SetPlayerAbilityAvailableBJ(false,'A00U',YV)
call SetPlayerStateBJ(YV,PLAYER_STATE_FOOD_CAP_CEILING,50)
endfunction
function EZ takes nothing returns nothing
set YV=GetEnumPlayer()
call SetPlayerAbilityAvailableBJ(false,'A00R',YV)
call SetPlayerAbilityAvailableBJ(false,'A00T',YV)
call SetPlayerAbilityAvailableBJ(false,'A00U',YV)
call SetPlayerStateBJ(YV,PLAYER_STATE_FOOD_CAP_CEILING,60)
call SetPlayerAbilityAvailableBJ(false,'A01G',YV)
endfunction
function XZ takes nothing returns nothing
set YV=GetEnumPlayer()
call SetPlayerAbilityAvailableBJ(false,'A00R',YV)
call SetPlayerAbilityAvailableBJ(false,'A00S',YV)
call SetPlayerAbilityAvailableBJ(false,'A00U',YV)
call SetPlayerStateBJ(YV,PLAYER_STATE_FOOD_CAP_CEILING,60)
call SetPlayerAbilityAvailableBJ(false,'A01G',YV)
endfunction
function OZ takes nothing returns nothing
set YV=GetEnumPlayer()
call SetPlayerAbilityAvailableBJ(false,'A00R',YV)
call SetPlayerAbilityAvailableBJ(false,'A00S',YV)
call SetPlayerAbilityAvailableBJ(false,'A00T',YV)
call SetPlayerAbilityAvailableBJ(false,'A00U',YV)
call SetPlayerStateBJ(YV,PLAYER_STATE_FOOD_CAP_CEILING,40)
endfunction
function RZ takes nothing returns nothing
set YV=GetEnumPlayer()
call SetPlayerAbilityAvailableBJ(false,'A00R',YV)
call SetPlayerAbilityAvailableBJ(false,'A00S',YV)
call SetPlayerAbilityAvailableBJ(false,'A00T',YV)
call SetPlayerStateBJ(YV,PLAYER_STATE_FOOD_CAP_CEILING,60)
call SetPlayerAbilityAvailableBJ(false,'A01G',YV)
endfunction
function IZ takes nothing returns boolean
return(TR==5)
endfunction
function AZ takes nothing returns boolean
return(TR==4)
endfunction
function NZ takes nothing returns boolean
return(TR==3)
endfunction
function BZ takes nothing returns boolean
return(TR==2)
endfunction
function CZ takes nothing returns boolean
return(TR==1)
endfunction
function DZ takes nothing returns nothing
call MultiboardDisplay(II,true)
call MultiboardMinimize(II,false)
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,100.,"如有任何问题、建议、投诉或想讨论战略可浏览 MineralZ 论坛: s3.excoboard.com/MineralZ")
call CreateFogModifierRectBJ(true,Player($B),FOG_OF_WAR_VISIBLE,bj_mapInitialPlayableArea)
call RemoveAllGuardPositions(Player($B))
set RV=GetRectCenter(SB)
call CreateNUnitsAtLoc(1,'n002',Player(0),RV,bj_UNIT_FACING)
call RemoveLocation(RV)
set EV=bj_lastCreatedUnit
call UnitAddAbility(EV,'A005')
call SetCreepCampFilterState(false)
set Y=1
loop
exitwhen Y>$B
set RV=GetRandomLocInRect(GB)
call CreateItemLoc('I001',RV)
call RemoveLocation(RV)
set Y=Y+1
endloop
set BN=$96
set VI=BN
call UnitApplyTimedLifeBJ(I2R(BN),'BTLF',EV)
call EnableTrigger(XG)
call ForForce(XE,function YY)
set TR=(TR/ UR)
if(CZ())then
call ForForce(bj_FORCE_ALL_PLAYERS,function ZY)
call SetPlayerTechResearchedSwap('R00T',1,Player($B))
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"难度: 容易")
set RI=40
set NI=NI+" [|cff00ff00容易|r] "
else
if(BZ())then
call ForForce(bj_FORCE_ALL_PLAYERS,function VZ)
call SetPlayerTechResearchedSwap('R00H',1,Player($B))
set NI=NI+" [|cffffff00一般|r] "
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"难度: 一般")
set RI=50
else
if(NZ())then
call ForForce(bj_FORCE_ALL_PLAYERS,function EZ)
call SetPlayerTechResearchedSwap('R00E',1,Player($B))
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"难度: 困难")
set NI=NI+" [|cffff8040困难|r] "
set RI=60
else
if(AZ())then
call ForForce(bj_FORCE_ALL_PLAYERS,function XZ)
call SetPlayerTechResearchedSwap('R00F',1,Player($B))
set NI=NI+" [|cffff0000恶梦|r] "
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"难度: |cffc8c8c8恶梦|r")
set RI=60
else
if(IZ())then
call ForForce(bj_FORCE_ALL_PLAYERS,function RZ)
call SetPlayerTechResearchedSwap('R00G',1,Player($B))
set NI=NI+" [|cff7f7f7f地狱|r] "
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"难度: |cff7f7f7f地狱|r")
set RI=60
call ShowDestructableBJ(true,VK)
call ShowDestructableBJ(true,EK)
call ShowDestructableBJ(true,YJ)
call ShowDestructableBJ(true,ZJ)
else
call ForForce(bj_FORCE_ALL_PLAYERS,function OZ)
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"难度: 容易")
call SetPlayerTechResearchedSwap('R00T',1,Player($B))
set NI=NI+" [|cff00ff00容易|r] "
set RI=40
endif
endif
endif
endif
endif
endfunction
function GZ takes nothing returns nothing
if GetDestructableTypeId(GetEnumDestructable())!='YTpc' then
call RemoveDestructable(GetEnumDestructable())
endif
endfunction
function HZ takes nothing returns nothing
set GR=GetRandomLocInRect(HB)
set FR=RectFromCenterSizeBJ(GR,300.,300.)
call EnumDestructablesInRectAll(FR,function GZ)
call CreateDestructableLoc('B00D',GR,GetRandomReal(0,360),1.2,0)
call CreateItemLoc('I000',GR)
call RemoveRect(FR)
call RemoveLocation(GR)
endfunction
function KZ takes nothing returns nothing
if GetDestructableTypeId(GetEnumDestructable())!='YTpc' then
call RemoveDestructable(GetEnumDestructable())
endif
endfunction
function LZ takes nothing returns nothing
call SetUnitPositionLoc(GetEnumUnit(),RV)
endfunction
function MZ takes real x,real y returns nothing
call SetDestructableInvulnerable(CreateDestructableZ('B00W',x,y,0,270,1.65,0),true)
call SetDestructableInvulnerable(CreateDestructableZ('B010',x,y,$80,270,1.65,0),true)
call CreateDestructable('YTac',x,y,0,0,0)
endfunction
function PZ takes nothing returns nothing
local real x=GetRandomReal(GetRectMinX(UB),GetRectMaxX(UB))
local real y=GetRandomReal(GetRectMinY(UB),GetRectMaxY(UB))
local group g=CreateGroup()
set RV=Location(x,y+256)
set FR=Rect(x-768,y-768,x+768,y+768)
call EnumDestructablesInRectAll(FR,function KZ)
set RV=Location(x,y+384)
set g=LM($3E8,RV,null)
call ForGroup(g,function LZ)
call RemoveLocation(RV)
set HE=CreateDestructable('B00F',x,y+512,270,1.5,0)
call SetDestructableInvulnerable(HE,true)
set RV=Location(GetDestructableX(HE),GetDestructableY(HE))
call GroupAddUnit(EI,CreateUnitAtLoc(Player($F),'h004',RV,270))
call RemoveLocation(RV)
call MZ(x,y+640)
call MZ(x+$80,y+640)
call MZ(x+256,y+640)
call MZ(x-$80,y+640)
call MZ(x-256,y+640)
call MZ(x+384,y+640)
call MZ(x-384,y+640)
call MZ(x+384,y+512)
call MZ(x-384,y+512)
call MZ(x+384,y+384)
call MZ(x-384,y+384)
call MZ(x+384,y+256)
call MZ(x-384,y+256)
call MZ(x+384,y+$80)
call MZ(x-384,y+$80)
call MZ(x-512,y+$80)
call MZ(x+512,y+$80)
call MZ(x+640,y+$80)
call MZ(x-640,y+$80)
call MZ(x+640,y)
call MZ(x-640,y)
call MZ(x+640,y-$80)
call MZ(x-640,y-$80)
call MZ(x+512,y-$80)
call MZ(x-512,y-$80)
call MZ(x+384,y-$80)
call MZ(x-384,y-$80)
call MZ(x+256,y-$80)
call MZ(x-256,y-$80)
call MZ(x+$80,y-$80)
call MZ(x-$80,y-$80)
call MZ(x+$80,y-256)
call MZ(x-$80,y-256)
call MZ(x+$80,y-384)
call MZ(x-$80,y-384)
call MZ(x-$80,y-512)
call MZ(x+$80,y-512)
call MZ(x+256,y-512)
call MZ(x-256,y-512)
call MZ(x+256,y-640)
call MZ(x-256,y-640)
call MZ(x-$80,y-640)
call MZ(x+$80,y-640)
call RemoveRect(FR)
call DestroyGroup(g)
endfunction
function SZ takes nothing returns nothing
call UnitRemoveAbility(GetEnumUnit(),'A00G')
endfunction
function TZ takes nothing returns boolean
return(RectContainsLoc(TB,RV)!=true)and(IsTerrainPathableBJ(RV,PATHING_TYPE_BUILDABILITY))
endfunction
function UZ takes nothing returns nothing
call CameraSetupApplyForPlayer(true,VC,GetEnumPlayer(),0)
endfunction
function WZ takes nothing returns nothing
call CameraSetEQNoiseForPlayer(GetEnumPlayer(),3)
endfunction
function YZ takes nothing returns nothing
call CameraSetupApplyForPlayer(true,EC,GetEnumPlayer(),2.)
endfunction
function ZZ takes nothing returns nothing
call IssuePointOrderByIdLoc(GetEnumUnit(),$D0012,IV)
endfunction
function V0 takes nothing returns nothing
call CameraSetupApplyForPlayer(true,OC,GetEnumPlayer(),2.)
endfunction
function E0 takes nothing returns nothing
set bj_wantDestroyGroup=true
call ForGroupBJ(HM(QB),function SZ)
call TriggerSleepAction(1.)
call ClearTextMessages()
set Y=1
loop
exitwhen Y>$A
set RV=GetRandomLocInRect(GB)
if(TZ())then
call CreateNUnitsAtLoc(1,'ushd',Player($B),RV,bj_UNIT_FACING)
else
set Y=(Y-1)
endif
call RemoveLocation(IV)
call RemoveLocation(RV)
set Y=Y+1
endloop
call CinematicFadeBJ(0,5.,"ReplaceableTextures\\CameraMasks\\Black_mask.blp",100.,100.,100.,0)
call ForForce(XE,function UZ)
call IssueTargetOrderById(PJ,$D000F,LJ)
call IssueTargetOrderById(UJ,$D000F,SJ)
call IssueTargetOrderById(MJ,$D000F,TJ)
call UnitAddIndicatorBJ(QJ,'d','d','d',0)
call ForceCinematicSubtitles(true)
call TransmissionFromUnitWithNameBJ(bj_FORCE_ALL_PLAYERS,QJ,"矿工队长",KC,"我要这工作在天光前完成! 所有人，继续工作，否则我就扣你们薪水!",0,.0,false)
call TriggerSleepAction(2.)
call TriggerExecute(CF)
call TransmissionFromUnitWithNameBJ(bj_FORCE_ALL_PLAYERS,UJ,"矿工",JC,"继续工作?",0,.0,false)
call TriggerSleepAction(1.5)
call PlaySoundBJ(PC)
call ForForce(XE,function WZ)
call TriggerSleepAction(1.5)
call TransmissionFromUnitWithNameBJ(bj_FORCE_ALL_PLAYERS,QJ,"矿工队长",LC,"发生什么事?!",0,.0,false)
call TriggerSleepAction(2.)
call ForForce(XE,function YZ)
set IV=GetRectCenter(MB)
set bj_wantDestroyGroup=true
call ForGroupBJ(HM(QB),function ZZ)
set Y=1
loop
exitwhen Y>5
set RV=GetRandomLocInRect(JB)
call CreateNUnitsAtLocFacingLocBJ(1,'n001',Player($B),RV,IV)
call RemoveLocation(RV)
set RV=GetRandomLocInRect(KB)
call CreateNUnitsAtLocFacingLocBJ(1,'n001',Player($B),RV,IV)
call RemoveLocation(RV)
set RV=GetRandomLocInRect(LB)
call CreateNUnitsAtLocFacingLocBJ(1,'n001',Player($B),RV,IV)
call RemoveLocation(RV)
set Y=Y+1
endloop
call SetDoodadAnimationRectBJ("death alternate",'D002',bj_mapInitialPlayableArea)
call RemoveLocation(IV)
call TransmissionFromUnitWithNameBJ(bj_FORCE_ALL_PLAYERS,QJ,"矿工队长",MC,"到寺庙! 快逃!",0,.0,false)
call TriggerSleepAction(2.)
call ForForce(XE,function V0)
endfunction
function O0 takes nothing returns nothing
set EV=GetTriggerUnit()
set GR=GetRectCenter(PB)
call IssuePointOrderByIdLoc(EV,$D0012,GR)
call RemoveLocation(GR)
endfunction
function I0 takes nothing returns nothing
call CU(GetEnumUnit())
call RemoveUnit(GetEnumUnit())
endfunction
function A0 takes nothing returns nothing
call RemoveDestructable(GetEnumDestructable())
endfunction
function N0 takes nothing returns nothing
call CameraSetupApplyForPlayer(true,XC,GetEnumPlayer(),0)
call CameraClearNoiseForPlayer(GetEnumPlayer())
endfunction
function B0 takes nothing returns nothing
call SetUserControlForceOn(bj_FORCE_ALL_PLAYERS)
call DisableTrigger(GetTriggeringTrigger())
set bj_wantDestroyGroup=true
call ForGroupBJ(HM(QB),function I0)
call EnumDestructablesInRectAll(QB,function A0)
call ForForce(XE,function N0)
call StopSoundBJ(PC,true)
call QS()
call ConditionalTriggerExecute(BF)
call TriggerExecute(AF)
endfunction
function D0 takes nothing returns nothing
set DV='h008'
set SX='h007'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h009'
set SX='h008'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h00E'
set SX='h009'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h00F'
set SX='h00E'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h00L'
set SX='h00F'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h00M'
set SX='h00L'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='o002'
set SX='o000'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='o005'
set SX='o002'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='o006'
set SX='o005'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='o007'
set SX='o006'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='o003'
set SX='o001'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='o004'
set SX='o003'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='o008'
set SX='o004'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='o009'
set SX='o008'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h006'
set SX='h005'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h00W'
set SX='h006'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h024'
set SX='h006'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h00D'
set SX='h00C'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h00H'
set SX='h00D'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h00K'
set SX='h00H'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h00B'
set SX='h00A'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h00G'
set SX='h00B'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h00I'
set SX='h00G'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h00R'
set SX='h00Q'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h00S'
set SX='h00P'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h00T'
set SX='h00N'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h00U'
set SX='h00O'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h015'
set SX='h014'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h016'
set SX='h015'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h018'
set SX='h012'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='o00B'
set SX='o00A'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h01B'
set SX='h00I'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h010'
set SX='h00K'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h01D'
set SX='h00R'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h01E'
set SX='h00S'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h01F'
set SX='h00T'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h01G'
set SX='h00U'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h01H'
set SX='h00M'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='o00C'
set SX='o00B'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='o00E'
set SX='o009'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='o00D'
set SX='o007'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h01O'
set SX='h014'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='o00H'
set SX='o00C'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='o00I'
set SX='o00H'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='o00G'
set SX='o00F'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='o00J'
set SX='o00E'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='o00K'
set SX='o00D'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='o00L'
set SX='o00G'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h00Y'
set SX='h01H'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h01L'
set SX='h00Y'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h01C'
set SX='h010'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h020'
set SX='h01C'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='o00N'
set SX='o00M'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='o00O'
set SX='o00N'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='o00P'
set SX='o00O'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h013'
set SX='h01B'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h019'
set SX='h00W'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='o00R'
set SX='o00K'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='o00S'
set SX='o00Q'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='o00T'
set SX='o00S'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
set DV='h022'
set SX='h013'
call SaveInteger(XO,DV,0,SX)
call SaveInteger(XO,SX,1,DV)
endfunction
function G0 takes nothing returns nothing
set EN=InitHashtable()
call SaveInteger(EN,'h00Y',0,'B012')
call SaveReal(EN,'h00Y',4,1)
call SaveInteger(EN,'h01C',0,'B013')
call SaveReal(EN,'h01C',3,256)
call SaveReal(EN,'h01C',4,.8)
call SaveInteger(EN,'o00M',0,'B014')
call SaveReal(EN,'o00M',3,320)
call SaveReal(EN,'o00M',4,1)
call SaveInteger(EN,'o00N',0,'B015')
call SaveReal(EN,'o00N',3,320)
call SaveReal(EN,'o00N',4,1)
call SaveInteger(EN,'o00O',0,'B016')
call SaveReal(EN,'o00O',3,320)
call SaveReal(EN,'o00O',4,1)
call SaveInteger(EN,'o00P',0,'B017')
call SaveReal(EN,'o00P',3,320)
call SaveReal(EN,'o00P',4,1)
call SaveInteger(EN,'h01L',0,'B01A')
call SaveReal(EN,'h01L',4,3)
call SaveInteger(EN,'o00R',0,'B01C')
call SaveReal(EN,'o00R',3,80)
call SaveReal(EN,'o00R',4,.5)
call SaveInteger(EN,'o00T',0,'B01D')
call SaveReal(EN,'o00T',4,1.35)
endfunction
function J0 takes nothing returns nothing
set DV='h014'
call SaveInteger(XN,DV,0,2)
call SaveInteger(XN,DV,1,2)
call SaveInteger(XN,DV,2,2)
call SaveInteger(XN,DV,3,2)
call SaveBoolean(DO,DV,0,true)
call SaveInteger(DO,DV,1,'B009')
call SaveReal(YE,DV,1,640)
set DV='h016'
call SaveInteger(XN,DV,0,8)
call SaveInteger(XN,DV,1,8)
call SaveInteger(XN,DV,2,8)
call SaveInteger(XN,DV,3,8)
call SaveBoolean(DO,DV,0,true)
call SaveInteger(DO,DV,1,'B00K')
call SaveReal(YE,DV,1,$528)
set DV='h015'
call SaveInteger(XN,DV,0,6)
call SaveInteger(XN,DV,1,6)
call SaveInteger(XN,DV,2,6)
call SaveInteger(XN,DV,3,6)
call SaveBoolean(DO,DV,0,true)
call SaveInteger(DO,DV,1,'B00L')
call SaveReal(YE,DV,1,960)
set DV='h00V'
call SaveInteger(XN,DV,0,30)
call SaveInteger(XN,DV,1,30)
call SaveInteger(XN,DV,2,30)
call SaveInteger(XN,DV,3,30)
set DV='h012'
call SaveInteger(XN,DV,0,20)
call SaveInteger(XN,DV,1,20)
call SaveInteger(XN,DV,2,20)
call SaveInteger(XN,DV,3,20)
call SaveInteger(OO,DV,0,1)
call SaveReal(YE,DV,1,500)
set DV='h018'
call SaveInteger(XN,DV,0,25)
call SaveInteger(XN,DV,1,25)
call SaveInteger(XN,DV,2,25)
call SaveInteger(XN,DV,3,25)
call SaveInteger(OO,DV,0,2)
call SaveReal(YE,DV,1,700)
set DV='h00W'
call SaveInteger(XN,DV,0,$F)
call SaveInteger(XN,DV,1,$F)
call SaveInteger(XN,DV,2,$F)
call SaveInteger(XN,DV,3,$F)
set DV='h024'
call SaveInteger(XN,DV,0,$F)
call SaveInteger(XN,DV,1,$F)
call SaveInteger(XN,DV,2,$F)
call SaveInteger(XN,DV,3,$F)
set DV='h00Q'
set SX='h000'
call SaveInteger(XN,DV,1,$A)
call SaveInteger(XN,DV,2,$A)
call SaveInteger(XN,DV,3,$A)
call SaveInteger(QX,DV,0,SX)
call SaveInteger(QX,DV,1,1)
set DV='h00P'
set SX='h003'
call SaveInteger(XN,DV,0,$A)
call SaveInteger(XN,DV,2,$A)
call SaveInteger(XN,DV,3,$A)
call SaveInteger(QX,DV,0,SX)
call SaveInteger(QX,DV,1,2)
set DV='h00N'
set SX='h001'
call SaveInteger(XN,DV,0,$A)
call SaveInteger(XN,DV,1,$A)
call SaveInteger(XN,DV,3,$A)
call SaveInteger(QX,DV,0,SX)
call SaveInteger(QX,DV,1,3)
set DV='h00O'
set SX='h002'
call SaveInteger(XN,DV,0,$A)
call SaveInteger(XN,DV,1,$A)
call SaveInteger(XN,DV,2,$A)
call SaveInteger(QX,DV,0,SX)
call SaveInteger(QX,DV,1,4)
set DV='h00R'
set SX='h000'
call SaveInteger(XN,DV,1,$F)
call SaveInteger(XN,DV,2,$F)
call SaveInteger(XN,DV,3,$F)
call SaveInteger(QX,DV,0,SX)
call SaveInteger(QX,DV,1,1)
set DV='h00S'
set SX='h003'
call SaveInteger(XN,DV,0,$F)
call SaveInteger(XN,DV,2,$F)
call SaveInteger(XN,DV,3,$F)
call SaveInteger(QX,DV,0,SX)
call SaveInteger(QX,DV,1,2)
set DV='h00T'
set SX='h001'
call SaveInteger(XN,DV,0,$F)
call SaveInteger(XN,DV,1,$F)
call SaveInteger(XN,DV,3,$F)
call SaveInteger(QX,DV,0,SX)
call SaveInteger(QX,DV,1,3)
set DV='h00U'
set SX='h002'
call SaveInteger(XN,DV,0,$F)
call SaveInteger(XN,DV,1,$F)
call SaveInteger(XN,DV,2,$F)
call SaveInteger(QX,DV,0,SX)
call SaveInteger(QX,DV,1,4)
set DV='h00A'
call SaveInteger(YE,DV,0,1)
call SaveReal(YE,DV,1,400)
call SaveInteger(XN,DV,1,4)
set DV='h00B'
call SaveInteger(YE,DV,0,2)
call SaveReal(YE,DV,1,450)
call SaveInteger(XN,DV,1,6)
set DV='h00G'
call SaveInteger(YE,DV,0,3)
call SaveReal(YE,DV,1,500)
call SaveInteger(XN,DV,1,$A)
set DV='h00I'
call SaveInteger(YE,DV,0,4)
call SaveReal(YE,DV,1,550)
call SaveInteger(XN,DV,1,$F)
set DV='h00C'
call SaveInteger(YE,DV,0,1)
call SaveReal(YE,DV,1,300)
call SaveInteger(XN,DV,0,2)
call SaveInteger(XN,DV,2,2)
set DV='h00D'
call SaveInteger(YE,DV,0,2)
call SaveReal(YE,DV,1,400)
call SaveInteger(XN,DV,0,3)
call SaveInteger(XN,DV,2,3)
set DV='h00H'
call SaveInteger(YE,DV,0,3)
call SaveReal(YE,DV,1,450)
call SaveInteger(XN,DV,0,6)
call SaveInteger(XN,DV,2,6)
set DV='h00K'
call SaveInteger(YE,DV,0,4)
call SaveReal(YE,DV,1,500)
call SaveInteger(XN,DV,0,$A)
call SaveInteger(XN,DV,2,$A)
set DV='h006'
call SaveInteger(XN,DV,0,5)
call SaveInteger(XN,DV,2,2)
call SaveInteger(XN,DV,3,2)
set DV='h019'
call SaveInteger(XN,DV,0,60)
call SaveInteger(XN,DV,1,60)
call SaveInteger(XN,DV,2,60)
call SaveInteger(XN,DV,3,60)
set DV='h025'
call SaveInteger(XN,DV,0,60)
call SaveInteger(XN,DV,1,60)
call SaveInteger(XN,DV,2,60)
call SaveInteger(XN,DV,3,60)
set DV='o000'
call SaveInteger(XN,DV,3,4)
call SaveReal(YE,DV,1,500)
set DV='o002'
call SaveInteger(XN,DV,3,6)
call SaveReal(YE,DV,1,550)
set DV='o005'
call SaveInteger(XN,DV,3,$A)
call SaveReal(YE,DV,1,600)
set DV='o006'
call SaveInteger(XN,DV,3,$F)
call SaveReal(YE,DV,1,625)
set DV='o007'
call SaveInteger(XN,DV,3,20)
call SaveReal(YE,DV,1,650)
set DV='o00D'
call SaveInteger(XN,DV,3,25)
call SaveReal(YE,DV,1,700)
set DV='o001'
call SaveInteger(XN,DV,3,2)
call SaveInteger(XN,DV,1,2)
call SaveReal(YE,DV,1,300)
set DV='o003'
call SaveInteger(XN,DV,3,3)
call SaveInteger(XN,DV,1,3)
call SaveReal(YE,DV,1,350)
set DV='o004'
call SaveInteger(XN,DV,3,6)
call SaveInteger(XN,DV,1,6)
call SaveReal(YE,DV,1,400)
set DV='o008'
call SaveInteger(XN,DV,3,$A)
call SaveInteger(XN,DV,1,$A)
call SaveReal(YE,DV,1,400)
set DV='o009'
call SaveInteger(XN,DV,3,$F)
call SaveInteger(XN,DV,1,$F)
call SaveReal(YE,DV,1,450)
set DV='o00E'
call SaveInteger(XN,DV,3,25)
call SaveInteger(XN,DV,1,25)
call SaveReal(YE,DV,1,500)
set DV='h007'
call SaveInteger(YE,DV,5,1)
call SaveInteger(XN,DV,0,2)
set DV='h017'
call SaveInteger(YE,DV,5,1)
set DV='h008'
call SaveInteger(XN,DV,0,5)
call SaveInteger(YE,DV,5,1)
set DV='h009'
call SaveInteger(XN,DV,0,$A)
call SaveInteger(YE,DV,5,1)
set DV='h00E'
call SaveInteger(XN,DV,0,20)
call SaveInteger(YE,DV,5,1)
set DV='h00F'
call SaveInteger(XN,DV,0,40)
call SaveInteger(YE,DV,5,1)
set DV='h00L'
call SaveInteger(XN,DV,0,75)
call SaveInteger(YE,DV,5,1)
set DV='h00M'
call SaveInteger(XN,DV,0,'}')
call SaveInteger(YE,DV,5,1)
set LE='R000'
call SaveInteger(XN,LE,2,2)
call SaveInteger(XN,LE,5,1)
set LE='R001'
call SaveInteger(XN,LE,3,2)
call SaveInteger(XN,LE,5,1)
set LE='R003'
call SaveInteger(XN,LE,0,2)
call SaveInteger(XN,LE,5,1)
set LE='R004'
call SaveInteger(XN,LE,1,2)
call SaveInteger(XN,LE,5,1)
set LE='R002'
call SaveInteger(XN,LE,2,2)
call SaveInteger(XN,LE,5,1)
set LE='R00D'
call SaveInteger(XN,LE,1,50)
call SaveInteger(XN,LE,3,50)
endfunction
function L0 takes nothing returns nothing
set LE='R00I'
call SaveInteger(XN,LE,1,25)
call SaveInteger(XN,LE,2,$A)
call SaveInteger(XN,LE,3,35)
set LE='R00U'
call SaveInteger(XN,LE,0,500)
set LE='R00X'
call SaveInteger(XN,LE,0,$FA)
call SaveInteger(XN,LE,3,$FA)
set LE='R010'
call SaveInteger(XN,LE,0,'d')
call SaveInteger(XN,LE,2,'d')
call SaveInteger(XN,LE,3,'d')
set LE='R00Y'
call SaveInteger(XN,LE,0,'d')
call SaveInteger(XN,LE,1,'d')
call SaveInteger(XN,LE,2,'d')
call SaveInteger(XN,LE,3,'d')
set LE='R00Z'
call SaveInteger(XN,LE,0,300)
call SaveInteger(XN,LE,3,300)
set LE='R00K'
call SaveInteger(XN,LE,0,$A)
call SaveInteger(XN,LE,1,$A)
call SaveInteger(XN,LE,2,$A)
call SaveInteger(XN,LE,3,$A)
set LE='R00J'
call SaveInteger(XN,LE,0,75)
call SaveInteger(XN,LE,1,50)
call SaveInteger(XN,LE,2,20)
set DV='o00A'
call SaveInteger(XN,DV,0,$F)
call SaveInteger(XN,DV,3,$F)
call SaveReal(YE,DV,1,600)
set DV='o00B'
call SaveInteger(XN,DV,0,20)
call SaveInteger(XN,DV,1,5)
call SaveInteger(XN,DV,3,20)
call SaveReal(YE,DV,1,600)
set DV='o00C'
call SaveInteger(XN,DV,0,25)
call SaveInteger(XN,DV,1,$A)
call SaveInteger(XN,DV,3,25)
call SaveReal(YE,DV,1,600)
set DV='h01B'
call SaveInteger(YE,DV,0,5)
call SaveReal(YE,DV,1,600)
call SaveInteger(XN,DV,1,20)
set DV='h010'
call SaveInteger(YE,DV,0,5)
call SaveReal(YE,DV,1,525)
call SaveInteger(XN,DV,0,$F)
call SaveInteger(XN,DV,2,$F)
set DV='h01C'
call SaveInteger(YE,DV,0,8)
call SaveReal(YE,DV,1,600)
call SaveInteger(XN,DV,0,30)
call SaveInteger(XN,DV,2,30)
set DV='h020'
call SaveInteger(YE,DV,0,$F)
call SaveReal(YE,DV,1,700)
call SaveInteger(XN,DV,0,60)
call SaveInteger(XN,DV,2,60)
set DV='h01D'
set SX='h000'
call SaveInteger(XN,DV,1,20)
call SaveInteger(XN,DV,2,20)
call SaveInteger(XN,DV,3,20)
call SaveInteger(QX,DV,0,SX)
call SaveInteger(QX,DV,1,1)
set DV='h01F'
set SX='h001'
call SaveInteger(XN,DV,0,20)
call SaveInteger(XN,DV,1,20)
call SaveInteger(XN,DV,3,20)
call SaveInteger(QX,DV,0,SX)
call SaveInteger(QX,DV,1,3)
set DV='h01G'
set SX='h002'
call SaveInteger(XN,DV,0,20)
call SaveInteger(XN,DV,1,20)
call SaveInteger(XN,DV,2,20)
call SaveInteger(QX,DV,0,SX)
call SaveInteger(QX,DV,1,4)
set DV='h01E'
set SX='h003'
call SaveInteger(XN,DV,0,20)
call SaveInteger(XN,DV,2,20)
call SaveInteger(XN,DV,3,20)
call SaveInteger(QX,DV,0,SX)
call SaveInteger(QX,DV,1,2)
set DV='h01H'
call SaveInteger(XN,DV,0,$C8)
call SaveInteger(YE,DV,5,1)
set DV='h00J'
call SaveInteger(XN,DV,4,1)
set DV='h00Z'
call SaveInteger(XN,DV,4,1)
set DV='h023'
call SaveInteger(XN,DV,4,1)
set DV='h01O'
call SaveInteger(XN,DV,0,25)
call SaveInteger(XN,DV,1,20)
call SaveInteger(XN,DV,3,30)
call SaveInteger(QX,DV,2,1)
call SaveReal(YE,DV,1,$BB8)
set DV='o00F'
call SaveInteger(XN,DV,2,$F)
call SaveInteger(XN,DV,3,$A)
call SaveInteger(QX,DV,3,1)
call SaveReal(YE,DV,1,500)
set DV='o00G'
call SaveInteger(XN,DV,2,25)
call SaveInteger(XN,DV,3,$F)
call SaveInteger(QX,DV,3,1)
call SaveReal(YE,DV,1,550)
set DV='o00H'
call SaveInteger(XN,DV,0,50)
call SaveInteger(XN,DV,1,$F)
call SaveInteger(XN,DV,3,50)
call SaveReal(YE,DV,1,600)
set DV='o00I'
call SaveInteger(XN,DV,0,'d')
call SaveInteger(XN,DV,1,20)
call SaveInteger(XN,DV,3,'d')
call SaveReal(YE,DV,1,600)
set DV='o00J'
call SaveInteger(XN,DV,1,40)
call SaveInteger(XN,DV,3,40)
call SaveReal(YE,DV,1,550)
set DV='o00K'
call SaveInteger(XN,DV,3,80)
call SaveReal(YE,DV,1,800)
set DV='o00L'
call SaveInteger(XN,DV,2,35)
call SaveInteger(XN,DV,3,25)
call SaveInteger(QX,DV,3,1)
call SaveReal(YE,DV,1,600)
set DV='h00X'
call SaveInteger(XN,DV,0,$A)
call SaveInteger(QX,DV,5,1)
set DV='h00Y'
call SaveInteger(YE,DV,5,1)
call SaveInteger(XN,DV,0,300)
set DV='h01L'
call SaveInteger(YE,DV,5,1)
call SaveInteger(XN,DV,0,600)
endfunction
function P0 takes nothing returns nothing
set DV='o00M'
call SaveInteger(XN,DV,1,20)
call SaveInteger(XN,DV,2,20)
call SaveInteger(XN,DV,3,20)
call SaveStr(EN,DV,$A,"AFOD")
call SaveReal(EN,$A,DV,1)
call SaveReal(EN,DV,$B,1.)
call SaveReal(YE,DV,1,600)
set DV='o00N'
call SaveInteger(XN,DV,1,30)
call SaveInteger(XN,DV,2,30)
call SaveInteger(XN,DV,3,30)
call SaveStr(EN,DV,$A,"AFOD")
call SaveReal(EN,$A,DV,1)
call SaveReal(EN,DV,$B,1.5)
call SaveReal(YE,DV,1,600)
set DV='o00O'
call SaveInteger(XN,DV,1,40)
call SaveInteger(XN,DV,2,40)
call SaveInteger(XN,DV,3,40)
call SaveStr(EN,DV,$A,"AFOD")
call SaveReal(EN,$A,DV,1)
call SaveReal(EN,DV,$B,2.)
call SaveReal(YE,DV,1,700)
set DV='o00P'
call SaveInteger(XN,DV,1,50)
call SaveInteger(XN,DV,2,50)
call SaveInteger(XN,DV,3,50)
call SaveStr(EN,DV,$A,"AFOD")
call SaveReal(EN,$A,DV,1)
call SaveReal(EN,DV,$B,2.5)
call SaveReal(YE,DV,1,800)
set DV='h013'
call SaveInteger(YE,DV,0,7)
call SaveReal(YE,DV,1,650)
call SaveInteger(XN,DV,1,45)
set DV='o00R'
call SaveInteger(XN,DV,3,$96)
call SaveReal(YE,DV,1,900)
set DV='o00Q'
call SaveInteger(XN,DV,2,25)
call SaveInteger(XN,DV,3,25)
call SaveReal(YE,DV,1,$3E8)
set DV='o00S'
call SaveInteger(XN,DV,2,35)
call SaveInteger(XN,DV,3,35)
call SaveReal(YE,DV,1,$3E8)
set DV='o00T'
call SaveInteger(XN,DV,2,60)
call SaveInteger(XN,DV,3,60)
call SaveReal(YE,DV,1,$3E8)
set DV='h022'
call SaveInteger(YE,DV,0,$A)
call SaveReal(YE,DV,1,700)
call SaveInteger(XN,DV,1,'d')
endfunction
function S0 takes nothing returns boolean
return(GetPlayerTechCountSimple('R010',GetOwningPlayer(XV))>0)
endfunction
function Trig_Attacks_Func046001003001 takes nothing returns boolean
return(IsUnitInGroup(GetFilterUnit(),PI)!=true)
endfunction
function Trig_Attacks_Func046001003002001 takes nothing returns boolean
return(IsUnitInGroup(GetFilterUnit(),KR))
endfunction
function Trig_Attacks_Func046001003002002 takes nothing returns boolean
return(GetUnitManaPercent(GetFilterUnit())>=100.)
endfunction
function Trig_Attacks_Func046001003002 takes nothing returns boolean
return GetBooleanAnd((IsUnitInGroup(GetFilterUnit(),KR)),(GetUnitManaPercent(GetFilterUnit())>=100.))
endfunction
function T0 takes nothing returns boolean
return GetBooleanAnd((IsUnitInGroup(GetFilterUnit(),PI)!=true),(GetBooleanAnd((IsUnitInGroup(GetFilterUnit(),KR)),(GetUnitManaPercent(GetFilterUnit())>=100.))))
endfunction
function U0 takes nothing returns nothing
set IV=GetUnitLoc(GetEnumUnit())
set U=DistanceBetweenPoints(RV,IV)
if T>U then
set XV=GetEnumUnit()
set T=U
endif
call RemoveLocation(IV)
endfunction
function W0 takes nothing returns nothing
set EV=GetTriggerUnit()
set XV=GetAttacker()
set Z=GetUnitUserData(XV)
if IsUnitInGroup(XV,TE)then
if DN then
set GN=(GN+.04)
endif
if IsUnitInGroup(EV,TE)!=true then
call GroupAddUnit(RN,XV)
set GI[Z]=3
set Y=GetUnitUserData(XV)
call GroupAddUnit(JI,EV)
set HI[Z]=0
call EnableTrigger(VG)
endif
else
if IsUnitType(XV,UNIT_TYPE_MECHANICAL)then
if GetUnitState(XV,UNIT_STATE_MANA)>=GetUnitState(XV,UNIT_STATE_MAX_MANA)then
call GroupAddUnit(RN,XV)
set GI[Z]=3
set DV=GetUnitTypeId(XV)
set Y=GetUnitUserData(XV)
set T=LoadReal(EN,DV,$B)
if T>0 then
set ON[Y]=(ON[Y]+.08)
set HE=LoadDestructableHandle(EN,Y,0)
set OV=LoadUnitHandle(EN,Y,1)
call SetUnitScale(OV,ON[Y]+1,ON[Y]+1,ON[Y]+1)
call SetDestructableAnimationSpeed(HE,ON[Y])
if(S0())then
if ON[Y]>T*2 then
set ON[Y]=(T*2.)
endif
else
if ON[Y]>T then
set ON[Y]=T
endif
endif
endif
call SetUnitManaBJ(XV,.0)
if IsUnitInGroup(XV,KR)then
set PI=CreateGroup()
loop
exitwhen XV==null
set OV=XV
call GroupAddUnit(PI,XV)
set SV=true
set RV=GetUnitLoc(XV)
set T=600.
set XV=null
set bj_wantDestroyGroup=true
call ForGroupBJ(LM(600.,RV,Condition(function T0)),function U0)
call RemoveLocation(RV)
if XV!=null then
set DV=GetUnitTypeId(XV)
call SetUnitManaBJ(XV,.0)
call TQ(XV,EV,I2R(GetUnitPointValue(XV)),.5)
call QQ(XV,1)
set bj_lastCreatedLightning=AddLightningEx("CLPB",true,GetUnitX(XV),GetUnitY(XV),290,GetUnitX(OV),GetUnitY(OV),290)
call HS(bj_lastCreatedLightning,XV,OV,1.5,290,290,1,1)
endif
endloop
call DestroyGroup(PI)
else
if IsUnitInGroup(XV,FI)then
call AddSpecialEffectTargetUnitBJ("head",EV,"Abilities\\Spells\\Human\\Slow\\SlowCaster.mdl")
call DestroyEffect(bj_lastCreatedEffect)
set DV=GetUnitTypeId(XV)
set Y=LoadInteger(QX,DV,4)
set RV=GetUnitLoc(EV)
set IV=GetUnitLoc(XV)
set Z=GetUnitPointValue(XV)
if IsUnitType(EV,UNIT_TYPE_UNDEAD)then
set Z=(Y/ 3)
endif
if Y==0 then
set T=AngleBetweenPoints(IV,RV)
else
set T=AngleBetweenPoints(RV,IV)
endif
call JT(EV,T,I2R(Z),5)
call RemoveLocation(RV)
call RemoveLocation(IV)
endif
endif
else
call IssueImmediateOrderById(XV,$D0004)
endif
else
call GroupAddUnit(RN,XV)
set GI[Z]=3
endif
endif
endfunction
function Z0 takes nothing returns nothing
set DV=GetUnitTypeId(GA)
set Y=GetUnitUserData(GA)
if IsUnitInGroup(GA,TE)then
if DN then
set FA=(FA+(FA*GN))
endif
else
if LoadReal(EN,$A,DV)>0 then
set FA=(FA+(FA*ON[Y]))
set VE=LoadStr(EN,DV,$A)
set bj_lastCreatedLightning=AddLightningEx(VE,true,GetUnitX(GA),GetUnitY(GA),0,GetUnitX(HA),GetUnitY(HA),0)
if ON[Y]>0 then
call HS(bj_lastCreatedLightning,GA,HA,LoadReal(EN,$A,DV),LoadReal(EN,DV,3),20,ON[Y],ON[Y])
else
call HS(bj_lastCreatedLightning,GA,HA,LoadReal(EN,$A,DV),LoadReal(EN,DV,3),20,1,1)
endif
endif
endif
endfunction
function E1 takes nothing returns boolean
return(VE!="SoulxReaver")
endfunction
function X1 takes nothing returns boolean
return(VE!="maddeem")
endfunction
function O1 takes nothing returns nothing
set YV=GetEnumPlayer()
set VE=GetPlayerName(YV)
set UX=(1+GetPlayerId(YV))
set NV[UX]=4
set BV[UX]=4
set AV[UX]=4
set CV[UX]=4
if(E1())then
call SetPlayerTechMaxAllowedSwap('R00V',0,GetEnumPlayer())
endif
if(X1())then
call SetPlayerTechMaxAllowedSwap('R00W',0,GetEnumPlayer())
endif
endfunction
function R1 takes nothing returns nothing
call ForForce(XE,function O1)
if CountPlayersInForceBJ(XE)>1 then
call EnableTrigger(HH)
endif
call QS()
endfunction
function A1 takes nothing returns boolean
return(AR[UX]!=true)
endfunction
function N1 takes nothing returns nothing
local integer array i
set IX=GetEnumPlayer()
set UX=(1+GetPlayerId(IX))
set i[1]=AV[KE]/ KO
set i[2]=BV[KE]/ KO
set i[3]=NV[KE]/ KO
set i[4]=CV[KE]/ KO
if(A1())then
set ME=BV[0]
call DisplayTextToPlayer(IX,0,0,"你已收:")
call DisplayTextToPlayer(IX,0,0,WV[1]+I2S(i[1])+" 蓝宝石|r")
call DisplayTextToPlayer(IX,0,0,WV[2]+I2S(i[2])+" 钻石|r")
call DisplayTextToPlayer(IX,0,0,WV[3]+I2S(i[3])+" 绿宝石|r")
call DisplayTextToPlayer(IX,0,0,WV[4]+I2S(i[4])+" 红宝石|r")
set AV[UX]=AV[UX]+i[1]
set BV[UX]=BV[UX]+i[2]
set NV[UX]=NV[UX]+i[3]
set CV[UX]=CV[UX]+i[4]
endif
endfunction
function B1 takes nothing returns nothing
set YV=GetTriggerPlayer()
set KE=(1+GetPlayerId(YV))
call CU(AX[KE])
call RemoveUnit(AX[KE])
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,(VX[KE]+(AI[KE]+"|r 已经离开游戏!")))
call ForceRemovePlayer(XE,YV)
call TriggerExecute(YF)
call ForForce(XE,function N1)
call QS()
endfunction
function D1 takes nothing returns boolean
return(U>24.)
endfunction
function F1 takes nothing returns boolean
return(NN<=0)
endfunction
function G1 takes nothing returns boolean
return(DV=='h006')or(DV=='h019')or(DV=='h025')or(DV=='h00W')or(DV=='h024')
endfunction
function H1 takes nothing returns boolean
return(G1())
endfunction
function J1 takes nothing returns nothing
set EV=GetTriggerUnit()
if IsUnitInGroup(EV,TE)then
call GroupRemoveUnit(TE,EV)
set NN=(NN-1)
if(F1())then
call TriggerExecute(RG)
else
set W=I2R(NN)
set WR=I2R(FN)
set T=(W/ WR)
set T=(1-T)
set T=(T*12.)
set U=(T+18.)
if(D1())then
set U=(U-24.)
endif
call SetTimeOfDay(U)
endif
else
set DV=GetUnitTypeId(EV)
set YV=GetOwningPlayer(EV)
if(H1())then
call SetPlayerTechMaxAllowedSwap('h006',1,YV)
endif
endif
call CU(EV)
call TriggerSleepAction(15.)
call RemoveUnit(GetTriggerUnit())
endfunction
function L1 takes nothing returns boolean
return(YV==GetFilterPlayer())
endfunction
function M1 takes nothing returns nothing
set EV=GetTriggerUnit()
set YV=GetOwningPlayer(EV)
call DisplayTextToForce(TM(Condition(function L1)),"TRIGSTR_1591")
set KE=(1+GetPlayerId(YV))
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,(VX[KE]+(GetPlayerName(YV)+"|r 已死亡!")))
set RV=GetUnitLoc(EV)
call CreateDestructableLoc('B00D',RV,GetUnitFacing(EV),1.2,0)
call CU(EV)
call RemoveUnit(EV)
call RemoveLocation(RV)
call TriggerExecute(YF)
endfunction
function Q1 takes nothing returns boolean
return(AR[KE]!=true)
endfunction
function S1 takes nothing returns nothing
set EV=GetEnumUnit()
call SetUnitOwner(EV,Player($F),true)
call GroupAddUnit(EI,EV)
endfunction
function T1 takes nothing returns nothing
set EV=GetEnumUnit()
call SetUnitOwner(EV,Player($F),true)
call GroupAddUnit(EI,EV)
endfunction
function U1 takes nothing returns boolean
return(IsPlayerInForce(YV,XE))
endfunction
function W1 takes nothing returns nothing
set EV=GetEnumUnit()
call SetUnitTimeScalePercent(EV,.0)
call PauseUnit(EV,true)
endfunction
function Y1 takes nothing returns nothing
call CustomDefeatBJ(GetEnumPlayer(),"失败!")
endfunction
function Z1 takes nothing returns boolean
return(JR==false)and(KO==0)
endfunction
function V2 takes nothing returns nothing
if(Q1())then
set KO=(KO-1)
endif
set AR[KE]=true
if(U1())then
call ForceRemovePlayer(XE,YV)
set bj_wantDestroyGroup=true
call ForGroupBJ(JM(GB,YV),function T1)
call ForceAddPlayer(XE,YV)
else
set bj_wantDestroyGroup=true
call ForGroupBJ(JM(GB,YV),function S1)
endif
if(Z1())then
call StopSoundBJ(QI,false)
call ClearTextMessagesBJ(bj_FORCE_ALL_PLAYERS)
set JR=true
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"TRIGSTR_1141")
call FogEnableOff()
call FogMaskEnableOff()
call DisableTrigger(XG)
call DisableTrigger(OG)
call DisableTrigger(RG)
call DisableTrigger(IG)
call UseTimeOfDayBJ(false)
call SetDayNightModels("Environment\\DNC\\DNCAshenvale\\DNCAshenvaleTerrain\\DNCAshenvaleTerrain.mdx","Environment\\DNC\\DNCAshenvale\\DNCAshenvaleUnit\\DNCAshenvaleUnit.mdx")
set bj_wantDestroyGroup=true
call ForGroupBJ(HM(GB),function W1)
call PlaySoundBJ(HC)
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"TRIGSTR_1590")
call TriggerSleepAction(60.)
call ForForce(XE,function Y1)
endif
endfunction
function X2 takes nothing returns nothing
set EV=GetEnumUnit()
set Y=GetUnitUserData(EV)
set GI[Y]=(GI[Y]-1)
if GI[Y]==0 then
set ON[Y]=.0
set HE=LoadDestructableHandle(EN,Y,0)
call SetDestructableAnimationSpeed(HE,0)
set OV=LoadUnitHandle(EN,Y,1)
call SetUnitScale(OV,0,0,0)
call GroupRemoveUnit(RN,EV)
endif
endfunction
function Trig_Ai_Fix_Func002Func005002003001 takes nothing returns boolean
return(IsPlayerEnemy(GetOwningPlayer(EV),GetOwningPlayer(GetFilterUnit())))
endfunction
function Trig_Ai_Fix_Func002Func005002003002 takes nothing returns boolean
return(GetUnitStateSwap(UNIT_STATE_LIFE,GetFilterUnit())>.0)
endfunction
function O2 takes nothing returns boolean
return GetBooleanAnd((IsPlayerEnemy(GetOwningPlayer(EV),GetOwningPlayer(GetFilterUnit()))),(GetUnitStateSwap(UNIT_STATE_LIFE,GetFilterUnit())>.0))
endfunction
function R2 takes nothing returns nothing
set EV=GetEnumUnit()
set Y=GetUnitUserData(EV)
if GetOwningPlayer(EV)==Player($B)and IsUnitInGroup(EV,RN)!=true then
set RV=GetUnitLoc(EV)
set PI=LM(128.,RV,Condition(function O2))
if IsUnitGroupEmptyBJ(PI)then
if not NR[Y]or GetUnitState(KI[Y],UNIT_STATE_LIFE)<=0 then
call SS(EV)
endif
else
set XV=GroupPickRandomUnit(PI)
set DV=GetUnitTypeId(XV)
if LoadInteger(QX,DV,5)<1 then
call IssueTargetOrderById(EV,$D0003,XV)
set KI[Y]=XV
endif
endif
call RemoveLocation(RV)
call DestroyGroup(PI)
endif
endfunction
function I2 takes nothing returns nothing
call ForGroupBJ(RN,function X2)
call ForGroupBJ(TE,function R2)
endfunction
function N2 takes nothing returns nothing
set EV=GetEnumUnit()
set Y=GetUnitUserData(EV)
if HI[Y]==$82 then
call GroupRemoveUnit(JI,EV)
else
set HI[Y]=(HI[Y]+1)
endif
endfunction
function B2 takes nothing returns nothing
call ForGroupBJ(JI,function N2)
if IsUnitGroupEmptyBJ(JI)then
call DisableTrigger(GetTriggeringTrigger())
endif
endfunction
function D2 takes nothing returns nothing
call EnableWeatherEffect(ZR,true)
call SetTimeOfDay(5.99)
call UseTimeOfDayBJ(false)
set IN[1]=5
set MI[1]=BD
set PE[1]='n000'
set QE[1]=$F
set PE[2]='n00N'
set QE[2]=45
set QE[3]=40
set PE[3]='n001'
set QE[4]=20
set PE[4]='n00O'
set QE[5]=40
set PE[5]='n013'
set IN[6]=5
set QE[6]='d'
set PE[6]='n003'
set QE[7]=$F
set PE[7]='n00P'
set QE[8]=25
set PE[8]='n004'
set QE[9]=40
set PE[9]='n00O'
set QE[$A]=1
set MI[$A]=ED
set PE[$A]='n00B'
set QE[$B]=30
set PE[$B]='n005'
set IN[$C]=3
set QE[$C]=70
set PE[$C]='n006'
set IN[$D]=5
set QE[$D]='d'
set PE[$D]='n001'
set QE[$E]=30
set PE[$E]='n006'
set QE[$F]=5
set PE[$F]='n007'
set MI[$F]=AD
set QE[16]=$A
set PE[16]='n007'
set MI[16]=ND
set QE[17]=$F
set PE[17]='n008'
set QE[18]=50
set PE[18]='n008'
set QE[19]=30
set PE[19]='n00P'
set QE[20]=1
set PE[20]='n009'
set MI[20]=XD
set SR[20]=NG
set QE[21]=$A
set PE[21]='n00C'
set QE[22]=$A
set PE[22]='n00D'
set QE[23]=20
set PE[23]='n00C'
set QE[24]=$A
set PE[24]='n00D'
set QE[25]=30
set PE[25]='n00C'
set QE[26]=30
set PE[26]='n00R'
set QE[27]=30
set PE[27]='n00E'
set SR[27]=CG
set QE[28]=60
set PE[28]='n00E'
set SR[28]=CG
set IN[29]=2
set QE[29]=50
set PE[29]='n00R'
set QE[30]=1
set MI[30]=VD
set PE[30]='n00F'
set SR[30]=BG
set QE[31]=20
set PE[31]='n00H'
set QE[32]=$A
set PE[32]='n00J'
set QE[32]=30
set PE[32]='n00H'
set QE[33]=30
set PE[33]='n00J'
set QE[34]=$F
set PE[34]='n00K'
set QE[35]=30
set PE[35]='n00Q'
set QE[36]=50
set PE[36]='n00J'
set QE[37]=20
set PE[37]='n00L'
set QE[38]=40
set PE[38]='n00L'
set QE[39]=40
set PE[39]='n00H'
set QE[40]=1
set MI[40]=RD
set PE[40]='n00M'
set QE[41]=60
set PE[41]='n00Q'
set QE[42]=$F
set PE[42]='n00S'
set QE[43]=$F
set PE[43]='n00T'
set QE[44]='d'
set PE[44]='n00R'
set QE[45]=35
set PE[45]='n00T'
set QE[46]=20
set PE[46]='n00U'
set QE[47]=35
set PE[47]='n00S'
set QE[48]=40
set PE[48]='n00U'
set QE[49]=50
set PE[49]='n00T'
set MI[50]=OD
set QE[50]=1
set PE[50]='n00V'
set SR[50]=DG
set QE[51]=60
set PE[51]='n00X'
set QE[52]=60
set PE[52]='n00Z'
set QE[53]='d'
set PE[53]='n010'
set QE[54]='d'
set PE[54]='n00X'
set QE[55]=50
set PE[55]='n00Y'
set QE[56]='d'
set PE[56]='n00Z'
set QE[57]='d'
set PE[57]='n00Y'
set QE[58]=40
set PE[58]='n011'
set QE[59]='d'
set PE[59]='n011'
set MI[50]=ID
set QE[60]=1
set PE[60]='n00G'
set SR[60]=FG
endfunction
function G2 takes nothing returns boolean
return(U>24.)
endfunction
function H2 takes nothing returns boolean
return(DN)
endfunction
function J2 takes nothing returns boolean
return(U>18.)
endfunction
function K2 takes nothing returns nothing
set VI=(VI-1)
if CN then
if(H2())then
call MultiboardSetTitleText(II,(NI+("|cffff0000Boss: "+(I2S(NN)+"|r"))))
else
set W=I2R(NN)
set WR=I2R(FN)
set T=(W/ WR)
set T=(1-T)
set T=(T*12.)
set U=(T+18.)
if(G2())then
set U=(U-24.)
endif
call SetTimeOfDay(U)
call MultiboardSetTitleText(II,(NI+("[|cff3399ff"+(I2S(NN)+"|r]"))))
endif
else
set T=(I2R(VI)/ I2R(BN))
set T=(1-T)
set T=(T*12.)
set U=(T+6.)
if(J2())then
set U=(U-18.)
endif
call SetTimeOfDay(U)
call MultiboardSetTitleText(II,(NI+("[|cffffff00"+(I2S(VI)+"|r]"))))
if VI==0 then
call SetTimeOfDay(18.)
call TriggerExecute(OG)
endif
endif
endfunction
function M2 takes nothing returns boolean
return(GetPlayerState(YV,PLAYER_STATE_RESOURCE_FOOD_CAP)<GetPlayerState(YV,PLAYER_STATE_RESOURCE_FOOD_USED))
endfunction
function P2 takes nothing returns boolean
return(IsUnitAliveBJ(AX[Y]))
endfunction
function Q2 takes nothing returns boolean
return(GetFilterPlayer()==YV)
endfunction
function S2 takes nothing returns boolean
return(GetFilterPlayer()==YV)
endfunction
function T2 takes nothing returns boolean
return(Z==1)
endfunction
function U2 takes nothing returns boolean
return(AR[Y]!=true)and(KX[Y]<(UE*2))
endfunction
function W2 takes nothing returns boolean
return(UE==40)or(UE==50)or(UE==60)
endfunction
function Y2 takes nothing returns boolean
return(AR[Y]!=true)and(W2())and(GetPlayerState(YV,PLAYER_STATE_RESOURCE_FOOD_CAP)>OI[Y])
endfunction
function Z2 takes nothing returns boolean
return(UE>=RI)
endfunction
function V3 takes nothing returns nothing
set CN=true
call EnableWeatherEffect(ZR,false)
set SE=0
if UE==0 then
set UE=0
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"载入积分代码现已停用!")
call DisableTrigger(JH)
endif
set Y=1
loop
exitwhen Y>$C
set YV=Player(-1+(Y))
if(P2())then
call AdjustPlayerStateBJ(1,YV,PLAYER_STATE_RESOURCE_FOOD_USED)
if(M2())then
call AdjustPlayerStateBJ(1,YV,PLAYER_STATE_RESOURCE_FOOD_CAP)
endif
endif
set Y=Y+1
endloop
if QP(UE,$A)and UE!=0 then
set Y=1
loop
exitwhen Y>$C
set YV=Player(-1+(Y))
if(U2())then
set Z=(UE/ $A)
set KX[Y]=(KX[Y]+Z)
if(T2())then
call DisplayTextToForce(TM(Condition(function Q2)),("|cff90ee90你获得 "+(I2S(Z)+" 点积分!|r")))
else
call DisplayTextToForce(TM(Condition(function S2)),("|cff90ee90你获得 "+(I2S(Z)+" 点积分!|r")))
endif
call AdjustPlayerStateBJ(Z,YV,PLAYER_STATE_RESOURCE_GOLD)
endif
set Y=Y+1
endloop
if(Y2())then
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,(AI[Y]+(" 被封号为 "+(AI[Y]+XI[UE]))))
call SetPlayerName(YV,(AI[Y]+XI[UE]))
endif
endif
if(Z2())then
call TriggerExecute(HG)
else
set UE=(UE+1)
set LI=R2I(I2R(QE[UE])*I2R((CountPlayersInForceBJ(XE))/ 4+1))
if QP(UE,$A)and UE!=0 then
set DN=true
set NN=LI
else
set NN=(LI+'d')
set FN=NN
set DN=false
endif
set SE=0
call EnableTrigger(AG)
call EnableTrigger(IG)
call EnableTrigger(ZF)
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,("|cffff0000第 "+(I2S(UE)+" 晚!|r")))
call SetDayNightModels("","")
if MI[UE]!=null then
call PlaySoundBJ(MI[UE])
endif
endif
endfunction
function X3 takes nothing returns boolean
return(IsUnitAliveBJ(EV))
endfunction
function O3 takes nothing returns nothing
set EV=GetEnumUnit()
if(X3())then
call CU(EV)
call KillUnit(EV)
set RV=GetUnitLoc(EV)
call AddSpecialEffectLocBJ(RV,"Objects\\Spawnmodels\\Human\\HCancelDeath\\HCancelDeath.mdl")
call DestroyEffect(bj_lastCreatedEffect)
call RemoveLocation(RV)
endif
endfunction
function R3 takes nothing returns boolean
return(IsUnitAliveBJ(EV))
endfunction
function I3 takes nothing returns nothing
set EV=GetEnumUnit()
if(R3())then
call CU(EV)
call RemoveUnit(EV)
endif
endfunction
function A3 takes nothing returns nothing
set GN=.0
call SetTimeOfDay(6.)
set BN=(90/ TR)
set VI=BN
set CN=false
call EnableWeatherEffect(ZR,true)
call DisableTrigger(IG)
call ForGroupBJ(TE,function O3)
set bj_wantDestroyGroup=true
call ForGroupBJ(QM(Player($B)),function I3)
if UE>0 then
call SetDayNightModels("Environment\\DNC\\DNCAshenvale\\DNCAshenvaleTerrain\\DNCAshenvaleTerrain.mdx","Environment\\DNC\\DNCAshenvale\\DNCAshenvaleUnit\\DNCAshenvaleUnit.mdx")
endif
endfunction
function B3 takes nothing returns boolean
return(SE<=LI)
endfunction
function C3 takes nothing returns boolean
return(AN<=0)
endfunction
function D3 takes nothing returns boolean
return(CountUnitsInGroup(TE)<=30)
endfunction
function F3 takes nothing returns nothing
if IN[UE]==0 then
set IN[UE]=$A
set AN=0
endif
if(D3())then
if(C3())then
set AN=IN[UE]
set SE=(SE+1)
if(B3())then
set Y=GetRandomInt(1,DR)
set DV=PE[UE]
call CreateNUnitsAtLoc(1,DV,Player($B),BR[Y],GetRandomReal(0,360))
set EV=bj_lastCreatedUnit
set Y=GetUnitUserData(EV)
call SS(EV)
call AddSpecialEffectLocBJ(BR[Y],"Objects\\Spawnmodels\\Undead\\UndeadBlood\\UndeadBloodGargoyle.mdl")
call DestroyEffect(bj_lastCreatedEffect)
call SetDestructableAnimation(CR[Y],"attack")
call QueueDestructableAnimation(CR[Y],"stand")
call GroupAddUnit(TE,EV)
call TriggerExecute(SR[UE])
else
call DisableTrigger(GetTriggeringTrigger())
endif
else
set AN=(AN-1)
endif
endif
endfunction
function H3 takes nothing returns boolean
return(IsUnitGroupEmptyBJ(TE))and(SE>=LI)
endfunction
function J3 takes nothing returns nothing
if not DN then
if NN==0 then
call TriggerExecute(RG)
call DisableTrigger(GetTriggeringTrigger())
else
if(H3())then
call TriggerExecute(RG)
call DisableTrigger(GetTriggeringTrigger())
else
set NN=(NN-1)
endif
endif
endif
endfunction
function L3 takes nothing returns nothing
call EQ(EV,'n00A','d',90,true)
call EQ(EV,'n00A','d',$B4,true)
call EQ(EV,'n00A','d',270,true)
call EQ(EV,'n00A','d',360,true)
endfunction
function P3 takes nothing returns nothing
call TriggerRegisterUnitEvent(LG,EV,EVENT_UNIT_DAMAGED)
endfunction
function S3 takes nothing returns nothing
call TriggerRegisterUnitEvent(KG,EV,EVENT_UNIT_DEATH)
endfunction
function U3 takes nothing returns nothing
call TriggerRegisterUnitEvent(GG,EV,EVENT_UNIT_ATTACKED)
endfunction
function Y3 takes nothing returns nothing
call EQ(EV,'n00W',$C8,90,true)
call EQ(EV,'n00W',$C8,$B4,true)
call EQ(EV,'n00W',$C8,270,true)
call EQ(EV,'n00W',$C8,360,true)
set UX=1
loop
exitwhen UX>$A
call EQ(EV,'n00A',GetRandomReal($96,300),36*UX,true)
set UX=UX+1
endloop
endfunction
function V4 takes nothing returns nothing
local timer t=GetExpiredTimer()
local integer i=GetHandleId(t)
local unit u=LoadUnitHandle(QX,i,0)
local real r=LoadReal(QX,i,1)
local real rr=GetUnitFacing(u)
local real x=GetUnitX(u)+20*Cos(rr*bj_DEGTORAD)
local real y=GetUnitY(u)+20*Sin(rr*bj_DEGTORAD)
if r>0 and LP(x,y)then
call SetUnitX(u,x)
call SetUnitY(u,y)
call SaveReal(QX,i,1,r-20)
if GetRandomReal(0,'d')<=50 then
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\NightElf\\BattleRoar\\RoarCaster.mdl",x,y))
endif
else
call PauseUnit(u,false)
call FlushChildHashtable(QX,i)
call DestroyTimer(t)
endif
set t=null
set u=null
endfunction
function E4 takes nothing returns nothing
local timer t
local unit u=GetTriggerUnit()
local integer i
if GetRandomReal(0,'d')<=5 then
set t=CreateTimer()
call TimerStart(t,.03125,true,function V4)
set i=GetHandleId(t)
call SaveUnitHandle(QX,i,0,u)
call SaveReal(QX,i,1,640)
call PauseUnit(u,true)
endif
set t=null
set u=null
endfunction
function O4 takes nothing returns boolean
return(TR<5)
endfunction
function R4 takes nothing returns boolean
return(GetUnitName(GetEnumUnit())=="Miner")
endfunction
function I4 takes nothing returns nothing
if(R4())then
set RV=GetRandomLocInRect(ZB)
call SetUnitPositionLoc(GetEnumUnit(),RV)
call RemoveLocation(RV)
set RV=GetRandomLocInRect(SB)
call IssuePointOrderByIdLoc(GetEnumUnit(),$D0012,RV)
call RemoveLocation(RV)
else
call SetUnitAnimation(GetEnumUnit(),"victory")
endif
endfunction
function A4 takes nothing returns nothing
call CustomVictoryBJ(GetEnumPlayer(),false,true)
endfunction
function N4 takes nothing returns nothing
if(O4())then
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cff9acd32您赢了这款游戏，下次可以尝试更高的难度!|r")
else
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cff9acd32您在|cffff0000地狱|r|cff9acd32难度下击破这款游戏!|r")
endif
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"TRIGSTR_2383")
call StopSoundBJ(QI,false)
call PlaySoundBJ(FC)
call TriggerSleepAction(2)
call ShowUnitShow(WJ)
call GQ(WJ,-750,5)
call CameraSetupApplyForPlayer(true,RC,GetLocalPlayer(),6)
call CinematicModeBJ(true,bj_FORCE_ALL_PLAYERS)
call TransmissionFromUnitTypeWithNameBJ(bj_FORCE_ALL_PLAYERS,Player(1),'zmar',"戴维队长",GetRectCenter(YB),GD,"戴维队长是人类的救援队伍领导。 如有任何幸存者，请在指定的寺庙出口集合。",0,10.,false)
call FogEnableOff()
call FogMaskEnableOff()
call TriggerSleepAction(4.)
call EnableTrigger(JG)
set bj_wantDestroyGroup=true
call ForGroupBJ(HM(bj_mapInitialPlayableArea),function I4)
call TriggerSleepAction(15.)
call TransmissionFromUnitTypeWithNameBJ(bj_FORCE_ALL_PLAYERS,Player(1),'zmar',"戴维队长",GetRectCenter(YB),GD,"让我们离开这里他妈的鬼地方。",0,10.,false)
call CameraSetupApplyForPlayer(true,IC,GetLocalPlayer(),6)
call GQ(WJ,600,5)
call DisableTrigger(XG)
call UseTimeOfDayBJ(false)
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"TRIGSTR_2388")
call TriggerSleepAction(6.)
call SetUnitVertexColorBJ(WJ,.0,'d','d',70.)
set EV=WJ
call JT(EV,$B4,6000,1.5)
call GQ(EV,$3E8,1.5)
call CinematicFadeBJ(1,5.,"ReplaceableTextures\\CameraMasks\\Black_mask.blp",100.,.0,.0,0)
call PlaySoundBJ(HD)
call TriggerSleepAction(2.)
call CinematicModeBJ(false,bj_FORCE_ALL_PLAYERS)
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffffa500感谢 Hiveworkshop.com 提供资源和支缓。没有这小区论坛，这个地图得久不会更新。|r")
call TriggerSleepAction(5.)
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|r|cff6b8e23Also a huge shoutout to Clan VoF for all their support and bug testing...|r")
call TriggerSleepAction(5.)
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"TRIGSTR_2433")
call TriggerSleepAction(20.)
call ForForce(XE,function A4)
endfunction
function C4 takes nothing returns nothing
call TriggerSleepAction(.25)
set RV=GetUnitLoc(GetTriggerUnit())
call AddSpecialEffectLocBJ(RV,"Abilities\\Spells\\NightElf\\Blink\\BlinkTarget.mdl")
call RemoveLocation(RV)
call ShowUnitHide(GetTriggerUnit())
endfunction
function F4 takes nothing returns nothing
set EV=GetTriggerUnit()
call UnitRemoveAbility(EV,'A003')
set RV=GetUnitLoc(EV)
set YV=GetOwningPlayer(EV)
call CreateNUnitsAtLoc(1,'n006',YV,RV,GetUnitFacing(EV))
set XV=bj_lastCreatedUnit
call UnitApplyTimedLifeBJ(60,'BTLF',XV)
call GroupAddUnit(TE,XV)
call RemoveLocation(RV)
endfunction
function H4 takes nothing returns nothing
call IssueImmediateOrderById(GetTriggerUnit(),$D009B)
endfunction
function K4 takes nothing returns nothing
set YV=GetTriggerPlayer()
set Y=(1+GetPlayerId(YV))
if WX[Y]then
set WX[Y]=false
call SetPlayerUnitAvailableBJ('h007',true,YV)
call SetPlayerUnitAvailableBJ('h00A',true,YV)
call SetPlayerUnitAvailableBJ('h00C',true,YV)
call SetPlayerUnitAvailableBJ('h005',true,YV)
call SetPlayerUnitAvailableBJ('h00J',true,YV)
call SetPlayerUnitAvailableBJ('o000',true,YV)
call SetPlayerUnitAvailableBJ('h014',true,YV)
call SetPlayerUnitAvailableBJ('h012',true,YV)
call SetPlayerUnitAvailableBJ('h00V',true,YV)
call SetPlayerUnitAvailableBJ('o001',true,YV)
call SetPlayerUnitAvailableBJ('o00A',true,YV)
else
set WX[Y]=true
call SetPlayerUnitAvailableBJ('h007',false,YV)
call SetPlayerUnitAvailableBJ('h00A',false,YV)
call SetPlayerUnitAvailableBJ('h00C',false,YV)
call SetPlayerUnitAvailableBJ('h005',false,YV)
call SetPlayerUnitAvailableBJ('h00J',false,YV)
call SetPlayerUnitAvailableBJ('o000',false,YV)
call SetPlayerUnitAvailableBJ('h014',false,YV)
call SetPlayerUnitAvailableBJ('h012',false,YV)
call SetPlayerUnitAvailableBJ('h00V',false,YV)
call SetPlayerUnitAvailableBJ('o001',false,YV)
call SetPlayerUnitAvailableBJ('o00A',false,YV)
endif
endfunction
function M4 takes nothing returns boolean
return(YV==GetFilterPlayer())
endfunction
function P4 takes nothing returns nothing
set EV=GetTriggerUnit()
set XV=GetSpellTargetUnit()
set RV=GetUnitLoc(XV)
set YV=GetTriggerPlayer()
set Y=GetUnitUserData(EV)
if GetUnitState(XV,UNIT_STATE_MANA)/ GetUnitState(XV,UNIT_STATE_MAX_MANA)>=.9 and GetUnitTypeId(XV)=='h00V' then
set BI[Y]=XV
call DisplayTextToForce(TM(Condition(function M4)),"|cffffd700传送门位置设定!|r")
if GetLocalPlayer()==YV then
call PlaySoundBJ(BC)
endif
call WaygateSetDestinationLocBJ(EV,RV)
else
call IS(YV,"目标必须为传送门!")
endif
call RemoveLocation(RV)
endfunction
function S4 takes nothing returns nothing
set EV=GetTriggerUnit()
set YV=GetOwningPlayer(EV)
set DV=GetUnitTypeId(EV)
set Y=GetUnitUserData(EV)
call CU(EV)
call ReplaceUnitBJ(EV,'h017',1)
set XV=bj_lastReplacedUnit
call VS(XV)
set Z=GetUnitUserData(XV)
set JO[Z]=DV
call SelectUnitForPlayerSingle(XV,YV)
if HI[Y]>0 then
set HI[Z]=HI[Y]
call GroupAddUnit(JI,XV)
endif
endfunction
function U4 takes nothing returns nothing
set EV=GetTriggerUnit()
set YV=GetOwningPlayer(EV)
set Y=GetUnitUserData(EV)
set T=GetUnitX(EV)
set U=GetUnitY(EV)
set YR=GetUnitLifePercent(EV)
set DV=JO[Y]
set XV=CreateUnit(YV,'h01P',T,U,270)
set W=GetUnitX(XV)
set WR=GetUnitY(XV)
call CU(XV)
call RemoveUnit(XV)
if T==W and U==WR then
call RemoveUnit(EV)
set XV=CreateUnit(YV,DV,T,U,270)
call SetUnitLifePercentBJ(XV,YR)
call SelectUnitForPlayerSingle(XV,YV)
set Z=GetUnitUserData(XV)
if HI[Y]>0 then
set HI[Z]=HI[Y]
call GroupAddUnit(JI,XV)
endif
call VS(XV)
else
call IS(YV,"在邻近的墙上必须没有单位!")
endif
call RemoveLocation(RV)
endfunction
function Y4 takes nothing returns nothing
local unit u=GetTriggerUnit()
local location p=GetUnitLoc(u)
local player pp=GetTriggerPlayer()
local effect a=AddSpecialEffectLoc("war3mapImported\\BlackCloudOfFog.mdx",p)
call TriggerSleepAction(5)
call SetBlightLoc(pp,p,400,true)
call DestroyEffect(a)
call RemoveLocation(p)
set a=null
set p=null
set u=null
endfunction
function V5 takes nothing returns nothing
set EV=GetTriggerUnit()
set RV=GetUnitLoc(EV)
set YV=GetOwningPlayer(EV)
set Z=1
loop
exitwhen Z>3
call CreateNUnitsAtLoc(1,'n00H',YV,RV,GetRandomReal(0,360))
set XV=bj_lastCreatedUnit
call UnitApplyTimedLifeBJ(60,'BTLF',XV)
call GroupAddUnit(TE,XV)
set Z=Z+1
endloop
call RemoveLocation(RV)
call TriggerExecute(TG)
endfunction
function X5 takes nothing returns nothing
set EV=GetTriggerUnit()
set Y=GetUnitUserData(EV)
if QR[Y]then
set QR[Y]=false
call UnitAddAbility(EV,'A00Q')
call UnitRemoveAbility(EV,'A00Q')
else
set QR[Y]=true
call UnitAddAbility(EV,'A00V')
call UnitRemoveAbility(EV,'A00V')
endif
endfunction
function R5 takes nothing returns nothing
set EV=GetTriggerUnit()
set DV=GetUnitTypeId(EV)
call UnitRemoveAbility(EV,GetSpellAbilityId())
call UnitAddAbility(EV,'A017')
call SaveInteger(QX,DV,4,1)
endfunction
function A5 takes nothing returns nothing
set EV=GetTriggerUnit()
set DV=GetUnitTypeId(EV)
call UnitRemoveAbility(EV,GetSpellAbilityId())
call UnitAddAbility(EV,'A018')
call SaveInteger(QX,DV,4,0)
endfunction
function Trig_Black_Hole_Func005Func003Func009Func002001003001 takes nothing returns boolean
return(IsPlayerEnemy(GetOwningPlayer(GetFilterUnit()),GetOwningPlayer(EV)))
endfunction
function Trig_Black_Hole_Func005Func003Func009Func002001003002001 takes nothing returns boolean
return(IsUnitType(GetFilterUnit(),UNIT_TYPE_MAGIC_IMMUNE)!=true)!=null
endfunction
function Trig_Black_Hole_Func005Func003Func009Func002001003002002001 takes nothing returns boolean
return(IsUnitAliveBJ(GetFilterUnit()))
endfunction
function Trig_Black_Hole_Func005Func003Func009Func002001003002002002 takes nothing returns boolean
return(IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)!=true)!=null
endfunction
function Trig_Black_Hole_Func005Func003Func009Func002001003002002 takes nothing returns boolean
return(GetBooleanAnd((IsUnitAliveBJ(GetFilterUnit())),(IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)!=true)))!=null
endfunction
function Trig_Black_Hole_Func005Func003Func009Func002001003002 takes nothing returns boolean
return(GetBooleanAnd((IsUnitType(GetFilterUnit(),UNIT_TYPE_MAGIC_IMMUNE)!=true),(GetBooleanAnd((IsUnitAliveBJ(GetFilterUnit())),(IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)!=true)))))!=null
endfunction
function B5 takes nothing returns boolean
return(GetBooleanAnd((IsPlayerEnemy(GetOwningPlayer(GetFilterUnit()),GetOwningPlayer(EV))),(GetBooleanAnd((IsUnitType(GetFilterUnit(),UNIT_TYPE_MAGIC_IMMUNE)!=true),(GetBooleanAnd((IsUnitAliveBJ(GetFilterUnit())),(IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)!=true)))))))!=null
endfunction
function C5 takes nothing returns boolean
return(Z==1)
endfunction
function D5 takes nothing returns boolean
return(SV!=true)and(W>=U)
endfunction
function F5 takes nothing returns nothing
set XV=GetEnumUnit()
set IV=GetUnitLoc(XV)
set U=DistanceBetweenPoints(RV,IV)
set W=((T/ U)*2.)
set GR=XM(IV,W,AngleBetweenPoints(IV,RV))
if(D5())then
set Z=LoadInteger(SI,Y,9)
call SaveInteger(SI,Y,9,Z-1)
call GroupAddUnit(PI,XV)
call PauseUnit(XV,true)
call ShowUnitHide(XV)
if(C5())then
set SV=true
endif
else
call SetUnitX(XV,GetLocationX(GR))
call SetUnitY(XV,GetLocationY(GR))
endif
call RemoveLocation(IV)
call RemoveLocation(GR)
endfunction
function G5 takes nothing returns boolean
return(Z==1)
endfunction
function H5 takes nothing returns nothing
set XV=GetEnumUnit()
call PauseUnit(XV,false)
call ShowUnitShow(XV)
call AddSpecialEffectTargetUnitBJ("chest",XV,"Abilities\\Spells\\Undead\\DeathCoil\\DeathCoilSpecialArt.mdl")
call DestroyEffect(bj_lastCreatedEffect)
call UnitDamageTargetBJ(EV,XV,T,ATTACK_TYPE_CHAOS,DAMAGE_TYPE_ENHANCED)
endfunction
function J5 takes nothing returns boolean
return(CountUnitsInGroup(RA)==0)
endfunction
function K5 takes nothing returns boolean
return(SV)
endfunction
function L5 takes nothing returns nothing
set SV=false
set EV=GetEnumUnit()
set Y=GetHandleId(EV)
set Z=LoadInteger(SI,Y,8)
set T=LoadReal(SI,Y,6)
set RV=LoadLocationHandle(SI,Y,4)
call SaveInteger(SI,Y,8,Z-1)
set PI=LoadGroupHandle(SI,Y,3)
if(G5())then
set SV=true
else
set bj_wantDestroyGroup=true
call ForGroupBJ(LM(T,RV,Condition(function B5)),function F5)
endif
if(K5())then
call DestroyEffect(LoadEffectHandle(SI,Y,1))
set T=LoadReal(SI,Y,7)*CountUnitsInGroup(PI)
call ForGroupBJ(PI,function H5)
call GroupRemoveUnit(RA,EV)
call RemoveLocation(RV)
call DestroyGroup(PI)
if(J5())then
call DisableTrigger(GetTriggeringTrigger())
endif
endif
endfunction
function M5 takes nothing returns boolean
return(GetSpellAbilityId()!='A01B')
endfunction
function P5 takes nothing returns nothing
local real x
local real y
local integer i
if(M5())then
call ForGroupBJ(RA,function L5)
else
call PlaySoundBJ(CD)
call EnableTrigger(GetTriggeringTrigger())
set EV=GetTriggerUnit()
call AddSpecialEffectTargetUnitBJ("origin",EV,"Abilities\\Spells\\Demon\\DarkPortal\\DarkPortalTarget.mdl")
call DestroyEffect(bj_lastCreatedEffect)
set i=GetUnitAbilityLevel(EV,'A01B')
set Y=GetHandleId(EV)
set RV=GetSpellTargetLoc()
set x=GetLocationX(RV)
set y=GetLocationY(RV)
call SaveEffectHandle(SI,Y,1,AddSpecialEffect("war3mapImported\\BlackHoleSpell.mdx",x,y))
call SaveGroupHandle(SI,Y,3,CreateGroup())
call SaveLocationHandle(SI,Y,4,RV)
call SaveInteger(SI,Y,5,i)
call SaveReal(SI,Y,6,TI[i])
call SaveReal(SI,Y,7,YI[i])
call SaveInteger(SI,Y,8,R2I(I2R(UI[i])/ .03))
call SaveInteger(SI,Y,9,WI[i])
call GroupAddUnit(RA,EV)
endif
endfunction
function S5 takes nothing returns nothing
set EV=GetTriggerUnit()
call UnitAddAbility(EV,'A01Q')
call UnitRemoveAbility(EV,'A01Q')
endfunction
function U5 takes nothing returns nothing
set EV=GetTriggerUnit()
call UnitAddAbility(EV,'A01O')
call UnitRemoveAbility(EV,'A01O')
endfunction
function Y5 takes nothing returns nothing
set EV=GetTriggerUnit()
call UnitAddAbility(EV,'A01P')
call UnitRemoveAbility(EV,'A01P')
endfunction
function V6 takes nothing returns nothing
set EV=GetTriggerUnit()
set XV=LoadUnitHandle(XN,GetHandleId(EV),0)
call RemoveUnit(XV)
call UnitAddAbility(EV,'A01U')
call UnitRemoveAbility(EV,'A01U')
call SetUnitAnimation(EV,"stand")
endfunction
function X6 takes nothing returns nothing
set EV=GetTriggerUnit()
set DV=GetUnitTypeId(EV)
set YV=GetOwningPlayer(EV)
set XV=CreateUnit(YV,DV,GetUnitX(EV),GetUnitY(EV),270)
call SaveUnitHandle(XN,GetHandleId(EV),0,XV)
call ShowUnitHide(XV)
call UnitAddAbility(EV,'A01T')
call UnitRemoveAbility(EV,'A01T')
call SetUnitAnimation(EV,"stand")
endfunction
function R6 takes nothing returns nothing
set EV=GetTriggerUnit()
set XV=LoadUnitHandle(XN,GetHandleId(EV),0)
call RemoveUnit(XV)
call UnitAddAbility(EV,'A020')
call UnitRemoveAbility(EV,'A020')
call SetUnitAnimation(EV,"stand")
endfunction
function A6 takes nothing returns nothing
set EV=GetTriggerUnit()
set DV=GetUnitTypeId(EV)
set YV=GetOwningPlayer(EV)
set XV=CreateUnit(YV,DV,GetUnitX(EV),GetUnitY(EV),270)
call SaveUnitHandle(XN,GetHandleId(EV),0,XV)
call ShowUnitHide(XV)
call UnitAddAbility(EV,'A01Z')
call UnitRemoveAbility(EV,'A01Z')
call SetUnitAnimation(EV,"stand")
endfunction
function B6 takes nothing returns boolean
return(WN[HV])
endfunction
function C6 takes nothing returns nothing
if(B6())then
call SetPlayerAbilityAvailableBJ(false,'A01R',GetOwningPlayer(JV[HV]))
call LQ(JV[HV],5)
endif
endfunction
function F6 takes nothing returns nothing
set DV=GetUnitTypeId(HN)
set T=LoadReal(YE,DV,1)
if PN==false and KN[GetPlayerId(JN)+1]==1 and T>0 then
if JN==GetLocalPlayer()then
call ClearTextMessages()
endif
call DisplayTextToPlayer(JN,0,0,"范围: [ "+I2S(R2I(T))+" ]")
call MP(HN,JN,T,'B01E')
set Y=LoadInteger(YE,DV,0)
if Y>0 then
call DisplayTextToPlayer(JN,0,0,"传输速率: [ "+I2S(Y)+" ]")
endif
endif
endfunction
function H6 takes nothing returns nothing
call PP(HN,JN)
endfunction
function K6 takes nothing returns nothing
if GetTriggerPlayer()==GetLocalPlayer()then
call ClearTextMessages()
endif
endfunction
function M6 takes nothing returns nothing
set ER=0
set OR=0
set IR=0
set LO="ZXCVBNM1234567890ASDFGHJKLQWERTYUIOP!@#"
set MO=true
set PO=true
set QO=false
endfunction
function Q6 takes nothing returns nothing
set YV=GetTriggerPlayer()
set VE=GetPlayerName(YV)
set Y=(1+GetPlayerId(YV))
call SetPlayerName(YV,AI[Y])
set TO[1]=KX[Y]
set TO[2]=GetPlayerState(YV,PLAYER_STATE_RESOURCE_FOOD_CAP)
set UO=2
set SO=FT()
call SetPlayerName(YV,VE)
call DisplayTimedTextToForce(SM(YV),360.,SO)
call DisplayTimedTextToForce(SM(YV),360.,"TRIGSTR_1570")
endfunction
function T6 takes nothing returns boolean
return(YV==GetFilterPlayer())
endfunction
function U6 takes nothing returns boolean
return(StringLength(LR)>=2)
endfunction
function W6 takes nothing returns boolean
return(YV==GetFilterPlayer())
endfunction
function Y6 takes nothing returns boolean
return(WO)
endfunction
function Z6 takes nothing returns boolean
return(LX[Y]!=true)
endfunction
function V7 takes nothing returns boolean
return(Z>6)
endfunction
function E7 takes nothing returns nothing
set YV=GetTriggerPlayer()
set Y=(1+GetPlayerId(YV))
set VE=GetEventPlayerChatString()
set Z=StringLength(VE)
set MR=GetPlayerName(YV)
if(V7())then
if(Z6())then
set SO=SubStringBJ(VE,7,Z)
set WO=GT(SO)
if(Y6())then
set LX[Y]=true
call DisplayTextToForce(TM(Condition(function T6)),"授权验证: |cff00a600允许|r")
set KX[Y]=TO[1]
call SetPlayerStateBJ(YV,PLAYER_STATE_RESOURCE_GOLD,TO[1])
call SetPlayerStateBJ(YV,PLAYER_STATE_RESOURCE_FOOD_CAP,TO[2])
if MR=="Holy_xXx" or MR=="Sheep100" then
call AdjustPlayerStateBJ($A,YV,PLAYER_STATE_RESOURCE_GOLD)
endif
set OI[Y]=TO[2]
set LR=I2S(TO[2])
if(U6())then
call SetPlayerName(YV,(AI[Y]+XI[S2I((SubStringBJ(LR,1,1)+"0"))]))
endif
else
call DisplayTextToForce(TM(Condition(function W6)),"授权验证: |cffff0000拒绝|r")
endif
else
call IS(YV,"你已经加载过积分代码了!")
endif
endif
endfunction
function O7 takes nothing returns boolean
return(CountPlayersInForceBJ(SN)==0)
endfunction
function R7 takes nothing returns boolean
return(T==.0)
endfunction
function I7 takes nothing returns boolean
return(T>=500.)and(T<=5000.)
endfunction
function A7 takes nothing returns nothing
set YV=GetTriggerPlayer()
set VE=GetEventPlayerChatString()
set T=S2R(SubStringBJ(VE,7,$A))
if(I7())then
call ForceAddPlayer(SN,YV)
set QN[(1+GetPlayerId(YV))]=T
call SetCameraFieldForPlayer(YV,CAMERA_FIELD_TARGET_DISTANCE,T,1.)
call EnableTrigger(LH)
else
if(R7())then
call ForceRemovePlayer(SN,YV)
call ResetToGameCameraForPlayer(YV,1.)
if(O7())then
call DisableTrigger(LH)
endif
endif
endif
endfunction
function B7 takes nothing returns nothing
set YV=GetEnumPlayer()
call SetCameraFieldForPlayer(YV,CAMERA_FIELD_TARGET_DISTANCE,QN[(1+GetPlayerId(YV))],1.)
endfunction
function C7 takes nothing returns nothing
call ForForce(SN,function B7)
endfunction
function F7 takes nothing returns boolean
return(HX==0)
endfunction
function G7 takes nothing returns boolean
return(ME!=1)and(GetUnitName(JV[HV])!="Dummy")and((1+GetPlayerId(GetOwningPlayer(JV[HV])))<$C)
endfunction
function H7 takes nothing returns boolean
return(CX)
endfunction
function J7 takes nothing returns boolean
return(GetUnitUserData(JV[HV])==0)
endfunction
function K7 takes nothing returns boolean
return(BX==$F)
endfunction
function L7 takes nothing returns boolean
return(GetUnitUserData(GetFilterUnit())==0)
endfunction
function M7 takes nothing returns nothing
call ExecuteFunc("P7")
endfunction
function Q7 takes nothing returns boolean
local integer S7=HV
if(H7())then
if(F7())then
set HV=(FX+1)
set FX=HV
else
set HV=HX
set HX=GX[HV]
endif
set JV[HV]=GetFilterUnit()
call SetUnitUserData(JV[HV],HV)
set ME=LoadInteger(QX,GetUnitTypeId(JV[HV]),5)
if(G7())then
call GroupAddUnit(DI,JV[HV])
endif
set DX[GX[0]]=HV
set GX[HV]=GX[0]
set GX[0]=HV
set KV=.0
set KV=1.
set KV=.0
set HV=S7
endif
return false
endfunction
function T7 takes nothing returns boolean
local integer S7=HV
local integer U7
set BX=(BX+1)
if(K7())then
set BX=0
set HV=GX[0]
loop
exitwhen HV==0
if(J7())then
set U7=GX[HV]
set GX[DX[HV]]=U7
set DX[U7]=DX[HV]
set DX[HV]=0
set KV=2.
set KV=.0
set JV[HV]=null
set GX[HV]=HX
set HX=HV
set HV=U7
else
set HV=GX[HV]
endif
endloop
set HV=S7
endif
if(L7())then
call Q7()
endif
return false
endfunction
function P7 takes nothing returns nothing
local integer i=0
local region re=CreateRegion()
local rect r=GetWorldBounds()
set CX=true
call RegionAddRect(re,r)
call TriggerRegisterEnterRegion(CreateTrigger(),re,Filter(function T7))
call RemoveRect(r)
set re=null
set r=null
loop
call GroupEnumUnitsOfPlayer(bj_lastCreatedGroup,Player(i),Filter(function Q7))
set i=i+1
exitwhen i==16
endloop
set KV=3.
set KV=.0
endfunction
function Y7 takes nothing returns boolean
return(GetUnitDefaultMoveSpeed(JV[HV])!=.0)
endfunction
function Z7 takes nothing returns boolean
return(KV==1.)
endfunction
function V8 takes nothing returns nothing
if(Z7())then
if(Y7())then
set RE[OE[0]]=HV
set OE[HV]=OE[0]
set OE[0]=HV
set AE[HV]=GetUnitX(JV[HV])
set BE[HV]=GetUnitY(JV[HV])
endif
elseif KV==2 then
if RE[HV]!=0 or OE[0]==HV then
set NR[HV]=false
set OE[RE[HV]]=OE[HV]
set RE[OE[HV]]=RE[HV]
set RE[HV]=0
endif
else
set HV=OE[0]
loop
exitwhen HV==0
set CE=GetUnitX(JV[HV])
set DE=GetUnitY(JV[HV])
set IE[HV]=AE[HV]
set NE[HV]=BE[HV]
if CE!=AE[HV]or DE!=BE[HV]then
set AE[HV]=CE
set BE[HV]=DE
if not NR[HV]and GetUnitTypeId(JV[HV])!=0 then
set NR[HV]=true
set FE=1.
set FE=.0
endif
elseif NR[HV]then
set NR[HV]=false
set FE=2.
set FE=.0
endif
set HV=OE[HV]
endloop
endif
endfunction
function X8 takes nothing returns boolean
return(Z>0)and(LR=="-")and(MR!="-load")
endfunction
function O8 takes nothing returns nothing
set YV=GetTriggerPlayer()
set Y=(1+GetPlayerId(YV))
set VE=SubStringBJ(GetEventPlayerChatString(),2,9)
set LR=SubStringBJ(GetEventPlayerChatString(),1,1)
set MR=SubStringBJ(GetEventPlayerChatString(),1,5)
set Z=S2I(VE)
set EX[Y]=Z
if(X8())then
call DialogClear(NX[Y])
call DialogSetMessage(NX[Y],"选择 |cff0000ffMi|r|cff99b4d1ne|r|cffadff2fra|r|cffff0000lz|r")
call DialogAddButtonBJ(NX[Y],"|cff0000ff蓝宝石|r")
call SaveInteger(XN,GetHandleId(bj_lastCreatedButton),0,1)
call DialogAddButtonBJ(NX[Y],"|cff99b4d1钻石|r")
call SaveInteger(XN,GetHandleId(bj_lastCreatedButton),0,2)
call DialogAddButtonBJ(NX[Y],"|cffadff2f绿宝石|r")
call SaveInteger(XN,GetHandleId(bj_lastCreatedButton),0,3)
call DialogAddButtonBJ(NX[Y],"|cffff0000红宝石|r")
call SaveInteger(XN,GetHandleId(bj_lastCreatedButton),0,4)
call DialogAddButtonBJ(NX[Y],"取消")
call SaveInteger(XN,GetHandleId(bj_lastCreatedButton),0,0)
set OX[Y]=1
call DialogDisplayBJ(true,NX[Y],YV)
endif
endfunction
function I8 takes nothing returns boolean
return(XX[Y]==3)
endfunction
function A8 takes nothing returns boolean
return(XX[Y]==2)
endfunction
function N8 takes nothing returns boolean
return(XX[Y]==1)
endfunction
function B8 takes nothing returns boolean
return(XX[Y]==3)
endfunction
function C8 takes nothing returns boolean
return(XX[Y]==2)
endfunction
function D8 takes nothing returns boolean
return(XX[Y]==1)
endfunction
function F8 takes nothing returns boolean
return(VV>0)
endfunction
function G8 takes nothing returns boolean
return(OX[Y]==2)
endfunction
function H8 takes nothing returns boolean
return(VV>0)
endfunction
function J8 takes nothing returns boolean
return(VV==4)and(EX[Y]<=CV[Y])
endfunction
function K8 takes nothing returns boolean
return(VV==3)and(EX[Y]<=NV[Y])
endfunction
function L8 takes nothing returns boolean
return(VV==2)and(EX[Y]<=BV[Y])
endfunction
function M8 takes nothing returns boolean
return(VV==1)and(EX[Y]<=AV[Y])
endfunction
function P8 takes nothing returns boolean
return(AR[JE]!=true)and(IsPlayerInForce(Player(-1+(JE)),XE))and(YV!=Player(-1+(JE)))
endfunction
function Q8 takes nothing returns boolean
return(OX[Y]==1)
endfunction
function S8 takes nothing returns nothing
set YV=GetTriggerPlayer()
set Y=(1+GetPlayerId(YV))
set RX=GetClickedButton()
set VV=LoadInteger(XN,GetHandleId(RX),0)
call DialogClear(NX[Y])
if(Q8())then
if(M8())then
set XX[Y]=VV
set AV[Y]=(AV[Y]-EX[Y])
else
if(L8())then
set XX[Y]=VV
set BV[Y]=(BV[Y]-EX[Y])
else
if(K8())then
set XX[Y]=VV
set NV[Y]=(NV[Y]-EX[Y])
else
if(J8())then
set XX[Y]=VV
set CV[Y]=(CV[Y]-EX[Y])
else
if(H8())then
call IS(YV,"没有足够的矿石!")
endif
return
endif
endif
endif
endif
set JE=1
loop
exitwhen JE>$C
if(P8())then
call DialogAddButtonBJ(NX[Y],(VX[JE]+(I2S(JE)+(": "+(GetPlayerName(Player(-1+(JE)))+"|r")))))
call SaveInteger(XN,GetHandleId(bj_lastCreatedButton),0,JE)
endif
set JE=JE+1
endloop
call DialogAddButtonBJ(NX[Y],"取消")
call SaveInteger(XN,GetHandleId(bj_lastCreatedButton),0,0)
call DialogSetMessage(NX[Y],"选择玩家")
call DialogDisplayBJ(true,NX[Y],YV)
set OX[Y]=2
call QS()
else
if(G8())then
if(F8())then
set Z=VV
set IX=Player(-1+(Z))
if(D8())then
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,((VX[Y]+(GetPlayerName(YV)+"|r"))+(" 给予 "+((VX[Z]+(GetPlayerName(IX)+"|r"))+(" "+(I2S(EX[Y])+" |cff0000ff蓝宝石|r!"))))))
set AV[Z]=(AV[Z]+EX[Y])
else
if(C8())then
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,((VX[Y]+(GetPlayerName(YV)+"|r"))+(" 给予 "+((VX[Z]+(GetPlayerName(IX)+"|r"))+(" "+(I2S(EX[Y])+" |cff99b4d1钻石|r!"))))))
set BV[Z]=(BV[Z]+EX[Y])
else
if(B8())then
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,((VX[Y]+(GetPlayerName(YV)+"|r"))+(" 给予 "+((VX[Z]+(GetPlayerName(IX)+"|r"))+(" "+(I2S(EX[Y])+" |cffadff2f绿宝石|r!"))))))
set NV[Z]=(NV[Z]+EX[Y])
else
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,((VX[Y]+(GetPlayerName(YV)+"|r"))+(" 给予 "+((VX[Z]+(GetPlayerName(IX)+"|r"))+(" "+(I2S(EX[Y])+" |cffff0000红宝石|r!"))))))
set CV[Z]=(CV[Z]+EX[Y])
endif
endif
endif
else
if(N8())then
set AV[Y]=(AV[Y]+EX[Y])
else
if(A8())then
set BV[Y]=(BV[Y]+EX[Y])
else
if(I8())then
set NV[Y]=(NV[Y]+EX[Y])
else
set CV[Y]=(CV[Y]+EX[Y])
endif
endif
endif
endif
call QS()
else
if OX[Y]==3 then
if VV==1 then
set UR=(UR+1)
set TR=(TR+1)
else
if VV==2 then
set UR=(UR+1)
set TR=(TR+2)
else
if VV==3 then
set UR=(UR+1)
set TR=(TR+3)
else
if VV==4 then
set UR=(UR+1)
set TR=(TR+4)
else
set UR=(UR+1)
set TR=(TR+5)
endif
endif
endif
endif
endif
endif
endif
call ResetToGameCameraForPlayer(YV,.0)
endfunction
function U8 takes nothing returns nothing
local integer i=1
call ExecuteFunc("W8")
call InitHashtableBJ()
set ZX=GetLastCreatedHashtableBJ()
loop
exitwhen EO[i]==0
call SaveTriggerHandle(ZX,EO[i],0,VO[i])
set i=i+1
endloop
endfunction
function Y8 takes nothing returns boolean
local trigger t=LoadTriggerHandle(ZX,GetSpellAbilityId(),0)
if TriggerEvaluate(t)then
call TriggerExecute(t)
endif
set t=null
return false
endfunction
function W8 takes nothing returns nothing
local trigger t=CreateTrigger()
call TriggerRegisterAnyUnitEventBJ(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function Y8))
set t=null
endfunction
function VVV takes nothing returns boolean
return(GetUnitManaPercent(XV)<=1.)or(IsUnitDeadBJ(XV))or(IsUnitDeadBJ(EV))or(DistanceBetweenPoints(RV,IV)>(I2R(GetUnitPointValue(XV))+256.))
endfunction
function VEV takes nothing returns boolean
return(VVV())
endfunction
function Trig_Mind_Control_Func001Func007Func007001003001001 takes nothing returns boolean
return(IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)!=true)!=null
endfunction
function Trig_Mind_Control_Func001Func007Func007001003001002 takes nothing returns boolean
return(IsUnitAliveBJ(GetFilterUnit()))
endfunction
function Trig_Mind_Control_Func001Func007Func007001003001 takes nothing returns boolean
return(GetBooleanAnd((IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)!=true),(IsUnitAliveBJ(GetFilterUnit()))))!=null
endfunction
function Trig_Mind_Control_Func001Func007Func007001003002001 takes nothing returns boolean
return(IsUnitType(GetFilterUnit(),UNIT_TYPE_UNDEAD)!=true)!=null
endfunction
function Trig_Mind_Control_Func001Func007Func007001003002002 takes nothing returns boolean
return(IsPlayerEnemy(YV,GetOwningPlayer(GetFilterUnit())))
endfunction
function Trig_Mind_Control_Func001Func007Func007001003002 takes nothing returns boolean
return(GetBooleanAnd((IsUnitType(GetFilterUnit(),UNIT_TYPE_UNDEAD)!=true),(IsPlayerEnemy(YV,GetOwningPlayer(GetFilterUnit())))))!=null
endfunction
function VXV takes nothing returns boolean
return(GetBooleanAnd((GetBooleanAnd((IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)!=true),(IsUnitAliveBJ(GetFilterUnit())))),(GetBooleanAnd((IsUnitType(GetFilterUnit(),UNIT_TYPE_UNDEAD)!=true),(IsPlayerEnemy(YV,GetOwningPlayer(GetFilterUnit())))))))!=null
endfunction
function VOV takes nothing returns boolean
return(T>.0)
endfunction
function VRV takes nothing returns boolean
return(IsUnitVisible(XV,YV))and(GetUnitManaPercent(EV)==100.)and(IO[VV]<Y)
endfunction
function VIV takes nothing returns nothing
set XV=GetEnumUnit()
if(VRV())then
set IO[VV]=(IO[VV]+1)
set IX=GetOwningPlayer(XV)
set Z=GetHandleId(XV)
call SaveUnitHandle(OO,Z,0,EV)
call SavePlayerHandle(OO,Z,1,IX)
call SetUnitOwner(XV,YV,false)
call AddSpecialEffectTargetUnitBJ("head",XV,"Abilities\\Spells\\Human\\ControlMagic\\ControlMagicTarget.mdl")
call DestroyEffect(bj_lastCreatedEffect)
set T=GetUnitFlyHeight(XV)
if(VOV())then
else
set T=50.
endif
set bj_lastCreatedLightning=AddLightningEx("LEAS",true,GetUnitX(EV),GetUnitY(EV),$C8,GetUnitX(XV),GetUnitY(XV),T)
call HS(bj_lastCreatedLightning,EV,XV,2,$C8,T,1,1)
call SetUnitManaBJ(EV,(GetUnitManaPercent(EV)-50.))
call GroupAddUnit(RO,XV)
call IssueImmediateOrderById(XV,$D0019)
endif
endfunction
function VAV takes nothing returns boolean
return(Y>0)
endfunction
function VNV takes nothing returns nothing
set EV=GetEnumUnit()
set DV=GetUnitTypeId(EV)
set Y=LoadInteger(OO,DV,0)
set RV=GetUnitLoc(EV)
set YV=GetOwningPlayer(EV)
set VV=GetUnitUserData(EV)
if(VAV())then
set bj_wantDestroyGroup=true
call ForGroupBJ(LM(I2R(GetUnitPointValue(EV)),RV,Condition(function VXV)),function VIV)
else
set Z=GetHandleId(EV)
set XV=LoadUnitHandle(OO,Z,0)
set IV=GetUnitLoc(XV)
if(VEV())then
set IX=LoadPlayerHandle(OO,Z,1)
call SetUnitOwner(EV,IX,false)
call AddSpecialEffectTargetUnitBJ("origin",EV,"Abilities\\Spells\\Human\\DispelMagic\\DispelMagicTarget.mdl")
call DestroyEffect(bj_lastCreatedEffect)
call GroupRemoveUnit(RO,EV)
set JE=GetUnitUserData(XV)
set IO[JE]=(IO[JE]-1)
else
call SetUnitManaBJ(XV,(GetUnitStateSwap(UNIT_STATE_MANA,XV)-5.))
endif
call RemoveLocation(IV)
endif
call RemoveLocation(RV)
endfunction
function VBV takes nothing returns boolean
return(IsUnitGroupEmptyBJ(RO))
endfunction
function VCV takes nothing returns nothing
call ForGroupBJ(RO,function VNV)
if(VBV())then
call DisableTrigger(GetTriggeringTrigger())
endif
endfunction
function VFV takes nothing returns nothing
set EV=GetEnumUnit()
set Y=GetUnitUserData(EV)
if GetUnitState(EV,UNIT_STATE_MANA)/ GetUnitState(EV,UNIT_STATE_MAX_MANA)>=.9 then
call WaygateActivate(EV,true)
call AddUnitAnimationPropertiesBJ(true,"alternate",EV)
if GetUnitState(BI[Y],UNIT_STATE_MANA)/ GetUnitState(BI[Y],UNIT_STATE_MAX_MANA)<.9 or GetUnitState(BI[Y],UNIT_STATE_LIFE)<=0 then
set RV=GetUnitLoc(EV)
call WaygateSetDestinationLocBJ(EV,RV)
call RemoveLocation(RV)
endif
else
call WaygateActivate(EV,false)
call AddUnitAnimationPropertiesBJ(false,"alternate",EV)
endif
endfunction
function VGV takes nothing returns nothing
call ForGroupBJ(YX,function VFV)
if IsUnitGroupEmptyBJ(YX)then
call DisableTrigger(GetTriggeringTrigger())
endif
endfunction
function Trig_Transfer_Periodic_Func001Func012001003001001 takes nothing returns boolean
return(IsPlayerAlly(YV,GetOwningPlayer(GetFilterUnit())))
endfunction
function Trig_Transfer_Periodic_Func001Func012001003001002 takes nothing returns boolean
return(GetOwningPlayer(GetFilterUnit())!=Player($C))
endfunction
function Trig_Transfer_Periodic_Func001Func012001003001 takes nothing returns boolean
return GetBooleanAnd((IsPlayerAlly(YV,GetOwningPlayer(GetFilterUnit()))),(GetOwningPlayer(GetFilterUnit())!=Player($C)))
endfunction
function Trig_Transfer_Periodic_Func001Func012001003002001 takes nothing returns boolean
return(IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE))!=null
endfunction
function Trig_Transfer_Periodic_Func001Func012001003002002001 takes nothing returns boolean
return(IsUnitAliveBJ(GetFilterUnit()))
endfunction
function Trig_Transfer_Periodic_Func001Func012001003002002002001 takes nothing returns boolean
return(ZE[GetUnitUserData(GetFilterUnit())]==false)
endfunction
function Trig_Transfer_Periodic_Func001Func012001003002002002002 takes nothing returns boolean
return(GetUnitLifePercent(GetFilterUnit())<100.)
endfunction
function Trig_Transfer_Periodic_Func001Func012001003002002002 takes nothing returns boolean
return GetBooleanAnd((ZE[GetUnitUserData(GetFilterUnit())]==false),(GetUnitLifePercent(GetFilterUnit())<100.))
endfunction
function Trig_Transfer_Periodic_Func001Func012001003002002 takes nothing returns boolean
return GetBooleanAnd((IsUnitAliveBJ(GetFilterUnit())),(GetBooleanAnd((ZE[GetUnitUserData(GetFilterUnit())]==false),(GetUnitLifePercent(GetFilterUnit())<100.))))
endfunction
function Trig_Transfer_Periodic_Func001Func012001003002 takes nothing returns boolean
return(GetBooleanAnd((IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)),(GetBooleanAnd((IsUnitAliveBJ(GetFilterUnit())),(GetBooleanAnd((ZE[GetUnitUserData(GetFilterUnit())]==false),(GetUnitLifePercent(GetFilterUnit())<100.)))))))!=null
endfunction
function VJV takes nothing returns boolean
return(GetBooleanAnd((GetBooleanAnd((IsPlayerAlly(YV,GetOwningPlayer(GetFilterUnit()))),(GetOwningPlayer(GetFilterUnit())!=Player($C)))),(GetBooleanAnd((IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)),(GetBooleanAnd((IsUnitAliveBJ(GetFilterUnit())),(GetBooleanAnd((ZE[GetUnitUserData(GetFilterUnit())]==false),(GetUnitLifePercent(GetFilterUnit())<100.)))))))))!=null
endfunction
function VKV takes nothing returns nothing
local unit VLV=GetEnumUnit()
local real r=GetUnitState(VLV,UNIT_STATE_LIFE)
local real rr=GetUnitState(VLV,UNIT_STATE_MAX_LIFE)
set WR=W
set VLV=GetEnumUnit()
if IsUnitVisible(VLV,YV)and r<rr then
if r+WR>rr then
set WR=rr-r
endif
if WR>0 then
call SetUnitManaBJ(EV,(GetUnitStateSwap(UNIT_STATE_MANA,EV)-WR))
call SetUnitState(VLV,UNIT_STATE_LIFE,r+WR)
set bj_lastCreatedLightning=AddLightningEx("SPLK",true,GetUnitX(EV),GetUnitY(EV),'d',GetUnitX(VLV),GetUnitY(VLV),'d')
call HS(bj_lastCreatedLightning,EV,VLV,1,'d','d',1,1)
endif
endif
endfunction
function Trig_Transfer_Periodic_Func001Func015001003001 takes nothing returns boolean
return(IsPlayerAlly(GetOwningPlayer(EV),GetOwningPlayer(GetFilterUnit())))
endfunction
function Trig_Transfer_Periodic_Func001Func015001003002001 takes nothing returns boolean
return(IsUnitAliveBJ(GetFilterUnit()))
endfunction
function Trig_Transfer_Periodic_Func001Func015001003002002001 takes nothing returns boolean
return(GetUnitManaPercent(GetFilterUnit())<100.)
endfunction
function Trig_Transfer_Periodic_Func001Func015001003002002002001 takes nothing returns boolean
return(ZE[GetUnitUserData(GetFilterUnit())]!=true)
endfunction
function Trig_Transfer_Periodic_Func001Func015001003002002002002 takes nothing returns boolean
return(IsUnitType(GetFilterUnit(),UNIT_TYPE_MECHANICAL))!=null
endfunction
function Trig_Transfer_Periodic_Func001Func015001003002002002 takes nothing returns boolean
return(GetBooleanAnd((ZE[GetUnitUserData(GetFilterUnit())]!=true),(IsUnitType(GetFilterUnit(),UNIT_TYPE_MECHANICAL))))!=null
endfunction
function Trig_Transfer_Periodic_Func001Func015001003002002 takes nothing returns boolean
return(GetBooleanAnd((GetUnitManaPercent(GetFilterUnit())<100.),(GetBooleanAnd((ZE[GetUnitUserData(GetFilterUnit())]!=true),(IsUnitType(GetFilterUnit(),UNIT_TYPE_MECHANICAL))))))!=null
endfunction
function Trig_Transfer_Periodic_Func001Func015001003002 takes nothing returns boolean
return(GetBooleanAnd((IsUnitAliveBJ(GetFilterUnit())),(GetBooleanAnd((GetUnitManaPercent(GetFilterUnit())<100.),(GetBooleanAnd((ZE[GetUnitUserData(GetFilterUnit())]!=true),(IsUnitType(GetFilterUnit(),UNIT_TYPE_MECHANICAL))))))))!=null
endfunction
function VMV takes nothing returns boolean
return(GetBooleanAnd((IsPlayerAlly(GetOwningPlayer(EV),GetOwningPlayer(GetFilterUnit()))),(GetBooleanAnd((IsUnitAliveBJ(GetFilterUnit())),(GetBooleanAnd((GetUnitManaPercent(GetFilterUnit())<100.),(GetBooleanAnd((ZE[GetUnitUserData(GetFilterUnit())]!=true),(IsUnitType(GetFilterUnit(),UNIT_TYPE_MECHANICAL))))))))))!=null
endfunction
function VPV takes nothing returns nothing
local unit VLV=GetEnumUnit()
local real r=GetUnitState(VLV,UNIT_STATE_MANA)
local real rr=GetUnitState(VLV,UNIT_STATE_MAX_MANA)
set WR=W
if IsUnitVisible(VLV,YV)and r<rr then
if r+WR>rr then
set WR=rr-r
endif
if WR>0 then
call SetUnitManaBJ(EV,(GetUnitStateSwap(UNIT_STATE_MANA,EV)-WR))
call SetUnitState(VLV,UNIT_STATE_MANA,r+WR)
set bj_lastCreatedLightning=AddLightningEx("AFOD",true,GetUnitX(EV),GetUnitY(EV),'d',GetUnitX(VLV),GetUnitY(VLV),'d')
call HS(bj_lastCreatedLightning,EV,VLV,1,'d','d',1,1)
endif
endif
endfunction
function VQV takes nothing returns nothing
set EV=GetEnumUnit()
set DV=GetUnitTypeId(EV)
set Y=LoadInteger(YE,DV,0)
set T=LoadReal(YE,DV,1)
set Z=GetUnitUserData(EV)
set W=I2R(Y)
set RV=GetUnitLoc(EV)
set YV=GetOwningPlayer(EV)
if ZE[Z]!=true and GetUnitState(EV,UNIT_STATE_MANA)>=W then
if IsUnitType(EV,UNIT_TYPE_MECHANICAL)then
set bj_wantDestroyGroup=true
call ForGroupBJ(LM(T,RV,Condition(function VJV)),function VKV)
else
set bj_wantDestroyGroup=true
call ForGroupBJ(LM(T,RV,Condition(function VMV)),function VPV)
endif
endif
call RemoveLocation(RV)
endfunction
function VSV takes nothing returns nothing
call ForGroupBJ(WE,function VQV)
if IsUnitGroupEmptyBJ(WE)then
call DisableTrigger(GetTriggeringTrigger())
endif
endfunction
function VUV takes nothing returns nothing
set EV=GetEnumUnit()
set Y=GetUnitUserData(EV)
if ZE[Y]!=true and GetUnitState(EV,UNIT_STATE_MAX_MANA)>=GetUnitState(EV,UNIT_STATE_MANA)then
set YV=GetOwningPlayer(EV)
set Z=(1+GetPlayerId(YV))
set VV=GetUnitPointValue(EV)
set DV=GetUnitTypeId(EV)
set JE=LoadInteger(QX,DV,1)
call SetUnitManaPercentBJ(EV,.0)
call TriggerExecute(FV[JE])
endif
endfunction
function VWV takes nothing returns nothing
call ForGroupBJ(TX,function VUV)
if IsUnitGroupEmptyBJ(TX)then
call DisableTrigger(GetTriggeringTrigger())
endif
endfunction
function VZV takes nothing returns nothing
set EV=GetEnumUnit()
set Y=GetUnitUserData(EV)
if GetUnitState(EV,UNIT_STATE_MANA)/ GetUnitState(EV,UNIT_STATE_MAX_MANA)>=.5 then
if GO[Y]==false then
set DV=GetUnitTypeId(EV)
set GO[Y]=true
set RV=GetUnitLoc(EV)
call CreateFogModifierRadiusLocBJ(true,GetOwningPlayer(EV),FOG_OF_WAR_VISIBLE,RV,I2R(GetUnitPointValue(EV)))
set FO[Y]=bj_lastCreatedFogModifier
set P=LoadInteger(DO,DV,1)
call CreateDestructableLoc(P,RV,GetRandomReal(0,360),1,0)
set HO[Y]=bj_lastCreatedDestructable
call RemoveLocation(RV)
endif
else
set GO[Y]=false
call DestroyFogModifier(FO[Y])
call RemoveDestructable(HO[Y])
endif
endfunction
function V_V takes nothing returns nothing
call ForGroupBJ(CO,function VZV)
if IsUnitGroupEmptyBJ(CO)then
call DisableTrigger(GetTriggeringTrigger())
endif
endfunction
function Trig_Sentries_Func002Func006001003001 takes nothing returns boolean
return(IsPlayerEnemy(YV,GetOwningPlayer(GetFilterUnit())))
endfunction
function Trig_Sentries_Func002Func006001003002001 takes nothing returns boolean
return(IsUnitAliveBJ(GetFilterUnit()))
endfunction
function Trig_Sentries_Func002Func006001003002002 takes nothing returns boolean
return(IsUnitInGroup(GetFilterUnit(),PI)!=true)
endfunction
function Trig_Sentries_Func002Func006001003002 takes nothing returns boolean
return GetBooleanAnd((IsUnitAliveBJ(GetFilterUnit())),(IsUnitInGroup(GetFilterUnit(),PI)!=true))
endfunction
function V1V takes nothing returns boolean
return GetBooleanAnd((IsPlayerEnemy(YV,GetOwningPlayer(GetFilterUnit()))),(GetBooleanAnd((IsUnitAliveBJ(GetFilterUnit())),(IsUnitInGroup(GetFilterUnit(),PI)!=true))))
endfunction
function V2V takes nothing returns boolean
return(IsUnitVisible(XV,YV)!=true)
endfunction
function V3V takes nothing returns nothing
set XV=GetEnumUnit()
if(V2V())then
set IV=GetUnitLoc(XV)
call GroupAddUnit(PI,XV)
call PS('B01B',GetUnitX(XV),GetUnitY(XV),'d',270,2,5)
call PingMinimapLocForForceEx(XE,IV,2.,0,'d',.0,.0)
call RemoveLocation(IV)
endif
endfunction
function V4V takes nothing returns nothing
set EV=GetEnumUnit()
if GetUnitState(EV,UNIT_STATE_MANA)/ GetUnitState(EV,UNIT_STATE_MAX_MANA)>=.5 then
set RV=GetUnitLoc(EV)
set YV=GetOwningPlayer(EV)
set bj_wantDestroyGroup=true
call ForGroupBJ(LM(I2R(GetUnitPointValue(EV)),RV,Condition(function V1V)),function V3V)
call RemoveLocation(RV)
endif
if IsUnitGroupEmptyBJ(CI)then
call DisableTrigger(GetTriggeringTrigger())
endif
endfunction
function V5V takes nothing returns nothing
set PI=CreateGroup()
call ForGroupBJ(CI,function V4V)
call DestroyGroup(PI)
endfunction
function V7V takes nothing returns nothing
set YV=GetTriggerPlayer()
set Y=(1+GetPlayerId(YV))
set EV=GetTriggerUnit()
if IsUnitInGroup(EV,EI)and AR[Y]!=true then
call SetUnitOwner(EV,YV,true)
call UnitAddIndicatorBJ(EV,'d','d','d',0)
call GroupRemoveUnit(EI,EV)
endif
endfunction
function V9V takes nothing returns boolean
return(FA==.0)
endfunction
function EVV takes nothing returns boolean
return(KA)
endfunction
function EEV takes nothing returns boolean
return(CA==1)
endfunction
function EXV takes nothing returns boolean
return(GetUnitStateSwap(UNIT_STATE_MAX_LIFE,HA)<QA)
endfunction
function EOV takes nothing returns boolean
return(FA>JA)
endfunction
function ERV takes nothing returns boolean
return(FA!=JA)
endfunction
function EIV takes nothing returns boolean
return(PA==.0)
endfunction
function EAV takes nothing returns boolean
return(YA[HV])
endfunction
function ENV takes nothing returns boolean
return(ZA==$F)
endfunction
function EBV takes nothing returns boolean
return(YA[HV])
endfunction
function ECV takes nothing returns boolean
return(KV==1.)
endfunction
function EDV takes nothing returns nothing
set IA='A01F'
set AA=1
set NA=2
set BA=3
call ExecuteFunc("EFV")
endfunction
function EGV takes nothing returns boolean
return true
return false
endfunction
function EHV takes nothing returns nothing
local real r
loop
set CA=(CA-1)
set r=GetWidgetLife(DA[CA])
call UnitRemoveAbility(DA[CA],IA)
call SetWidgetLife(DA[CA],r)
set DA[CA]=null
exitwhen CA==0
endloop
endfunction
function EJV takes nothing returns nothing
set FA=GetEventDamage()
set GA=GetEventDamageSource()
set HA=GetTriggerUnit()
endfunction
function EKV takes nothing returns nothing
local boolean b=GetUnitAbilityLevel(HA,IA)>0
local real LT=0
local real ELV=0
if b then
set LT=GetWidgetLife(HA)
call UnitRemoveAbility(HA,IA)
call SetWidgetLife(HA,LT)
set ELV=GetWidgetLife(HA)
endif
set JA=FA
set KA=false
set LA=false
if(V9V())then
set PA=2.
else
set MA=1.
set PA=1.
endif
if b then
call UnitAddAbility(HA,IA)
call SetWidgetLife(HA,LT+GetWidgetLife(HA)-ELV)
endif
if(ERV())then
set QA=(GetUnitStateSwap(UNIT_STATE_LIFE,HA)+(JA-FA))
if(EOV())then
call SetWidgetLife(HA,RMaxBJ(.41,QA))
if QA<=.405 then
if(EVV())then
call SetUnitExploded(HA,true)
endif
call DisableTrigger(SA)
call UnitDamageTarget(GA,HA,999,false,false,null,null,null)
call EnableTrigger(SA)
endif
else
if(EXV())then
call UnitAddAbility(HA,IA)
set DA[CA]=HA
set CA=(CA+1)
if(EEV())then
call TimerStart(VN,0,false,function EHV)
endif
endif
call SetWidgetLife(HA,QA)
endif
endif
endfunction
function EMV takes nothing returns nothing
local real d=FA
local unit s=GA
local unit t=HA
local integer EPV=TA
local boolean EQV=KA
local boolean ESV=LA
local real ETV=JA
call EJV()
if HA!=t or GA!=s or FA!=d or UA!=EPV then
set PA=.0
set MA=.0
call EKV()
else
call ClearTextMessagesBJ(bj_FORCE_ALL_PLAYERS)
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,999.,"TRIGSTR_2128")
endif
set LA=ESV
set KA=EQV
set JA=ETV
set TA=EPV
set FA=d
set GA=s
set HA=t
set s=null
set t=null
endfunction
function EUV takes nothing returns boolean
if(EIV())then
set TA=UA
call EJV()
call EKV()
set MA=.0
set PA=.0
set UA=0
else
call EMV()
endif
return false
endfunction
function EWV takes nothing returns nothing
set SA=CreateTrigger()
call TriggerAddCondition(SA,Filter(function EUV))
endfunction
function EYV takes nothing returns boolean
local integer S7=HV
if(ECV())then
set WA=JV[HV]
if GetUnitAbilityLevel(WA,'Aloc')==0 and EGV()then
set YA[HV]=true
call TriggerRegisterUnitEvent(SA,WA,EVENT_UNIT_DAMAGED)
endif
else
if(EBV())then
set YA[HV]=false
set ZA=(ZA+1)
if(ENV())then
set ZA=0
call DestroyTrigger(SA)
call EWV()
set HV=GX[0]
loop
exitwhen HV==0
if(EAV())then
call TriggerRegisterUnitEvent(SA,JV[HV],EVENT_UNIT_DAMAGED)
endif
set HV=GX[HV]
endloop
set HV=S7
endif
endif
endif
return false
endfunction
function EFV takes nothing returns nothing
call EWV()
call TriggerAddCondition(GetTriggeringTrigger(),Filter(function EYV))
set CX=false
set WA=CreateUnit(Player($F),'uloc',0,0,0)
set CX=true
call UnitAddAbility(WA,IA)
call RemoveUnit(WA)
call StartTimerBJ(VN,false,.0)
call ConditionalTriggerExecute(GetTriggeringTrigger())
endfunction
function E_V takes nothing returns boolean
return(ZN[HV]!=null)
endfunction
function E0V takes nothing returns boolean
return(KV==1.)
endfunction
function E1V takes nothing returns boolean
return(RB[0]==0)
endfunction
function E2V takes nothing returns boolean
return(XB[HV])
endfunction
function E3V takes nothing returns boolean
return(ZN[HV]!=null)
endfunction
function E4V takes nothing returns boolean
return(HV!=0)
endfunction
function E5V takes nothing returns boolean
return(UN[HV])
endfunction
function E6V takes nothing returns boolean
return(VB[HV])
endfunction
function E7V takes nothing returns boolean
return(CB[0]==0)
endfunction
function E8V takes nothing returns boolean
return(YN[HV]==false)
endfunction
function E9V takes nothing returns boolean
return((XB[HV])and(IsUnitType(JV[HV],UNIT_TYPE_HERO)))!=null
endfunction
function XVV takes nothing returns boolean
return(VB[HV])
endfunction
function XEV takes nothing returns boolean
return(UN[HV]==false)
endfunction
function XXV takes nothing returns boolean
return(GetUnitAbilityLevelSwapped(TN,JV[HV])==0)
endfunction
function XOV takes nothing returns boolean
return(HV!=0)
endfunction
function XRV takes nothing returns boolean
return(IsUnitLoaded(JV[HV])==false)
endfunction
function XIV takes nothing returns boolean
return(RB[0]==0)
endfunction
function XAV takes nothing returns boolean
return(ZN[HV]!=null)
endfunction
function XNV takes nothing returns boolean
return(UN[HV]==false)
endfunction
function XBV takes nothing returns boolean
return(HV!=0)
endfunction
function XCV takes nothing returns boolean
return(IsUnitPaused(JV[HV]))and(ZN[HV]!=null)and(XB[HV]==false)
endfunction
function XDV takes nothing returns nothing
if TN==0 then
set TN='A01S'
call ExecuteFunc("XFV")
endif
if(E0V())then
call UnitAddAbility(JV[HV],TN)
call UnitMakeAbilityPermanent(JV[HV],true,TN)
set VB[HV]=true
set UN[HV]=true
call ExecuteFunc("XGV")
else
set UN[HV]=false
set WN[HV]=false
set YN[HV]=false
if(E_V())then
call ExecuteFunc("XHV")
endif
if EB[HV]!=null then
call DestroyGroup(EB[HV])
set EB[HV]=null
endif
endif
endfunction
function XHV takes nothing returns nothing
call GroupRemoveUnit(EB[GetUnitUserData(ZN[HV])],JV[HV])
if(E2V())then
set XB[HV]=false
set RB[OB[HV]]=RB[HV]
set OB[RB[HV]]=OB[HV]
set OB[HV]=0
if(E1V())then
call PauseTimerBJ(true,IB)
endif
endif
set AB[HV]=true
set NB=.0
set NB=2.
set NB=.0
set AB[HV]=false
if not IsUnitLoaded(JV[HV])or IsUnitType(ZN[HV],UNIT_TYPE_DEAD)or GetUnitTypeId(ZN[HV])==0 then
set ZN[HV]=null
endif
endfunction
function XJV takes nothing returns boolean
local integer S7=HV
set HV=GetUnitUserData(GetTriggerUnit())
if(E4V())then
set UN[HV]=false
set BB=.0
set BB=1.
set BB=.0
if(E3V())then
call XHV()
endif
endif
set HV=S7
return false
endfunction
function XKV takes nothing returns nothing
set HV=CB[0]
set CB[0]=0
loop
exitwhen HV==0
if(E6V())then
set VB[HV]=false
else
if(E5V())then
set UN[HV]=false
set WN[HV]=true
set BB=.5
set BB=.0
endif
endif
set HV=CB[HV]
endloop
endfunction
function XGV takes nothing returns nothing
if(E7V())then
call TimerStart(DB,0,false,function XKV)
endif
set CB[HV]=CB[0]
set CB[0]=HV
endfunction
function XLV takes nothing returns boolean
local integer S7=HV
set HV=GetUnitUserData(GetFilterUnit())
if(XOV())then
if(XXV())then
if(E8V())then
set YN[HV]=true
set BB=.0
set BB=3.
set BB=.0
endif
else
if(XEV())then
set UN[HV]=true
set BB=.0
set BB=2.
set BB=.0
set WN[HV]=false
else
if IsUnitType(JV[HV],UNIT_TYPE_DEAD)then
if(XVV())then
set UN[HV]=false
set BB=.0
set BB=1.
set BB=.0
else
if(E9V())then
else
call XGV()
endif
endif
endif
endif
endif
if ZN[HV]!=null and not AB[HV]and not IsUnitLoaded(JV[HV])or IsUnitType(JV[HV],UNIT_TYPE_DEAD)then
call XHV()
endif
endif
set HV=S7
return false
endfunction
function XMV takes nothing returns nothing
set HV=RB[0]
loop
exitwhen HV==0
if(XRV())then
call XHV()
endif
set HV=RB[HV]
endloop
endfunction
function XPV takes nothing returns nothing
if(XIV())then
call TimerStart(IB,.03125,true,function XMV)
endif
set XB[HV]=true
set OB[RB[0]]=HV
set RB[HV]=RB[0]
set RB[0]=HV
endfunction
function XQV takes nothing returns boolean
local integer S7=HV
local integer XSV
set HV=GetUnitUserData(GetTriggerUnit())
if(XBV())then
if(XAV())then
call XHV()
endif
if(XNV())then
call XPV()
endif
set ZN[HV]=GetTransportUnit()
set XSV=GetUnitUserData(ZN[HV])
if EB[XSV]==null then
set EB[XSV]=CreateGroup()
endif
call GroupAddUnit(EB[XSV],JV[HV])
set NB=.0
set NB=1.
set NB=.0
endif
set HV=S7
return false
endfunction
function XTV takes nothing returns boolean
local integer S7=HV
set HV=GetUnitUserData(GetFilterUnit())
if(XCV())then
call XPV()
endif
set HV=S7
return false
endfunction
function XFV takes nothing returns nothing
local integer i=$F
local player p
local trigger d=CreateTrigger()
local trigger l=CreateTrigger()
local trigger t=GetTriggeringTrigger()
local boolexpr o=Filter(function XLV)
local boolexpr u=Filter(function XTV)
call TriggerAddCondition(d,Filter(function XJV))
call TriggerAddCondition(l,Filter(function XQV))
loop
set p=Player(i)
call SetPlayerAbilityAvailable(p,TN,false)
call TriggerRegisterPlayerUnitEvent(t,p,EVENT_PLAYER_UNIT_ISSUED_ORDER,o)
call TriggerRegisterPlayerUnitEvent(t,p,EVENT_PLAYER_UNIT_ISSUED_POINT_ORDER,u)
call TriggerRegisterPlayerUnitEvent(d,p,EVENT_PLAYER_UNIT_DEATH,null)
call TriggerRegisterPlayerUnitEvent(l,p,EVENT_PLAYER_UNIT_LOADED,null)
exitwhen i==0
set i=i-1
endloop
set d=null
set l=null
set o=null
set p=null
set t=null
set u=null
call DestroyGroup(EB[0])
set EB[0]=null
endfunction
function XWV takes nothing returns nothing
call KillUnit(GetEnumUnit())
endfunction
function XYV takes nothing returns nothing
call RemoveDestructable(GetEnumDestructable())
endfunction
function XZV takes nothing returns nothing
set EV=GetTriggerUnit()
set RV=GetUnitLoc(EV)
set bj_wantDestroyGroup=true
call ForGroupBJ(PM(1.,RV),function XWV)
call NM(128.,RV,function XYV)
call RemoveLocation(RV)
endfunction
function X0V takes nothing returns boolean
return(DV=='h006')or(DV=='h019')or(DV=='h025')or(DV=='h00W')or(DV=='h024')
endfunction
function X1V takes nothing returns boolean
return(X0V())
endfunction
function X2V takes nothing returns nothing
set EV=GetTriggerUnit()
set RV=GetUnitLoc(EV)
set DV=GetUnitTypeId(EV)
set YV=GetTriggerPlayer()
if(X1V())then
call SetPlayerTechMaxAllowedSwap('h006',1,YV)
endif
set KE=(1+GetPlayerId(YV))
set SV=false
if LoadInteger(YE,DV,5)>0 and GetPlayerTechCount(YV,'R00U',true)==1 then
set SV=true
endif
call CU(EV)
call RemoveUnit(EV)
if DV=='h017' then
set DV=JO[GetUnitUserData(EV)]
endif
set Y=LoadInteger(XN,DV,0)
set Z=LoadInteger(XN,DV,1)
set VV=LoadInteger(XN,DV,2)
set JE=LoadInteger(XN,DV,3)
set ME=LoadInteger(XN,DV,4)
loop
set SX=LoadInteger(XO,DV,0)
set DV=SX
exitwhen SX==null
set Y=(Y+LoadInteger(XN,SX,0))
set Z=(Z+LoadInteger(XN,SX,1))
set VV=(VV+LoadInteger(XN,SX,2))
set JE=(JE+LoadInteger(XN,SX,3))
set ME=(ME+LoadInteger(XN,SX,4))
endloop
if SV then
set Y=Y/ 2
endif
set AV[KE]=(AV[KE]+Y)
set BV[KE]=(BV[KE]+Z)
set NV[KE]=(NV[KE]+VV)
set CV[KE]=(CV[KE]+JE)
call AdjustPlayerStateBJ(ME,YV,PLAYER_STATE_RESOURCE_GOLD)
call AddSpecialEffectLocBJ(RV,"Abilities\\Spells\\Items\\AIam\\AIamTarget.mdl")
call DestroyEffect(bj_lastCreatedEffect)
call RemoveLocation(RV)
call QS()
endfunction
function X4V takes nothing returns boolean
return(DV=='h006')
endfunction
function X5V takes nothing returns boolean
return(AV[KE]>=Y)and(BV[KE]>=Z)and(NV[KE]>=VV)and(CV[KE]>=JE)
endfunction
function X6V takes nothing returns nothing
set EV=GetTriggerUnit()
set DV=GetUnitTypeId(EV)
set YV=GetTriggerPlayer()
set KE=(1+GetPlayerId(YV))
set ME=GetUnitUserData(EV)
set Y=LoadInteger(XN,DV,0)
set Z=LoadInteger(XN,DV,1)
set VV=LoadInteger(XN,DV,2)
set JE=LoadInteger(XN,DV,3)
if LoadInteger(YE,DV,5)>0 and GetPlayerTechCount(YV,'R00U',true)==1 then
set Y=Y/ 2
endif
if(X5V())then
call UnitSetUpgradeProgress(EV,(GetPlayerTechCountSimple('R00S',YV)*7))
set AV[KE]=(AV[KE]-Y)
set BV[KE]=(BV[KE]-Z)
set NV[KE]=(NV[KE]-VV)
set CV[KE]=(CV[KE]-JE)
set ZE[ME]=true
if(X4V())then
call SetPlayerTechMaxAllowedSwap('h006',0,YV)
endif
call CU(EV)
call QS()
else
set FB=true
call IssueImmediateOrderById(EV,$D0008)
set FB=false
call IS(YV,"没有足够的矿石!")
endif
endfunction
function X8V takes nothing returns boolean
return(GetUnitTypeId(GetFilterUnit())==SX)
endfunction
function X9V takes nothing returns boolean
return(GetDestructableLife(GetEnumDestructable())==1.)
endfunction
function OVV takes nothing returns nothing
if(X9V())then
set SV=true
return
endif
endfunction
function OEV takes nothing returns boolean
return(GetEnumUnit()!=EV)
endfunction
function OXV takes nothing returns nothing
if(OEV())then
set SV=false
endif
endfunction
function OOV takes nothing returns boolean
return(SV)
endfunction
function ORV takes nothing returns boolean
return(SV)
endfunction
function OIV takes nothing returns boolean
return(CountUnitsInGroup(PI)>0)
endfunction
function OAV takes nothing returns boolean
return(SX!=0)
endfunction
function ONV takes nothing returns boolean
return(AV[KE]>=Y)and(BV[KE]>=Z)and(NV[KE]>=VV)and(CV[KE]>=JE)
endfunction
function OBV takes nothing returns nothing
set EV=GetTriggerUnit()
set YV=GetTriggerPlayer()
set KE=(1+GetPlayerId(YV))
set DV=GetUnitTypeId(EV)
set ME=GetUnitUserData(EV)
set Y=LoadInteger(XN,DV,0)
set Z=LoadInteger(XN,DV,1)
set VV=LoadInteger(XN,DV,2)
set JE=LoadInteger(XN,DV,3)
if LoadInteger(YE,DV,5)>0 and GetPlayerTechCount(YV,'R00U',true)==1 then
set Y=Y/ 2
endif
if(ONV())then
set ZE[ME]=true
set RV=GetUnitLoc(EV)
set SX=LoadInteger(QX,DV,0)
set PI=LM(1.,RV,Condition(function X8V))
if(OAV())then
if(OIV())then
call GroupAddUnit(TX,EV)
call EnableTrigger(ZH)
set AV[KE]=(AV[KE]-Y)
set BV[KE]=(BV[KE]-Z)
set NV[KE]=(NV[KE]-VV)
set CV[KE]=(CV[KE]-JE)
else
call CU(EV)
call RemoveUnit(EV)
call IS(YV,"必须放在正确的矿物上!")
endif
else
if LoadInteger(QX,DV,5)>0 then
set SV=false
call NM(50.,RV,function OVV)
if(ORV())then
call ForGroupBJ(PM(10.,RV),function OXV)
if(OOV())then
set AV[KE]=(AV[KE]-Y)
set BV[KE]=(BV[KE]-Z)
set NV[KE]=(NV[KE]-VV)
set CV[KE]=(CV[KE]-JE)
else
call CU(EV)
call RemoveUnit(EV)
call IS(YV,"不能建在这里!")
endif
else
call CU(EV)
call RemoveUnit(EV)
call IS(YV,"一定放要在岩石上!")
endif
else
set AV[KE]=(AV[KE]-Y)
set BV[KE]=(BV[KE]-Z)
set NV[KE]=(NV[KE]-VV)
set CV[KE]=(CV[KE]-JE)
endif
endif
call RemoveLocation(RV)
call DestroyGroup(PI)
call QS()
else
call CU(EV)
call RemoveUnit(EV)
call IS(YV,"没有足够的矿石!")
endif
endfunction
function ODV takes nothing returns boolean
return(AV[KE]>=Y)and(BV[KE]>=Z)and(NV[KE]>=VV)and(CV[KE]>=JE)
endfunction
function OFV takes nothing returns nothing
set LE=GetResearched()
set YV=GetTriggerPlayer()
set EV=GetTriggerUnit()
set DV=GetUnitTypeId(EV)
set KE=(1+GetPlayerId(YV))
set ME=GetPlayerTechCountSimple(LE,YV)
set Y=LoadInteger(XN,LE,0)
set Z=LoadInteger(XN,LE,1)
set VV=LoadInteger(XN,LE,2)
set JE=LoadInteger(XN,LE,3)
if LoadInteger(XN,LE,5)>0 then
set Y=R2I(Pow(I2R(Y),R2I(ME)))+Y
set Z=R2I(Pow(I2R(Z),R2I(ME)))+Z
set VV=R2I(Pow(I2R(VV),R2I(ME)))+VV
set JE=R2I(Pow(I2R(JE),R2I(ME)))+JE
endif
if(ODV())then
call SaveBoolean(XO,LE,KE,true)
set AV[KE]=(AV[KE]-Y)
set BV[KE]=(BV[KE]-Z)
set NV[KE]=(NV[KE]-VV)
set CV[KE]=(CV[KE]-JE)
call QS()
else
set FB=true
call IssueImmediateOrderById(EV,$D0008)
call IssueImmediateOrderById(EV,$D0008)
call IssueImmediateOrderById(EV,$D0008)
call IssueImmediateOrderById(EV,$D0008)
call IssueImmediateOrderById(EV,$D0008)
call IssueImmediateOrderById(EV,$D0008)
set FB=false
call IS(YV,"没有足够的矿石!")
call DisplayTextToPlayer(YV,0,0,"花费:")
if Y>0 then
call DisplayTextToPlayer(YV,0,0,WV[1]+I2S(Y)+" 蓝宝石|r")
endif
if Z>0 then
call DisplayTextToPlayer(YV,0,0,WV[2]+I2S(Z)+" 钻石|r")
endif
if VV>0 then
call DisplayTextToPlayer(YV,0,0,WV[3]+I2S(VV)+" 绿宝石|r")
endif
if JE>0 then
call DisplayTextToPlayer(YV,0,0,WV[4]+I2S(JE)+" 红宝石|r")
endif
endif
endfunction
function OHV takes nothing returns boolean
return(FB!=true)
endfunction
function OJV takes nothing returns nothing
set EV=GetTriggerUnit()
set DV=GetUnitTypeId(EV)
set YV=GetTriggerPlayer()
set KE=(1+GetPlayerId(YV))
set Y=LoadInteger(XN,DV,0)
set Z=LoadInteger(XN,DV,1)
set VV=LoadInteger(XN,DV,2)
set JE=LoadInteger(XN,DV,3)
if LoadInteger(YE,DV,5)>0 and GetPlayerTechCount(YV,'R00U',true)==1 then
set Y=Y/ 2
endif
set AV[KE]=(AV[KE]+Y)
set BV[KE]=(BV[KE]+Z)
set NV[KE]=(NV[KE]+VV)
set CV[KE]=(CV[KE]+JE)
call QS()
endfunction
function OLV takes nothing returns boolean
return(FB!=true)
endfunction
function OMV takes nothing returns boolean
return(SX=='h006')
endfunction
function OPV takes nothing returns nothing
set EV=GetTriggerUnit()
set DV=GetUnitTypeId(EV)
set YV=GetTriggerPlayer()
set KE=(1+GetPlayerId(YV))
set SX=LoadInteger(XO,DV,1)
if(OMV())then
call SetPlayerTechMaxAllowedSwap('h006',1,YV)
endif
set Y=LoadInteger(XN,SX,0)
set Z=LoadInteger(XN,SX,1)
set VV=LoadInteger(XN,SX,2)
set JE=LoadInteger(XN,SX,3)
if LoadInteger(YE,DV,5)>0 and GetPlayerTechCount(YV,'R00U',true)==1 then
set Y=Y/ 2
endif
set AV[KE]=(AV[KE]+Y)
set BV[KE]=(BV[KE]+Z)
set NV[KE]=(NV[KE]+VV)
set CV[KE]=(CV[KE]+JE)
set ZE[GetUnitUserData(EV)]=false
call VS(EV)
call QS()
endfunction
function OSV takes nothing returns boolean
return(FB!=true)
endfunction
function OTV takes nothing returns nothing
set LE=GetResearched()
set YV=GetTriggerPlayer()
set KE=(1+GetPlayerId(YV))
if LoadBoolean(XO,LE,KE) then
call SaveBoolean(XO,LE,KE,false)
set ME=(GetPlayerTechCountSimple(LE,YV)+1)
set Y=(LoadInteger(XN,LE,0)*ME)
set Z=(LoadInteger(XN,LE,1)*ME)
set VV=(LoadInteger(XN,LE,2)*ME)
set JE=(LoadInteger(XN,LE,3)*ME)
set AV[KE]=(AV[KE]+Y)
set BV[KE]=(BV[KE]+Z)
set NV[KE]=(NV[KE]+VV)
set CV[KE]=(CV[KE]+JE)
call QS()
endif
endfunction
function OWV takes nothing returns boolean
return(GetDestructableMaxLife(GetEnumDestructable())==777.)
endfunction
function OYV takes nothing returns nothing
if(OWV())then
call RemoveDestructable(GetEnumDestructable())
endif
endfunction
function OZV takes nothing returns nothing
set EV=GetTriggerUnit()
set Y=GetUnitUserData(EV)
set ZE[Y]=false
set DV=GetUnitTypeId(EV)
set RV=GetUnitLoc(EV)
call SetTerrainTypeBJ(RV,'Cdrd',-1,2,1)
call NM(256,RV,function OYV)
call RemoveLocation(RV)
call VS(EV)
endfunction
function O0V takes nothing returns nothing
set EV=GetTriggerUnit()
call VS(EV)
set Y=GetUnitUserData(EV)
set ZE[Y]=false
endfunction
function O2V takes nothing returns boolean
return('R013'==LE)
endfunction
function O3V takes nothing returns boolean
return('R014'==LE)
endfunction
function O4V takes nothing returns boolean
return('R00V'==LE)or('R00A'==LE)or('R00N'==LE)or('R00M'==LE)or('R00W'==LE)or('R00O'==LE)or('R00P'==LE)or('R009'==LE)or('R00B'==LE)or('R00C'==LE)
endfunction
function O5V takes nothing returns boolean
return(O4V())
endfunction
function O6V takes nothing returns nothing
set LE=GetResearched()
set YV=GetTriggerPlayer()
set KE=(1+GetPlayerId(YV))
set LE=GetResearched()
if(O5V())then
call SetPlayerTechMaxAllowedSwap('R00A',0,YV)
call SetPlayerTechMaxAllowedSwap('R00N',0,YV)
call SetPlayerTechMaxAllowedSwap('R00V',0,YV)
call SetPlayerTechMaxAllowedSwap('R00W',0,YV)
call SetPlayerTechMaxAllowedSwap('R00O',0,YV)
call SetPlayerTechMaxAllowedSwap('R00P',0,YV)
call SetPlayerTechMaxAllowedSwap('R009',0,YV)
call SetPlayerTechMaxAllowedSwap('R00B',0,YV)
call SetPlayerTechMaxAllowedSwap('R00C',0,YV)
call SetPlayerTechMaxAllowedSwap('R00M',0,YV)
else
if(O3V())then
call SetPlayerAbilityAvailableBJ(true,'A01R',YV)
else
if(O2V())then
call SetPlayerTechMaxAllowedSwap('h011',(GetPlayerTechCountSimple(LE,YV)+1),YV)
endif
endif
endif
call SaveBoolean(XO,LE,KE,false)
endfunction
function InitCustomTeams takes nothing returns nothing
call SetPlayerTeam(Player(0),0)
call SetPlayerState(Player(0),PLAYER_STATE_ALLIED_VICTORY,1)
call SetPlayerTeam(Player(1),0)
call SetPlayerState(Player(1),PLAYER_STATE_ALLIED_VICTORY,1)
call SetPlayerTeam(Player(2),0)
call SetPlayerState(Player(2),PLAYER_STATE_ALLIED_VICTORY,1)
call SetPlayerTeam(Player(3),0)
call SetPlayerState(Player(3),PLAYER_STATE_ALLIED_VICTORY,1)
call SetPlayerTeam(Player(4),0)
call SetPlayerState(Player(4),PLAYER_STATE_ALLIED_VICTORY,1)
call SetPlayerTeam(Player(5),0)
call SetPlayerState(Player(5),PLAYER_STATE_ALLIED_VICTORY,1)
call SetPlayerTeam(Player(6),0)
call SetPlayerState(Player(6),PLAYER_STATE_ALLIED_VICTORY,1)
call SetPlayerTeam(Player(7),0)
call SetPlayerState(Player(7),PLAYER_STATE_ALLIED_VICTORY,1)
call SetPlayerTeam(Player(8),0)
call SetPlayerState(Player(8),PLAYER_STATE_ALLIED_VICTORY,1)
call SetPlayerTeam(Player(9),0)
call SetPlayerState(Player(9),PLAYER_STATE_ALLIED_VICTORY,1)
call SetPlayerTeam(Player($A),0)
call SetPlayerState(Player($A),PLAYER_STATE_ALLIED_VICTORY,1)
call SetPlayerAllianceStateAllyBJ(Player(0),Player(1),true)
call SetPlayerAllianceStateAllyBJ(Player(0),Player(2),true)
call SetPlayerAllianceStateAllyBJ(Player(0),Player(3),true)
call SetPlayerAllianceStateAllyBJ(Player(0),Player(4),true)
call SetPlayerAllianceStateAllyBJ(Player(0),Player(5),true)
call SetPlayerAllianceStateAllyBJ(Player(0),Player(6),true)
call SetPlayerAllianceStateAllyBJ(Player(0),Player(7),true)
call SetPlayerAllianceStateAllyBJ(Player(0),Player(8),true)
call SetPlayerAllianceStateAllyBJ(Player(0),Player(9),true)
call SetPlayerAllianceStateAllyBJ(Player(0),Player($A),true)
call SetPlayerAllianceStateAllyBJ(Player(1),Player(0),true)
call SetPlayerAllianceStateAllyBJ(Player(1),Player(2),true)
call SetPlayerAllianceStateAllyBJ(Player(1),Player(3),true)
call SetPlayerAllianceStateAllyBJ(Player(1),Player(4),true)
call SetPlayerAllianceStateAllyBJ(Player(1),Player(5),true)
call SetPlayerAllianceStateAllyBJ(Player(1),Player(6),true)
call SetPlayerAllianceStateAllyBJ(Player(1),Player(7),true)
call SetPlayerAllianceStateAllyBJ(Player(1),Player(8),true)
call SetPlayerAllianceStateAllyBJ(Player(1),Player(9),true)
call SetPlayerAllianceStateAllyBJ(Player(1),Player($A),true)
call SetPlayerAllianceStateAllyBJ(Player(2),Player(0),true)
call SetPlayerAllianceStateAllyBJ(Player(2),Player(1),true)
call SetPlayerAllianceStateAllyBJ(Player(2),Player(3),true)
call SetPlayerAllianceStateAllyBJ(Player(2),Player(4),true)
call SetPlayerAllianceStateAllyBJ(Player(2),Player(5),true)
call SetPlayerAllianceStateAllyBJ(Player(2),Player(6),true)
call SetPlayerAllianceStateAllyBJ(Player(2),Player(7),true)
call SetPlayerAllianceStateAllyBJ(Player(2),Player(8),true)
call SetPlayerAllianceStateAllyBJ(Player(2),Player(9),true)
call SetPlayerAllianceStateAllyBJ(Player(2),Player($A),true)
call SetPlayerAllianceStateAllyBJ(Player(3),Player(0),true)
call SetPlayerAllianceStateAllyBJ(Player(3),Player(1),true)
call SetPlayerAllianceStateAllyBJ(Player(3),Player(2),true)
call SetPlayerAllianceStateAllyBJ(Player(3),Player(4),true)
call SetPlayerAllianceStateAllyBJ(Player(3),Player(5),true)
call SetPlayerAllianceStateAllyBJ(Player(3),Player(6),true)
call SetPlayerAllianceStateAllyBJ(Player(3),Player(7),true)
call SetPlayerAllianceStateAllyBJ(Player(3),Player(8),true)
call SetPlayerAllianceStateAllyBJ(Player(3),Player(9),true)
call SetPlayerAllianceStateAllyBJ(Player(3),Player($A),true)
call SetPlayerAllianceStateAllyBJ(Player(4),Player(0),true)
call SetPlayerAllianceStateAllyBJ(Player(4),Player(1),true)
call SetPlayerAllianceStateAllyBJ(Player(4),Player(2),true)
call SetPlayerAllianceStateAllyBJ(Player(4),Player(3),true)
call SetPlayerAllianceStateAllyBJ(Player(4),Player(5),true)
call SetPlayerAllianceStateAllyBJ(Player(4),Player(6),true)
call SetPlayerAllianceStateAllyBJ(Player(4),Player(7),true)
call SetPlayerAllianceStateAllyBJ(Player(4),Player(8),true)
call SetPlayerAllianceStateAllyBJ(Player(4),Player(9),true)
call SetPlayerAllianceStateAllyBJ(Player(4),Player($A),true)
call SetPlayerAllianceStateAllyBJ(Player(5),Player(0),true)
call SetPlayerAllianceStateAllyBJ(Player(5),Player(1),true)
call SetPlayerAllianceStateAllyBJ(Player(5),Player(2),true)
call SetPlayerAllianceStateAllyBJ(Player(5),Player(3),true)
call SetPlayerAllianceStateAllyBJ(Player(5),Player(4),true)
call SetPlayerAllianceStateAllyBJ(Player(5),Player(6),true)
call SetPlayerAllianceStateAllyBJ(Player(5),Player(7),true)
call SetPlayerAllianceStateAllyBJ(Player(5),Player(8),true)
call SetPlayerAllianceStateAllyBJ(Player(5),Player(9),true)
call SetPlayerAllianceStateAllyBJ(Player(5),Player($A),true)
call SetPlayerAllianceStateAllyBJ(Player(6),Player(0),true)
call SetPlayerAllianceStateAllyBJ(Player(6),Player(1),true)
call SetPlayerAllianceStateAllyBJ(Player(6),Player(2),true)
call SetPlayerAllianceStateAllyBJ(Player(6),Player(3),true)
call SetPlayerAllianceStateAllyBJ(Player(6),Player(4),true)
call SetPlayerAllianceStateAllyBJ(Player(6),Player(5),true)
call SetPlayerAllianceStateAllyBJ(Player(6),Player(7),true)
call SetPlayerAllianceStateAllyBJ(Player(6),Player(8),true)
call SetPlayerAllianceStateAllyBJ(Player(6),Player(9),true)
call SetPlayerAllianceStateAllyBJ(Player(6),Player($A),true)
call SetPlayerAllianceStateAllyBJ(Player(7),Player(0),true)
call SetPlayerAllianceStateAllyBJ(Player(7),Player(1),true)
call SetPlayerAllianceStateAllyBJ(Player(7),Player(2),true)
call SetPlayerAllianceStateAllyBJ(Player(7),Player(3),true)
call SetPlayerAllianceStateAllyBJ(Player(7),Player(4),true)
call SetPlayerAllianceStateAllyBJ(Player(7),Player(5),true)
call SetPlayerAllianceStateAllyBJ(Player(7),Player(6),true)
call SetPlayerAllianceStateAllyBJ(Player(7),Player(8),true)
call SetPlayerAllianceStateAllyBJ(Player(7),Player(9),true)
call SetPlayerAllianceStateAllyBJ(Player(7),Player($A),true)
call SetPlayerAllianceStateAllyBJ(Player(8),Player(0),true)
call SetPlayerAllianceStateAllyBJ(Player(8),Player(1),true)
call SetPlayerAllianceStateAllyBJ(Player(8),Player(2),true)
call SetPlayerAllianceStateAllyBJ(Player(8),Player(3),true)
call SetPlayerAllianceStateAllyBJ(Player(8),Player(4),true)
call SetPlayerAllianceStateAllyBJ(Player(8),Player(5),true)
call SetPlayerAllianceStateAllyBJ(Player(8),Player(6),true)
call SetPlayerAllianceStateAllyBJ(Player(8),Player(7),true)
call SetPlayerAllianceStateAllyBJ(Player(8),Player(9),true)
call SetPlayerAllianceStateAllyBJ(Player(8),Player($A),true)
call SetPlayerAllianceStateAllyBJ(Player(9),Player(0),true)
call SetPlayerAllianceStateAllyBJ(Player(9),Player(1),true)
call SetPlayerAllianceStateAllyBJ(Player(9),Player(2),true)
call SetPlayerAllianceStateAllyBJ(Player(9),Player(3),true)
call SetPlayerAllianceStateAllyBJ(Player(9),Player(4),true)
call SetPlayerAllianceStateAllyBJ(Player(9),Player(5),true)
call SetPlayerAllianceStateAllyBJ(Player(9),Player(6),true)
call SetPlayerAllianceStateAllyBJ(Player(9),Player(7),true)
call SetPlayerAllianceStateAllyBJ(Player(9),Player(8),true)
call SetPlayerAllianceStateAllyBJ(Player(9),Player($A),true)
call SetPlayerAllianceStateAllyBJ(Player($A),Player(0),true)
call SetPlayerAllianceStateAllyBJ(Player($A),Player(1),true)
call SetPlayerAllianceStateAllyBJ(Player($A),Player(2),true)
call SetPlayerAllianceStateAllyBJ(Player($A),Player(3),true)
call SetPlayerAllianceStateAllyBJ(Player($A),Player(4),true)
call SetPlayerAllianceStateAllyBJ(Player($A),Player(5),true)
call SetPlayerAllianceStateAllyBJ(Player($A),Player(6),true)
call SetPlayerAllianceStateAllyBJ(Player($A),Player(7),true)
call SetPlayerAllianceStateAllyBJ(Player($A),Player(8),true)
call SetPlayerAllianceStateAllyBJ(Player($A),Player(9),true)
call SetPlayerAllianceStateVisionBJ(Player(0),Player(1),true)
call SetPlayerAllianceStateVisionBJ(Player(0),Player(2),true)
call SetPlayerAllianceStateVisionBJ(Player(0),Player(3),true)
call SetPlayerAllianceStateVisionBJ(Player(0),Player(4),true)
call SetPlayerAllianceStateVisionBJ(Player(0),Player(5),true)
call SetPlayerAllianceStateVisionBJ(Player(0),Player(6),true)
call SetPlayerAllianceStateVisionBJ(Player(0),Player(7),true)
call SetPlayerAllianceStateVisionBJ(Player(0),Player(8),true)
call SetPlayerAllianceStateVisionBJ(Player(0),Player(9),true)
call SetPlayerAllianceStateVisionBJ(Player(0),Player($A),true)
call SetPlayerAllianceStateVisionBJ(Player(1),Player(0),true)
call SetPlayerAllianceStateVisionBJ(Player(1),Player(2),true)
call SetPlayerAllianceStateVisionBJ(Player(1),Player(3),true)
call SetPlayerAllianceStateVisionBJ(Player(1),Player(4),true)
call SetPlayerAllianceStateVisionBJ(Player(1),Player(5),true)
call SetPlayerAllianceStateVisionBJ(Player(1),Player(6),true)
call SetPlayerAllianceStateVisionBJ(Player(1),Player(7),true)
call SetPlayerAllianceStateVisionBJ(Player(1),Player(8),true)
call SetPlayerAllianceStateVisionBJ(Player(1),Player(9),true)
call SetPlayerAllianceStateVisionBJ(Player(1),Player($A),true)
call SetPlayerAllianceStateVisionBJ(Player(2),Player(0),true)
call SetPlayerAllianceStateVisionBJ(Player(2),Player(1),true)
call SetPlayerAllianceStateVisionBJ(Player(2),Player(3),true)
call SetPlayerAllianceStateVisionBJ(Player(2),Player(4),true)
call SetPlayerAllianceStateVisionBJ(Player(2),Player(5),true)
call SetPlayerAllianceStateVisionBJ(Player(2),Player(6),true)
call SetPlayerAllianceStateVisionBJ(Player(2),Player(7),true)
call SetPlayerAllianceStateVisionBJ(Player(2),Player(8),true)
call SetPlayerAllianceStateVisionBJ(Player(2),Player(9),true)
call SetPlayerAllianceStateVisionBJ(Player(2),Player($A),true)
call SetPlayerAllianceStateVisionBJ(Player(3),Player(0),true)
call SetPlayerAllianceStateVisionBJ(Player(3),Player(1),true)
call SetPlayerAllianceStateVisionBJ(Player(3),Player(2),true)
call SetPlayerAllianceStateVisionBJ(Player(3),Player(4),true)
call SetPlayerAllianceStateVisionBJ(Player(3),Player(5),true)
call SetPlayerAllianceStateVisionBJ(Player(3),Player(6),true)
call SetPlayerAllianceStateVisionBJ(Player(3),Player(7),true)
call SetPlayerAllianceStateVisionBJ(Player(3),Player(8),true)
call SetPlayerAllianceStateVisionBJ(Player(3),Player(9),true)
call SetPlayerAllianceStateVisionBJ(Player(3),Player($A),true)
call SetPlayerAllianceStateVisionBJ(Player(4),Player(0),true)
call SetPlayerAllianceStateVisionBJ(Player(4),Player(1),true)
call SetPlayerAllianceStateVisionBJ(Player(4),Player(2),true)
call SetPlayerAllianceStateVisionBJ(Player(4),Player(3),true)
call SetPlayerAllianceStateVisionBJ(Player(4),Player(5),true)
call SetPlayerAllianceStateVisionBJ(Player(4),Player(6),true)
call SetPlayerAllianceStateVisionBJ(Player(4),Player(7),true)
call SetPlayerAllianceStateVisionBJ(Player(4),Player(8),true)
call SetPlayerAllianceStateVisionBJ(Player(4),Player(9),true)
call SetPlayerAllianceStateVisionBJ(Player(4),Player($A),true)
call SetPlayerAllianceStateVisionBJ(Player(5),Player(0),true)
call SetPlayerAllianceStateVisionBJ(Player(5),Player(1),true)
call SetPlayerAllianceStateVisionBJ(Player(5),Player(2),true)
call SetPlayerAllianceStateVisionBJ(Player(5),Player(3),true)
call SetPlayerAllianceStateVisionBJ(Player(5),Player(4),true)
call SetPlayerAllianceStateVisionBJ(Player(5),Player(6),true)
call SetPlayerAllianceStateVisionBJ(Player(5),Player(7),true)
call SetPlayerAllianceStateVisionBJ(Player(5),Player(8),true)
call SetPlayerAllianceStateVisionBJ(Player(5),Player(9),true)
call SetPlayerAllianceStateVisionBJ(Player(5),Player($A),true)
call SetPlayerAllianceStateVisionBJ(Player(6),Player(0),true)
call SetPlayerAllianceStateVisionBJ(Player(6),Player(1),true)
call SetPlayerAllianceStateVisionBJ(Player(6),Player(2),true)
call SetPlayerAllianceStateVisionBJ(Player(6),Player(3),true)
call SetPlayerAllianceStateVisionBJ(Player(6),Player(4),true)
call SetPlayerAllianceStateVisionBJ(Player(6),Player(5),true)
call SetPlayerAllianceStateVisionBJ(Player(6),Player(7),true)
call SetPlayerAllianceStateVisionBJ(Player(6),Player(8),true)
call SetPlayerAllianceStateVisionBJ(Player(6),Player(9),true)
call SetPlayerAllianceStateVisionBJ(Player(6),Player($A),true)
call SetPlayerAllianceStateVisionBJ(Player(7),Player(0),true)
call SetPlayerAllianceStateVisionBJ(Player(7),Player(1),true)
call SetPlayerAllianceStateVisionBJ(Player(7),Player(2),true)
call SetPlayerAllianceStateVisionBJ(Player(7),Player(3),true)
call SetPlayerAllianceStateVisionBJ(Player(7),Player(4),true)
call SetPlayerAllianceStateVisionBJ(Player(7),Player(5),true)
call SetPlayerAllianceStateVisionBJ(Player(7),Player(6),true)
call SetPlayerAllianceStateVisionBJ(Player(7),Player(8),true)
call SetPlayerAllianceStateVisionBJ(Player(7),Player(9),true)
call SetPlayerAllianceStateVisionBJ(Player(7),Player($A),true)
call SetPlayerAllianceStateVisionBJ(Player(8),Player(0),true)
call SetPlayerAllianceStateVisionBJ(Player(8),Player(1),true)
call SetPlayerAllianceStateVisionBJ(Player(8),Player(2),true)
call SetPlayerAllianceStateVisionBJ(Player(8),Player(3),true)
call SetPlayerAllianceStateVisionBJ(Player(8),Player(4),true)
call SetPlayerAllianceStateVisionBJ(Player(8),Player(5),true)
call SetPlayerAllianceStateVisionBJ(Player(8),Player(6),true)
call SetPlayerAllianceStateVisionBJ(Player(8),Player(7),true)
call SetPlayerAllianceStateVisionBJ(Player(8),Player(9),true)
call SetPlayerAllianceStateVisionBJ(Player(8),Player($A),true)
call SetPlayerAllianceStateVisionBJ(Player(9),Player(0),true)
call SetPlayerAllianceStateVisionBJ(Player(9),Player(1),true)
call SetPlayerAllianceStateVisionBJ(Player(9),Player(2),true)
call SetPlayerAllianceStateVisionBJ(Player(9),Player(3),true)
call SetPlayerAllianceStateVisionBJ(Player(9),Player(4),true)
call SetPlayerAllianceStateVisionBJ(Player(9),Player(5),true)
call SetPlayerAllianceStateVisionBJ(Player(9),Player(6),true)
call SetPlayerAllianceStateVisionBJ(Player(9),Player(7),true)
call SetPlayerAllianceStateVisionBJ(Player(9),Player(8),true)
call SetPlayerAllianceStateVisionBJ(Player(9),Player($A),true)
call SetPlayerAllianceStateVisionBJ(Player($A),Player(0),true)
call SetPlayerAllianceStateVisionBJ(Player($A),Player(1),true)
call SetPlayerAllianceStateVisionBJ(Player($A),Player(2),true)
call SetPlayerAllianceStateVisionBJ(Player($A),Player(3),true)
call SetPlayerAllianceStateVisionBJ(Player($A),Player(4),true)
call SetPlayerAllianceStateVisionBJ(Player($A),Player(5),true)
call SetPlayerAllianceStateVisionBJ(Player($A),Player(6),true)
call SetPlayerAllianceStateVisionBJ(Player($A),Player(7),true)
call SetPlayerAllianceStateVisionBJ(Player($A),Player(8),true)
call SetPlayerAllianceStateVisionBJ(Player($A),Player(9),true)
call SetPlayerTeam(Player($B),1)
call SetPlayerState(Player($B),PLAYER_STATE_ALLIED_VICTORY,1)
endfunction
function main takes nothing returns nothing
local weathereffect we
local destructable d
local trigger t
local real LT
local integer i
local integer NP
local integer BP
local version v
local integer YM
call SetCameraBounds(-8064.+GetCameraMargin(CAMERA_MARGIN_LEFT),-8064.+GetCameraMargin(CAMERA_MARGIN_BOTTOM),12160.-GetCameraMargin(CAMERA_MARGIN_RIGHT),8064.-GetCameraMargin(CAMERA_MARGIN_TOP),-8064.+GetCameraMargin(CAMERA_MARGIN_LEFT),8064.-GetCameraMargin(CAMERA_MARGIN_TOP),12160.-GetCameraMargin(CAMERA_MARGIN_RIGHT),-8064.+GetCameraMargin(CAMERA_MARGIN_BOTTOM))
call SetDayNightModels("Environment\\DNC\\DNCAshenvale\\DNCAshenvaleTerrain\\DNCAshenvaleTerrain.mdl","Environment\\DNC\\DNCAshenvale\\DNCAshenvaleUnit\\DNCAshenvaleUnit.mdl")
call SetTerrainFogEx(0,3000.,5000.,.5,.502,.502,.502)
call NewSoundEnvironment("psychotic")
call SetAmbientDaySound("DungeonDay")
call SetAmbientNightSound("DungeonNight")
call SetMapMusic("Music",true,0)
set AC=CreateSound("Abilities\\Spells\\Items\\AIil\\WandOfIllusionTarget1.wav",false,true,false,$A,$A,"SpellsEAX")
call SetSoundParamsFromLabel(AC,"ItemIllusion")
call SetSoundDuration(AC,960)
call SetSoundVolume(AC,50)
call SetSoundPitch(AC,2.)
call SetSoundDistances(AC,600.,3000.)
call SetSoundDistanceCutoff(AC,1000.)
set NC=CreateSound("Sound\\Units\\Death\\ArtilleryCorpseExplodeDeath1.wav",false,true,false,$A,$A,"DefaultEAXON")
call SetSoundParamsFromLabel(NC,"ArtilleryExplodeDeath")
call SetSoundDuration(NC,$5CE)
call SetSoundPitch(NC,.7)
call SetSoundDistances(NC,600.,5000.)
call SetSoundDistanceCutoff(NC,4000.)
set BC=CreateSound("Buildings\\Other\\MageTower\\MageTowerWhat1.wav",false,false,false,$A,$A,"DefaultEAXON")
call SetSoundParamsFromLabel(BC,"MageTowerWhat")
call SetSoundDuration(BC,$CCA)
call SetSoundPitch(BC,.9)
set CC=CreateSound("Sound\\Music\\mp3Music\\UndeadVictory.mp3",false,false,false,$A,$A,"DefaultEAXON")
call SetSoundDuration(CC,$9B72)
call SetSoundChannel(CC,0)
call SetSoundVolume(CC,$7F)
call SetSoundPitch(CC,.8)
set DC=CreateSound("Sound\\Music\\mp3Music\\PursuitTheme.mp3",false,false,false,$A,$A,"DefaultEAXON")
call SetSoundDuration(DC,82537)
call SetSoundChannel(DC,0)
call SetSoundVolume(DC,$7F)
call SetSoundPitch(DC,.8)
set FC=CreateSound("Sound\\Music\\mp3Music\\Comradeship.mp3",false,false,false,$A,$A,"DefaultEAXON")
call SetSoundDuration(FC,$1E7FF)
call SetSoundChannel(FC,0)
call SetSoundVolume(FC,$7F)
call SetSoundPitch(FC,.8)
set GC=CreateSound("Sound\\Music\\mp3Music\\UndeadX1.mp3",false,false,false,$A,$A,"DefaultEAXON")
call SetSoundDuration(GC,$4214F)
call SetSoundChannel(GC,0)
call SetSoundVolume(GC,$7F)
call SetSoundPitch(GC,1.2)
set HC=CreateSound("Sound\\Music\\mp3Music\\Doom.mp3",false,false,false,$A,$A,"DefaultEAXON")
call SetSoundDuration(HC,66125)
call SetSoundChannel(HC,0)
call SetSoundVolume(HC,$7F)
call SetSoundPitch(HC,.9)
set JC=CreateSound("Units\\Human\\Peasant\\PeasantWhat3.wav",false,false,true,$A,$A,"DefaultEAXON")
call SetSoundParamsFromLabel(JC,"PeasantWhat")
call SetSoundDuration(JC,936)
set KC=CreateSound("Units\\Demon\\HeroPitLord\\HPitLordPissed3.wav",false,false,true,$A,$A,"HeroAcksEAX")
call SetSoundParamsFromLabel(KC,"HeroPitLordPissed")
call SetSoundDuration(KC,$824)
set LC=CreateSound("Units\\Demon\\HeroPitLord\\HPitLordWhat5.wav",false,false,true,$A,$A,"HeroAcksEAX")
call SetSoundParamsFromLabel(LC,"HeroPitLordWhat")
call SetSoundDuration(LC,$7D6)
set MC=CreateSound("Units\\Human\\Peasant\\PeasantWarcry1.wav",false,false,true,$A,$A,"DefaultEAXON")
call SetSoundParamsFromLabel(MC,"PeasantWarcry")
call SetSoundDuration(MC,977)
set PC=CreateSound("Sound\\Interface\\GlueScreenEarthquake1.wav",true,false,false,$7F,$7F,"DefaultEAXON")
call SetSoundParamsFromLabel(PC,"GlueScreenEarthquake")
call SetSoundDuration(PC,$CA5)
call SetSoundVolume(PC,$7F)
call SetSoundPitch(PC,.5)
set QC=CreateSound("Sound\\Interface\\GlueScreenMeteorHit2.wav",false,false,true,$A,$A,"MissilesEAX")
call SetSoundParamsFromLabel(QC,"GlueScreenMeteorHit")
call SetSoundDuration(QC,$5DC)
call SetSoundVolume(QC,$7F)
set SC=CreateSound("Sound\\Interface\\GlueScreenMeteorHit3.wav",false,false,true,$A,$A,"MissilesEAX")
call SetSoundParamsFromLabel(SC,"GlueScreenMeteorHit")
call SetSoundDuration(SC,$5DC)
call SetSoundVolume(SC,$7F)
set TC=CreateSound("Abilities\\Spells\\Human\\Slow\\SorceressCastAttack1.wav",false,true,true,$A,$A,"SpellsEAX")
call SetSoundParamsFromLabel(TC,"SlowCaster")
call SetSoundDuration(TC,834)
call SetSoundPitch(TC,2.)
set UC=CreateSound("Abilities\\Spells\\Human\\DivineShield\\PaladinDivineShieldDeath1.wav",false,true,true,$A,$A,"SpellsEAX")
call SetSoundParamsFromLabel(UC,"DivineShieldDeath")
call SetSoundDuration(UC,$413)
call SetSoundPitch(UC,2.)
set WC=CreateSound("Abilities\\Spells\\Orc\\SpiritLink\\SpiritLink1.wav",false,true,true,$A,$A,"SpellsEAX")
call SetSoundParamsFromLabel(WC,"SpiritLink")
call SetSoundDuration(WC,$6E5)
call SetSoundPitch(WC,2.)
set YC=CreateSound("Sound\\Interface\\BattlenetBirth1.wav",false,false,false,$A,$A,"SpellsEAX")
call SetSoundParamsFromLabel(YC,"GlueScreenBNetClose")
call SetSoundDuration(YC,$7D0)
set ZC=CreateSound("Sound\\Music\\mp3Music\\HumanVictory.mp3",true,false,false,$A,$A,"DefaultEAXON")
call SetSoundDuration(ZC,$7619)
call SetSoundChannel(ZC,0)
call SetSoundVolume(ZC,$7F)
call SetSoundPitch(ZC,1.)
set VD=CreateSound("Units\\Undead\\Banshee\\BansheeYesAttack3.wav",false,false,false,$A,$A,"DefaultEAXON")
call SetSoundParamsFromLabel(VD,"BansheeYesAttack")
call SetSoundDuration(VD,$A60)
set ED=CreateSound("Units\\Undead\\Banshee\\BansheeYesAttack2.wav",false,false,false,$A,$A,"DefaultEAXON")
call SetSoundParamsFromLabel(ED,"BansheeYesAttack")
call SetSoundDuration(ED,$97D)
set XD=CreateSound("Units\\Undead\\Banshee\\BansheeYesAttack1.wav",false,false,false,$A,$A,"DefaultEAXON")
call SetSoundParamsFromLabel(XD,"BansheeYesAttack")
call SetSoundDuration(XD,$657)
set OD=CreateSound("Units\\Undead\\Banshee\\BansheePissed4.wav",false,false,false,$A,$A,"DefaultEAXON")
call SetSoundParamsFromLabel(OD,"BansheePissed")
call SetSoundDuration(OD,$FD4)
set RD=CreateSound("Units\\Undead\\Banshee\\BansheeWarcry1.wav",false,false,false,$A,$A,"DefaultEAXON")
call SetSoundParamsFromLabel(RD,"BansheeWarcry")
call SetSoundDuration(RD,$B6A)
set ID=CreateSound("Units\\Undead\\Banshee\\BansheeReady1.wav",false,false,false,$A,$A,"DefaultEAXON")
call SetSoundParamsFromLabel(ID,"BansheeReady")
call SetSoundDuration(ID,4435)
set AD=CreateSound("Units\\Undead\\Abomination\\AbominationWarcry1.wav",false,false,false,$A,$A,"DefaultEAXON")
call SetSoundParamsFromLabel(AD,"AbominationWarcry")
call SetSoundDuration(AD,$812)
set ND=CreateSound("Units\\Undead\\Abomination\\AbominationReady1.wav",false,false,false,$A,$A,"DefaultEAXON")
call SetSoundParamsFromLabel(ND,"AbominationReady")
call SetSoundDuration(ND,$8BB)
set BD=CreateSound("Units\\Undead\\EvilSylvanas\\EvilSylvanasYesAttack3.wav",false,false,false,$A,$A,"HeroAcksEAX")
call SetSoundParamsFromLabel(BD,"EvilSylvanasYesAttack")
call SetSoundDuration(BD,$682)
set CD=CreateSound("Abilities\\Spells\\Demon\\SoulPreservation\\SoulPreservation.wav",false,true,true,$A,$A,"SpellsEAX")
call SetSoundParamsFromLabel(CD,"SoulPreservation")
call SetSoundDuration(CD,$E1D)
set DD=CreateSound("ResidentEvil Music.mp3",false,false,false,$A,$A,"DefaultEAXON")
call SetSoundChannel(DD,7)
call SetSoundVolume(DD,$7F)
call SetSoundPitch(DD,1.)
set FD=CreateSound("Sound\\Ambient\\AllianceGlueScreen.wav",true,false,false,$A,$A,"DefaultEAXON")
call SetSoundParamsFromLabel(FD,"ExpansionHumanGlueScreenLoop")
call SetSoundDuration(FD,9997)
call SetSoundVolume(FD,$7F)
call SetSoundPitch(FD,.9)
set GD=CreateSound("Sound\\Interface\\Hint.wav",false,false,false,$A,$A,"")
call SetSoundParamsFromLabel(GD,"Hint")
call SetSoundDuration(GD,$7D6)
set HD=CreateSound("Abilities\\Spells\\Human\\SpellSteal\\SpellStealTarget.wav",false,false,true,$A,$A,"SpellsEAX")
call SetSoundParamsFromLabel(HD,"SpellStealTarget")
call SetSoundDuration(HD,984)
call SetSoundChannel(HD,0)
call SetSoundPitch(HD,.9)
set GB=Rect(-8064.,-8064.,8192.,8064.)
set HB=Rect(-7872.,3392.,-4352.,7616.)
set JB=Rect(9984.,-4000.,10240.,-3200.)
set KB=Rect(12000.,-4032.,12256.,-3328.)
set LB=Rect(10400.,-5472.,11776.,-5280.)
set MB=Rect(10848.,-3104.,11168.,-2880.)
set PB=Rect(10880.,-2528.,11136.,-2304.)
set QB=Rect(9984.,-6016.,12288.,-128.)
set SB=Rect(-576.,-800.,-192.,-448.)
set TB=Rect(-1408.,-1408.,640.,512.)
set UB=Rect(-7328.,-7424.,-1504.,-1728.)
set WB=Rect(-7584.,-7584.,7712.,7584.)
set YB=Rect(-2080.,-960.,-224.,128.)
set ZB=Rect(-736.,-2656.,-288.,-2400.)
set VC=CreateCameraSetup()
call CameraSetupSetField(VC,CAMERA_FIELD_ZOFFSET,.0,.0)
call CameraSetupSetField(VC,CAMERA_FIELD_ROTATION,76.1,.0)
call CameraSetupSetField(VC,CAMERA_FIELD_ANGLE_OF_ATTACK,349.3,.0)
call CameraSetupSetField(VC,CAMERA_FIELD_TARGET_DISTANCE,1650.,.0)
call CameraSetupSetField(VC,CAMERA_FIELD_ROLL,.0,.0)
call CameraSetupSetField(VC,CAMERA_FIELD_FIELD_OF_VIEW,70.,.0)
call CameraSetupSetField(VC,CAMERA_FIELD_FARZ,5000.,.0)
call CameraSetupSetDestPosition(VC,11183.5,-4146.1,.0)
set EC=CreateCameraSetup()
call CameraSetupSetField(EC,CAMERA_FIELD_ZOFFSET,.0,.0)
call CameraSetupSetField(EC,CAMERA_FIELD_ROTATION,81.3,.0)
call CameraSetupSetField(EC,CAMERA_FIELD_ANGLE_OF_ATTACK,345.2,.0)
call CameraSetupSetField(EC,CAMERA_FIELD_TARGET_DISTANCE,1650.,.0)
call CameraSetupSetField(EC,CAMERA_FIELD_ROLL,.0,.0)
call CameraSetupSetField(EC,CAMERA_FIELD_FIELD_OF_VIEW,70.,.0)
call CameraSetupSetField(EC,CAMERA_FIELD_FARZ,5000.,.0)
call CameraSetupSetDestPosition(EC,10997.1,-3168.8,.0)
set XC=CreateCameraSetup()
call CameraSetupSetField(XC,CAMERA_FIELD_ZOFFSET,.0,.0)
call CameraSetupSetField(XC,CAMERA_FIELD_ROTATION,90.,.0)
call CameraSetupSetField(XC,CAMERA_FIELD_ANGLE_OF_ATTACK,304.,.0)
call CameraSetupSetField(XC,CAMERA_FIELD_TARGET_DISTANCE,1650.,.0)
call CameraSetupSetField(XC,CAMERA_FIELD_ROLL,.0,.0)
call CameraSetupSetField(XC,CAMERA_FIELD_FIELD_OF_VIEW,70.,.0)
call CameraSetupSetField(XC,CAMERA_FIELD_FARZ,5000.,.0)
call CameraSetupSetDestPosition(XC,-320.1,-445.3,.0)
set OC=CreateCameraSetup()
call CameraSetupSetField(OC,CAMERA_FIELD_ZOFFSET,.0,.0)
call CameraSetupSetField(OC,CAMERA_FIELD_ROTATION,88.3,.0)
call CameraSetupSetField(OC,CAMERA_FIELD_ANGLE_OF_ATTACK,345.9,.0)
call CameraSetupSetField(OC,CAMERA_FIELD_TARGET_DISTANCE,1650.,.0)
call CameraSetupSetField(OC,CAMERA_FIELD_ROLL,.0,.0)
call CameraSetupSetField(OC,CAMERA_FIELD_FIELD_OF_VIEW,70.,.0)
call CameraSetupSetField(OC,CAMERA_FIELD_FARZ,5000.,.0)
call CameraSetupSetDestPosition(OC,11136.8,-2538.2,.0)
set RC=CreateCameraSetup()
call CameraSetupSetField(RC,CAMERA_FIELD_ZOFFSET,.0,.0)
call CameraSetupSetField(RC,CAMERA_FIELD_ROTATION,101.9,.0)
call CameraSetupSetField(RC,CAMERA_FIELD_ANGLE_OF_ATTACK,326.9,.0)
call CameraSetupSetField(RC,CAMERA_FIELD_TARGET_DISTANCE,2415.8,.0)
call CameraSetupSetField(RC,CAMERA_FIELD_ROLL,.0,.0)
call CameraSetupSetField(RC,CAMERA_FIELD_FIELD_OF_VIEW,70.,.0)
call CameraSetupSetField(RC,CAMERA_FIELD_FARZ,5000.,.0)
call CameraSetupSetDestPosition(RC,-715.1,-322.7,.0)
set IC=CreateCameraSetup()
call CameraSetupSetField(IC,CAMERA_FIELD_ZOFFSET,300.,.0)
call CameraSetupSetField(IC,CAMERA_FIELD_ROTATION,101.9,.0)
call CameraSetupSetField(IC,CAMERA_FIELD_ANGLE_OF_ATTACK,326.9,.0)
call CameraSetupSetField(IC,CAMERA_FIELD_TARGET_DISTANCE,2415.8,.0)
call CameraSetupSetField(IC,CAMERA_FIELD_ROLL,.0,.0)
call CameraSetupSetField(IC,CAMERA_FIELD_FIELD_OF_VIEW,70.,.0)
call CameraSetupSetField(IC,CAMERA_FIELD_FARZ,5000.,.0)
call CameraSetupSetDestPosition(IC,-713.2,-326.5,.0)
set ZJ=CreateDestructableZ('B00H',320.,-1088.,377.6,90.,.55,0)
set VK=CreateDestructableZ('B00H',-1088.,-1088.,377.6,90.,.55,0)
set EK=CreateDestructableZ('B00H',-1088.,192.,377.6,90.,.55,0)
set YJ=CreateDestructableZ('B00H',320.,192.,377.6,90.,.55,0)
call KT()
call MT()
call PT()
call ConfigureNeutralVictim()
set VM=Filter(function IP)
set filterIssueHauntOrderAtLocBJ=Filter(function IssueHauntOrderAtLocBJFilter)
set filterEnumDestructablesInCircleBJ=Filter(function AM)
set filterGetUnitsInRectOfPlayer=Filter(function GetUnitsInRectOfPlayerFilter)
set filterGetUnitsOfTypeIdAll=Filter(function GetUnitsOfTypeIdAllFilter)
set filterGetUnitsOfPlayerAndTypeId=Filter(function GetUnitsOfPlayerAndTypeIdFilter)
set filterMeleeTrainedUnitIsHeroBJ=Filter(function MeleeTrainedUnitIsHeroBJFilter)
set filterLivingPlayerUnitsOfTypeId=Filter(function LivingPlayerUnitsOfTypeIdFilter)
set NP=0
loop
exitwhen NP==16
set bj_FORCE_PLAYER[NP]=CreateForce()
call ForceAddPlayer(bj_FORCE_PLAYER[NP],Player(NP))
set NP=NP+1
endloop
set bj_FORCE_ALL_PLAYERS=CreateForce()
call ForceEnumPlayers(bj_FORCE_ALL_PLAYERS,null)
set bj_cineModePriorSpeed=GetGameSpeed()
set bj_cineModePriorFogSetting=IsFogEnabled()
set bj_cineModePriorMaskSetting=IsFogMaskEnabled()
set NP=0
loop
exitwhen NP>=bj_MAX_QUEUED_TRIGGERS
set bj_queuedExecTriggers[NP]=null
set bj_queuedExecUseConds[NP]=false
set NP=NP+1
endloop
set bj_isSinglePlayer=false
set BP=0
set NP=0
loop
exitwhen NP>=$C
if(GetPlayerController(Player(NP))==MAP_CONTROL_USER and GetPlayerSlotState(Player(NP))==PLAYER_SLOT_STATE_PLAYING)then
set BP=BP+1
endif
set NP=NP+1
endloop
set bj_isSinglePlayer=(BP==1)
set bj_rescueSound=CreateSoundFromLabel("Rescue",false,false,false,$2710,$2710)
set bj_questDiscoveredSound=CreateSoundFromLabel("QuestNew",false,false,false,$2710,$2710)
set bj_questUpdatedSound=CreateSoundFromLabel("QuestUpdate",false,false,false,$2710,$2710)
set bj_questCompletedSound=CreateSoundFromLabel("QuestCompleted",false,false,false,$2710,$2710)
set bj_questFailedSound=CreateSoundFromLabel("QuestFailed",false,false,false,$2710,$2710)
set bj_questHintSound=CreateSoundFromLabel("Hint",false,false,false,$2710,$2710)
set bj_questSecretSound=CreateSoundFromLabel("SecretFound",false,false,false,$2710,$2710)
set bj_questItemAcquiredSound=CreateSoundFromLabel("ItemReward",false,false,false,$2710,$2710)
set bj_questWarningSound=CreateSoundFromLabel("Warning",false,false,false,$2710,$2710)
set bj_victoryDialogSound=CreateSoundFromLabel("QuestCompleted",false,false,false,$2710,$2710)
set bj_defeatDialogSound=CreateSoundFromLabel("QuestFailed",false,false,false,$2710,$2710)
call DelayedSuspendDecayCreate()
set v=VersionGet()
if(v==VERSION_REIGN_OF_CHAOS)then
set bj_MELEE_MAX_TWINKED_HEROES=bj_MELEE_MAX_TWINKED_HEROES_V0
else
set bj_MELEE_MAX_TWINKED_HEROES=bj_MELEE_MAX_TWINKED_HEROES_V1
endif
call InitQueuedTriggers()
call InitRescuableBehaviorBJ()
call InitDNCSounds()
call InitMapRects()
call InitSummonableCaps()
set YM=0
loop
set bj_stockAllowedPermanent[YM]=false
set bj_stockAllowedCharged[YM]=false
set bj_stockAllowedArtifact[YM]=false
set YM=YM+1
exitwhen YM>$A
endloop
call SetAllItemTypeSlots($B)
call SetAllUnitTypeSlots($B)
set bj_stockUpdateTimer=CreateTimer()
call TimerStart(bj_stockUpdateTimer,bj_STOCK_RESTOCK_INITIAL_DELAY,false,function OP)
set bj_stockItemPurchased=CreateTrigger()
call TriggerRegisterPlayerUnitEvent(bj_stockItemPurchased,Player($F),EVENT_PLAYER_UNIT_SELL_ITEM,null)
call TriggerAddAction(bj_stockItemPurchased,function RemovePurchasedItem)
call DetectGameStarted()
call ExecuteFunc("O8V")
set i=0
set i=0
loop
exitwhen(i>1)
set AV[i]=0
set NV[i]=0
set BV[i]=0
set CV[i]=0
set LV[i]=0
set QV[i]=0
set TV[i]=0
set UV[i]=0
set WV[i]=""
set OE[i]=0
set RE[i]=0
set IE[i]=0
set AE[i]=0
set NE[i]=0
set BE[i]=0
set GE[i]=0
set QE[i]=0
set ZE[i]=false
set VX[i]=""
set EX[i]=0
set XX[i]=0
set OX[i]=0
set NX[i]=DialogCreate()
set DX[i]=0
set GX[i]=0
set JX[i]=false
set KX[i]=0
set LX[i]=false
set WX[i]=false
set IO[i]=0
set GO[i]=false
set TO[i]=0
set YO[i]=0
set ZO[i]=0
set AR[i]=false
set NR[i]=false
set QR[i]=false
set XI[i]=""
set OI[i]=0
set AI[i]=""
set GI[i]=0
set HI[i]=0
set TI[i]=0
set UI[i]=0
set WI[i]=0
set YI[i]=0
set ZI[i]=0
set VA[i]=0
set EA[i]=0
set XA[i]=0
set OA[i]=0
set YA[i]=false
set ON[i]=0
set IN[i]=0
set KN[i]=0
set MN[i]=CreateGroup()
set QN[i]=0
set UN[i]=false
set WN[i]=false
set YN[i]=false
set VB[i]=false
set EB[i]=CreateGroup()
set XB[i]=false
set OB[i]=0
set RB[i]=0
set AB[i]=false
set CB[i]=0
set i=i+1
endloop
set MV=CreateGroup()
set EE=CreateGroup()
set XE=CreateForce()
set TE=CreateGroup()
set WE=CreateGroup()
set TX=CreateGroup()
set YX=CreateGroup()
set RO=CreateGroup()
set CO=CreateGroup()
set KR=CreateGroup()
set PR=CreateGroup()
set EI=CreateGroup()
set CI=CreateGroup()
set DI=CreateGroup()
set FI=CreateGroup()
set JI=CreateGroup()
set PI=CreateGroup()
set RA=CreateGroup()
set VN=CreateTimer()
set RN=CreateGroup()
set SN=CreateForce()
set IB=CreateTimer()
set DB=CreateTimer()
set JD=CreateTrigger()
call TriggerAddAction(JD,function ST)
set KD=CreateTrigger()
call TriggerRegisterTimerEventSingle(KD,.01)
call TriggerAddAction(KD,function UT)
set LD=CreateTrigger()
call TriggerRegisterAnyUnitEventBJ(LD,EVENT_PLAYER_UNIT_ISSUED_TARGET_ORDER)
call TriggerAddCondition(LD,Condition(function YT))
call TriggerAddAction(LD,function EU)
set MD=CreateTrigger()
call TriggerRegisterAnyUnitEventBJ(MD,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddAction(MD,function HU)
set PD=CreateTrigger()
call DisableTrigger(PD)
call TriggerRegisterTimerEventPeriodic(PD,.0)
call TriggerAddAction(PD,function LU)
set QD=CreateTrigger()
call DisableTrigger(QD)
call TriggerRegisterTimerEventPeriodic(QD,.03)
call TriggerAddAction(QD,function AW)
set SD=CreateTrigger()
call TriggerAddAction(SD,function BW)
set TD=CreateTrigger()
call TriggerAddAction(TD,function DW)
set UD=CreateTrigger()
call TriggerAddAction(UD,function GW)
set WD=CreateTrigger()
call TriggerAddAction(WD,function JW)
set YD=CreateTrigger()
call TriggerRegisterTimerEventSingle(YD,.0)
call TriggerAddAction(YD,function PW)
set ZD=CreateTrigger()
call TriggerRegisterTimerEventSingle(ZD,.03)
call TriggerAddAction(ZD,function SW)
set VF=CreateTrigger()
call DisableTrigger(VF)
call TriggerAddAction(VF,function WW)
set EF=CreateTrigger()
call DisableTrigger(EF)
call TriggerRegisterTimerEventPeriodic(EF,.1)
call TriggerAddAction(EF,function ZW)
set XF=CreateTrigger()
call TriggerAddAction(XF,function RY)
set OF=CreateTrigger()
call TriggerRegisterAnyUnitEventBJ(OF,EVENT_PLAYER_UNIT_USE_ITEM)
call TriggerAddCondition(OF,Condition(function AY))
call TriggerAddAction(OF,function BY)
set RF=CreateTrigger()
call TriggerAddAction(RF,function FY)
set IF=CreateTrigger()
call DisableTrigger(IF)
call TriggerAddAction(IF,function PY)
set AF=CreateTrigger()
call TriggerAddAction(AF,function UY)
set NF=CreateTrigger()
call TriggerAddAction(NF,function DZ)
set BF=CreateTrigger()
call TriggerAddAction(BF,function HZ)
set CF=CreateTrigger()
call TriggerAddAction(CF,function PZ)
set DF=CreateTrigger()
call TriggerAddAction(DF,function E0)
set FF=CreateTrigger()
call TriggerRegisterEnterRectSimple(FF,MB)
call TriggerAddAction(FF,function O0)
set GF=CreateTrigger()
call TriggerRegisterEnterRectSimple(GF,PB)
call TriggerAddAction(GF,function B0)
set HF=CreateTrigger()
call TriggerAddAction(HF,function D0)
set JF=CreateTrigger()
call TriggerAddAction(JF,function G0)
set KF=CreateTrigger()
call TriggerRegisterTimerEventSingle(KF,.0)
call TriggerAddAction(KF,function J0)
set LF=CreateTrigger()
call TriggerRegisterTimerEventSingle(LF,.01)
call TriggerAddAction(LF,function L0)
set MF=CreateTrigger()
call TriggerRegisterTimerEventSingle(MF,.02)
call TriggerAddAction(MF,function P0)
set PF=CreateTrigger()
call TriggerRegisterAnyUnitEventBJ(PF,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddAction(PF,function W0)
set QF=CreateTrigger()
call TriggerRegisterVariableEvent(QF,"PA",EQUAL,1.)
call TriggerAddAction(QF,function Z0)
set SF=CreateTrigger()
call TriggerAddAction(SF,function R1)
set TF=CreateTrigger()
call TriggerAddAction(TF,function B1)
set UF=CreateTrigger()
call TriggerRegisterAnyUnitEventBJ(UF,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddAction(UF,function J1)
set WF=CreateTrigger()
call TriggerAddAction(WF,function M1)
set YF=CreateTrigger()
call TriggerAddAction(YF,function V2)
set ZF=CreateTrigger()
call DisableTrigger(ZF)
call TriggerRegisterTimerEventPeriodic(ZF,1.)
call TriggerAddAction(ZF,function I2)
set VG=CreateTrigger()
call DisableTrigger(VG)
call TriggerRegisterTimerEventPeriodic(VG,10.)
call TriggerAddAction(VG,function B2)
set EG=CreateTrigger()
call TriggerAddAction(EG,function D2)
set XG=CreateTrigger()
call DisableTrigger(XG)
call TriggerRegisterTimerEventPeriodic(XG,1.)
call TriggerAddAction(XG,function K2)
set OG=CreateTrigger()
call DisableTrigger(OG)
call TriggerAddAction(OG,function V3)
set RG=CreateTrigger()
call DisableTrigger(RG)
call TriggerAddAction(RG,function A3)
set IG=CreateTrigger()
call DisableTrigger(IG)
call TriggerRegisterTimerEventPeriodic(IG,.1)
call TriggerAddAction(IG,function F3)
set AG=CreateTrigger()
call DisableTrigger(AG)
call TriggerRegisterTimerEventPeriodic(AG,1.)
call TriggerAddAction(AG,function J3)
set NG=CreateTrigger()
call DisableTrigger(NG)
call TriggerAddAction(NG,function L3)
set BG=CreateTrigger()
call DisableTrigger(BG)
call TriggerAddAction(BG,function P3)
set CG=CreateTrigger()
call DisableTrigger(CG)
call TriggerAddAction(CG,function S3)
set DG=CreateTrigger()
call DisableTrigger(DG)
call TriggerAddAction(DG,function U3)
set FG=CreateTrigger()
call DisableTrigger(FG)
call TriggerAddAction(FG,function Y3)
set GG=CreateTrigger()
call TriggerAddAction(GG,function E4)
set HG=CreateTrigger()
call TriggerAddAction(HG,function N4)
set JG=CreateTrigger()
call DisableTrigger(JG)
call TriggerRegisterEnterRectSimple(JG,SB)
call TriggerAddAction(JG,function C4)
set KG=CreateTrigger()
call TriggerAddAction(KG,function F4)
set LG=CreateTrigger()
call TriggerAddAction(LG,function H4)
set MG=CreateTrigger()
call DisableTrigger(MG)
call TriggerAddAction(MG,function K4)
set PG=CreateTrigger()
call DisableTrigger(PG)
call TriggerAddAction(PG,function P4)
set QG=CreateTrigger()
call DisableTrigger(QG)
call TriggerAddAction(QG,function S4)
set SG=CreateTrigger()
call DisableTrigger(SG)
call TriggerAddAction(SG,function U4)
set TG=CreateTrigger()
call TriggerAddAction(TG,function Y4)
set UG=CreateTrigger()
call DisableTrigger(UG)
call TriggerAddAction(UG,function V5)
set WG=CreateTrigger()
call DisableTrigger(WG)
call TriggerAddAction(WG,function X5)
set YG=CreateTrigger()
call DisableTrigger(YG)
call TriggerAddAction(YG,function R5)
set ZG=CreateTrigger()
call DisableTrigger(ZG)
call TriggerAddAction(ZG,function A5)
set VH=CreateTrigger()
call DisableTrigger(VH)
call TriggerRegisterTimerEventPeriodic(VH,.03)
call TriggerAddAction(VH,function P5)
set EH=CreateTrigger()
call DisableTrigger(EH)
call TriggerAddAction(EH,function S5)
set XH=CreateTrigger()
call DisableTrigger(XH)
call TriggerAddAction(XH,function U5)
set OH=CreateTrigger()
call DisableTrigger(OH)
call TriggerAddAction(OH,function Y5)
set RH=CreateTrigger()
call DisableTrigger(RH)
call TriggerAddAction(RH,function V6)
set IH=CreateTrigger()
call DisableTrigger(IH)
call TriggerAddAction(IH,function X6)
set AH=CreateTrigger()
call DisableTrigger(AH)
call TriggerAddAction(AH,function R6)
set NH=CreateTrigger()
call DisableTrigger(NH)
call TriggerAddAction(NH,function A6)
set BH=CreateTrigger()
call TriggerRegisterVariableEvent(BH,"BB",EQUAL,2.)
call TriggerAddAction(BH,function C6)
set CH=CreateTrigger()
call TriggerRegisterVariableEvent(CH,"LN",EQUAL,1.)
call TriggerAddAction(CH,function F6)
set DH=CreateTrigger()
call TriggerRegisterVariableEvent(DH,"LN",EQUAL,2.)
call TriggerAddAction(DH,function H6)
set FH=CreateTrigger()
call TriggerAddAction(FH,function K6)
set GH=CreateTrigger()
call TriggerAddAction(GH,function M6)
set HH=CreateTrigger()
call DisableTrigger(HH)
call TriggerAddAction(HH,function Q6)
set JH=CreateTrigger()
call TriggerAddAction(JH,function E7)
set KH=CreateTrigger()
call TriggerAddAction(KH,function A7)
set LH=CreateTrigger()
call DisableTrigger(LH)
call TriggerRegisterTimerEventPeriodic(LH,.03)
call TriggerAddAction(LH,function C7)
set MH=CreateTrigger()
call TriggerAddAction(MH,function M7)
set PH=CreateTrigger()
call TriggerRegisterTimerEventPeriodic(PH,.1)
call TriggerRegisterVariableEvent(PH,"KV",EQUAL,1.)
call TriggerRegisterVariableEvent(PH,"KV",EQUAL,2.)
call TriggerAddAction(PH,function V8)
set QH=CreateTrigger()
call TriggerAddAction(QH,function O8)
set SH=CreateTrigger()
call TriggerAddAction(SH,function S8)
set TH=CreateTrigger()
call TriggerAddAction(TH,function U8)
set UH=CreateTrigger()
call DisableTrigger(UH)
call TriggerRegisterTimerEventPeriodic(UH,1.)
call TriggerAddAction(UH,function VCV)
set WH=CreateTrigger()
call DisableTrigger(WH)
call TriggerRegisterTimerEventPeriodic(WH,1.)
call TriggerAddAction(WH,function VGV)
set YH=CreateTrigger()
call DisableTrigger(YH)
call TriggerRegisterTimerEventPeriodic(YH,1.)
call TriggerAddAction(YH,function VSV)
set ZH=CreateTrigger()
call DisableTrigger(ZH)
call TriggerRegisterTimerEventPeriodic(ZH,60.)
call TriggerAddAction(ZH,function VWV)
set VJ=CreateTrigger()
call DisableTrigger(VJ)
call TriggerRegisterTimerEventPeriodic(VJ,1.)
call TriggerAddAction(VJ,function V_V)
set EJ=CreateTrigger()
call DisableTrigger(EJ)
call TriggerRegisterTimerEventPeriodic(EJ,5.)
call TriggerAddAction(EJ,function V5V)
set XJ=CreateTrigger()
call TriggerAddAction(XJ,function V7V)
set OJ=CreateTrigger()
call TriggerRegisterVariableEvent(OJ,"KV",EQUAL,1.)
call TriggerRegisterVariableEvent(OJ,"KV",EQUAL,2.)
call TriggerAddAction(OJ,function EDV)
set RJ=CreateTrigger()
call TriggerRegisterVariableEvent(RJ,"KV",EQUAL,1.)
call TriggerRegisterVariableEvent(RJ,"KV",EQUAL,2.)
call TriggerAddAction(RJ,function XDV)
set IJ=CreateTrigger()
call TriggerAddAction(IJ,function XZV)
set AJ=CreateTrigger()
call TriggerAddAction(AJ,function X2V)
set NJ=CreateTrigger()
call TriggerRegisterAnyUnitEventBJ(NJ,EVENT_PLAYER_UNIT_UPGRADE_START)
call TriggerAddAction(NJ,function X6V)
set BJ=CreateTrigger()
call TriggerRegisterAnyUnitEventBJ(BJ,EVENT_PLAYER_UNIT_CONSTRUCT_START)
call TriggerAddAction(BJ,function OBV)
set CJ=CreateTrigger()
call TriggerRegisterAnyUnitEventBJ(CJ,EVENT_PLAYER_UNIT_RESEARCH_START)
call TriggerAddAction(CJ,function OFV)
set DJ=CreateTrigger()
call TriggerRegisterAnyUnitEventBJ(DJ,EVENT_PLAYER_UNIT_CONSTRUCT_CANCEL)
call TriggerAddCondition(DJ,Condition(function OHV))
call TriggerAddAction(DJ,function OJV)
set FJ=CreateTrigger()
call TriggerRegisterAnyUnitEventBJ(FJ,EVENT_PLAYER_UNIT_UPGRADE_CANCEL)
call TriggerAddCondition(FJ,Condition(function OLV))
call TriggerAddAction(FJ,function OPV)
set GJ=CreateTrigger()
call TriggerRegisterAnyUnitEventBJ(GJ,EVENT_PLAYER_UNIT_RESEARCH_CANCEL)
call TriggerAddCondition(GJ,Condition(function OSV))
call TriggerAddAction(GJ,function OTV)
set HJ=CreateTrigger()
call TriggerRegisterAnyUnitEventBJ(HJ,EVENT_PLAYER_UNIT_CONSTRUCT_FINISH)
call TriggerAddAction(HJ,function OZV)
set JJ=CreateTrigger()
call TriggerRegisterAnyUnitEventBJ(JJ,EVENT_PLAYER_UNIT_UPGRADE_FINISH)
call TriggerAddAction(JJ,function O0V)
set KJ=CreateTrigger()
call TriggerRegisterAnyUnitEventBJ(KJ,EVENT_PLAYER_UNIT_RESEARCH_FINISH)
call TriggerAddAction(KJ,function O6V)
call ConditionalTriggerExecute(JD)
call ConditionalTriggerExecute(HF)
call ConditionalTriggerExecute(JF)
call ConditionalTriggerExecute(EG)
call ConditionalTriggerExecute(GH)
call ConditionalTriggerExecute(MH)
endfunction
function config takes nothing returns nothing
call SetMapName("TRIGSTR_088")
call SetMapDescription("TRIGSTR_090")
call SetPlayers($C)
call SetTeams($C)
call SetGamePlacement(MAP_PLACEMENT_TEAMS_TOGETHER)
call DefineStartLocation(0,11072.,-4288.)
call DefineStartLocation(1,11072.,-4288.)
call DefineStartLocation(2,11072.,-4288.)
call DefineStartLocation(3,11072.,-4288.)
call DefineStartLocation(4,11072.,-4288.)
call DefineStartLocation(5,11072.,-4288.)
call DefineStartLocation(6,11072.,-4288.)
call DefineStartLocation(7,11072.,-4288.)
call DefineStartLocation(8,11072.,-4288.)
call DefineStartLocation(9,11072.,-4288.)
call DefineStartLocation($A,11072.,-4288.)
call DefineStartLocation($B,11072.,-4288.)
call SetPlayerStartLocation(Player(0),0)
call ForcePlayerStartLocation(Player(0),0)
call SetPlayerColor(Player(0),ConvertPlayerColor(0))
call SetPlayerRacePreference(Player(0),RACE_PREF_HUMAN)
call SetPlayerRaceSelectable(Player(0),false)
call SetPlayerController(Player(0),MAP_CONTROL_USER)
call SetPlayerStartLocation(Player(1),1)
call ForcePlayerStartLocation(Player(1),1)
call SetPlayerColor(Player(1),ConvertPlayerColor(1))
call SetPlayerRacePreference(Player(1),RACE_PREF_HUMAN)
call SetPlayerRaceSelectable(Player(1),false)
call SetPlayerController(Player(1),MAP_CONTROL_USER)
call SetPlayerStartLocation(Player(2),2)
call ForcePlayerStartLocation(Player(2),2)
call SetPlayerColor(Player(2),ConvertPlayerColor(2))
call SetPlayerRacePreference(Player(2),RACE_PREF_HUMAN)
call SetPlayerRaceSelectable(Player(2),false)
call SetPlayerController(Player(2),MAP_CONTROL_USER)
call SetPlayerStartLocation(Player(3),3)
call ForcePlayerStartLocation(Player(3),3)
call SetPlayerColor(Player(3),ConvertPlayerColor(3))
call SetPlayerRacePreference(Player(3),RACE_PREF_HUMAN)
call SetPlayerRaceSelectable(Player(3),false)
call SetPlayerController(Player(3),MAP_CONTROL_USER)
call SetPlayerStartLocation(Player(4),4)
call ForcePlayerStartLocation(Player(4),4)
call SetPlayerColor(Player(4),ConvertPlayerColor(4))
call SetPlayerRacePreference(Player(4),RACE_PREF_HUMAN)
call SetPlayerRaceSelectable(Player(4),false)
call SetPlayerController(Player(4),MAP_CONTROL_USER)
call SetPlayerStartLocation(Player(5),5)
call ForcePlayerStartLocation(Player(5),5)
call SetPlayerColor(Player(5),ConvertPlayerColor(5))
call SetPlayerRacePreference(Player(5),RACE_PREF_HUMAN)
call SetPlayerRaceSelectable(Player(5),false)
call SetPlayerController(Player(5),MAP_CONTROL_USER)
call SetPlayerStartLocation(Player(6),6)
call ForcePlayerStartLocation(Player(6),6)
call SetPlayerColor(Player(6),ConvertPlayerColor(6))
call SetPlayerRacePreference(Player(6),RACE_PREF_HUMAN)
call SetPlayerRaceSelectable(Player(6),false)
call SetPlayerController(Player(6),MAP_CONTROL_USER)
call SetPlayerStartLocation(Player(7),7)
call ForcePlayerStartLocation(Player(7),7)
call SetPlayerColor(Player(7),ConvertPlayerColor(7))
call SetPlayerRacePreference(Player(7),RACE_PREF_HUMAN)
call SetPlayerRaceSelectable(Player(7),false)
call SetPlayerController(Player(7),MAP_CONTROL_USER)
call SetPlayerStartLocation(Player(8),8)
call ForcePlayerStartLocation(Player(8),8)
call SetPlayerColor(Player(8),ConvertPlayerColor(8))
call SetPlayerRacePreference(Player(8),RACE_PREF_HUMAN)
call SetPlayerRaceSelectable(Player(8),false)
call SetPlayerController(Player(8),MAP_CONTROL_USER)
call SetPlayerStartLocation(Player(9),9)
call ForcePlayerStartLocation(Player(9),9)
call SetPlayerColor(Player(9),ConvertPlayerColor(9))
call SetPlayerRacePreference(Player(9),RACE_PREF_HUMAN)
call SetPlayerRaceSelectable(Player(9),false)
call SetPlayerController(Player(9),MAP_CONTROL_USER)
call SetPlayerStartLocation(Player($A),$A)
call ForcePlayerStartLocation(Player($A),$A)
call SetPlayerColor(Player($A),ConvertPlayerColor($A))
call SetPlayerRacePreference(Player($A),RACE_PREF_HUMAN)
call SetPlayerRaceSelectable(Player($A),false)
call SetPlayerController(Player($A),MAP_CONTROL_USER)
call SetPlayerStartLocation(Player($B),$B)
call ForcePlayerStartLocation(Player($B),$B)
call SetPlayerColor(Player($B),ConvertPlayerColor($B))
call SetPlayerRacePreference(Player($B),RACE_PREF_UNDEAD)
call SetPlayerRaceSelectable(Player($B),false)
call SetPlayerController(Player($B),MAP_CONTROL_COMPUTER)
call InitCustomTeams()
call SetStartLocPrioCount(0,$B)
call SetStartLocPrio(0,0,1,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(0,1,2,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(0,2,3,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(0,3,4,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(0,4,5,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(0,5,6,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(0,6,7,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(0,7,8,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(0,8,9,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(0,9,$A,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(0,$A,$B,MAP_LOC_PRIO_HIGH)
call SetStartLocPrioCount(1,$B)
call SetStartLocPrio(1,0,0,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(1,1,2,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(1,2,3,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(1,3,4,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(1,4,5,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(1,5,6,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(1,6,7,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(1,7,8,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(1,8,9,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(1,9,$A,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(1,$A,$B,MAP_LOC_PRIO_HIGH)
call SetStartLocPrioCount(2,$B)
call SetStartLocPrio(2,0,0,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(2,1,1,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(2,2,3,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(2,3,4,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(2,4,5,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(2,5,6,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(2,6,7,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(2,7,8,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(2,8,9,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(2,9,$A,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(2,$A,$B,MAP_LOC_PRIO_HIGH)
call SetStartLocPrioCount(3,$B)
call SetStartLocPrio(3,0,0,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(3,1,1,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(3,2,2,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(3,3,4,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(3,4,5,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(3,5,6,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(3,6,7,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(3,7,8,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(3,8,9,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(3,9,$A,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(3,$A,$B,MAP_LOC_PRIO_HIGH)
call SetStartLocPrioCount(4,$B)
call SetStartLocPrio(4,0,0,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(4,1,1,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(4,2,2,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(4,3,3,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(4,4,5,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(4,5,6,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(4,6,7,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(4,7,8,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(4,8,9,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(4,9,$A,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(4,$A,$B,MAP_LOC_PRIO_HIGH)
call SetStartLocPrioCount(5,$B)
call SetStartLocPrio(5,0,0,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(5,1,1,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(5,2,2,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(5,3,3,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(5,4,4,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(5,5,6,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(5,6,7,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(5,7,8,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(5,8,9,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(5,9,$A,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(5,$A,$B,MAP_LOC_PRIO_HIGH)
call SetStartLocPrioCount(6,$B)
call SetStartLocPrio(6,0,0,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(6,1,1,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(6,2,2,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(6,3,3,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(6,4,4,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(6,5,5,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(6,6,7,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(6,7,8,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(6,8,9,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(6,9,$A,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(6,$A,$B,MAP_LOC_PRIO_HIGH)
call SetStartLocPrioCount(7,$B)
call SetStartLocPrio(7,0,0,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(7,1,1,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(7,2,2,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(7,3,3,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(7,4,4,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(7,5,5,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(7,6,6,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(7,7,8,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(7,8,9,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(7,9,$A,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(7,$A,$B,MAP_LOC_PRIO_HIGH)
call SetStartLocPrioCount(8,$B)
call SetStartLocPrio(8,0,0,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(8,1,1,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(8,2,2,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(8,3,3,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(8,4,4,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(8,5,5,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(8,6,6,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(8,7,7,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(8,8,9,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(8,9,$A,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(8,$A,$B,MAP_LOC_PRIO_HIGH)
call SetStartLocPrioCount(9,$B)
call SetStartLocPrio(9,0,0,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(9,1,1,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(9,2,2,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(9,3,3,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(9,4,4,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(9,5,5,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(9,6,6,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(9,7,7,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(9,8,8,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(9,9,$A,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(9,$A,$B,MAP_LOC_PRIO_HIGH)
call SetStartLocPrioCount($A,$B)
call SetStartLocPrio($A,0,0,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio($A,1,1,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio($A,2,2,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio($A,3,3,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio($A,4,4,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio($A,5,5,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio($A,6,6,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio($A,7,7,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio($A,8,8,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio($A,9,9,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio($A,$A,$B,MAP_LOC_PRIO_HIGH)
call SetStartLocPrioCount($B,$B)
call SetStartLocPrio($B,0,0,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio($B,1,1,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio($B,2,2,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio($B,3,3,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio($B,4,4,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio($B,5,5,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio($B,6,6,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio($B,7,7,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio($B,8,8,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio($B,9,9,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio($B,$A,$A,MAP_LOC_PRIO_HIGH)
endfunction
function O8V takes nothing returns nothing
call ExecuteFunc("JP")
call ExecuteFunc("KP")
call ExecuteFunc("DQ")
call ExecuteFunc("YQ")
call ExecuteFunc("RS")
call ExecuteFunc("BS")
endfunction

